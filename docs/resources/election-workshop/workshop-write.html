<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-resources/election-workshop/workshop-write" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Write a smart contract | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/resources/election-workshop/workshop-write"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Write a smart contract | Kadena Docs"><meta data-rh="true" name="description" content="Use the Pact smart contract language to build the scaffolding for the election application smart contract backend."><meta data-rh="true" property="og:description" content="Use the Pact smart contract language to build the scaffolding for the election application smart contract backend."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/resources/election-workshop/workshop-write"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-write" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-write" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Write a smart contract</h1></header>
<p>Now that you have a unique principal namespace controlled by your administrative keyset, you&#x27;re ready to start building the backend for the election application.
In this tutorial, you&#x27;ll learn the basics of how to write a <strong>smart contract</strong> that can be deployed on the blockchain as the backend code for the election application.</p>
<p>A smart contract is a special type of application runs automatically when the conditions specified in the contract logic are met.
By deploying a smart contract on a blockchain, the terms of an agreement can be executed programmatically in a decentralized way, without any intermediary involvement or process delays.</p>
<p>On the Kadena blockchain, a smart contract consists of one or more <strong>modules</strong> written in the Pact programming language.
For this workshop, the election smart contract consists of two modules: the main <strong>election</strong> module and an auxiliary
<strong>gas station</strong> module.</p>
<p>The exercises in this tutorial illustrate the basics of building and deploying a Pact module as you develop the main <strong>election</strong> module.
At the completion of this tutorial, you&#x27;ll deploy the core logic of the election module on your local development network.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before you begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before you begin" title="Direct link to Before you begin">​</a></h2>
<p>Before you start this tutorial, verify the following basic requirements:</p>
<ul>
<li>You have an internet connection and a web browser installed on your local computer.</li>
<li>You have a code editor, such as <a href="https://code.visualstudio.com/download" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>, access to an interactive terminal shell, and are generally familiar with using command-line programs.</li>
<li>You have cloned the <a href="https://github.com/kadena-community/voting-dapp.gitp" target="_blank" rel="noopener noreferrer">voting-dapp</a> repository to create your project directory as described in <a href="/docs/resources/election-workshop/workshop-prepare">Prepare your workspace</a>.</li>
<li>You have the development network running in a Docker container as described in <a href="/docs/resources/election-workshop/workshop-start">Start a local blockchain</a>.</li>
<li>You are <a href="/docs/resources/election-workshop/workshop-start#connect-to-the-development-network">connected to the development network</a> using your local host IP address and port number 8080.</li>
<li>You have created and funded an administrative account as described in <a href="/docs/resources/election-workshop/workshop-admin">Add an administrator account</a>.</li>
<li>You have created a principal namespace on the development network as described in <a href="/docs/resources/election-workshop/workshop-namespace">Define a namespace</a>.</li>
<li>You have defined the keyset in your principal namespace using the administrative account as described in <a href="/docs/resources/election-workshop/workshop-keysets">Define keysets</a>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-a-minimal-pact-module">Define a minimal Pact module<a href="#define-a-minimal-pact-module" class="hash-link" aria-label="Direct link to Define a minimal Pact module" title="Direct link to Define a minimal Pact module">​</a></h2>
<p>To get started writing Pact modules, you must have a file that contains the bare minimum of code required to deploy.
You can create and test this starter code for a Pact module using the Pact command-line interpreter REPL and <code>.repl</code> files.
After you have a minimal working deployment, you can add and refactor the code to add functionality to the Pact
module.</p>
<p>To create the starter code for a Pact module:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact</code> folder in the code editor on your computer.</p>
</li>
<li>
<p>Create a new file named <code>module.repl</code> in the <code>pact</code> folder.</p>
</li>
<li>
<p>Add a transaction that uses the <code>module</code> keyword to define a new module named <code>election</code> and a module owner to protect access to the functions you&#x27;ll define for the module.</p>
</li>
</ol>
<p>All modules require either a keyset, like the <code>admin-keyset</code> you&#x27;ve seen previously, or a <a href="/docs/resources/glossary#capability">capability</a> to control who can deploy or update the module, and, potentially, who can execute protected operations.</p>
<p>You must specify the governance keyset or capability immediately after the module name.
Although keysets—like the <code>admin-keyset</code> you&#x27;ve used in previous tutorials—are valid module owners, most modules define a governance capability as a more flexible solution.
For example, you can define a GOVERNANCE capability that is always true by adding the following lines in the <code>module.repl</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Deploy the election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (module election GOVERNANCE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOVERNANCE () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You&#x27;ll learn more about capabilities a little later in this tutorial and in other tutorials.
For now, there are only two points to keep in mind about this capability:</p>
<ul>
<li>The name you use for the capability isn&#x27;t significant—you can use any name—however, the placement of the capability at the start of the module declaration is significant.</li>
<li>The definition of a capability as always true represents the simplest form a definition can take for demonstration purposes.</li>
</ul>
<p>You could also write this definition using an <code>enforce</code> statement similar to the following with exactly the same results:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Deploy the election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (module election GOVERNANCE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       (enforce (= 1 1)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this point, you have a module name and a module owner in the form of a capability.
For this module to be useful, you must define at least one function.
The first function you&#x27;ll define in this module is the <code>list-candidates</code> function.</p>
<ol>
<li>
<p>Add a <code>list-candidates</code> function as the first function in the  <code>election</code> module declaration transaction.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Deploy the election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (module election GOVERNANCE       ; Start the module declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOVERNANCE () true)    ; Define the module owner capability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defun list-candidates () [])  ; Add a new function to the transaction   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )                                 ; End the module declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Later, you&#x27;ll update this function to list the candidates stored in a database table.
For now, this function just returns an empty list (<code>[]</code>).</p>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You&#x27;ll see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:0:0-0:39:Trace: &quot;Begin Tx 0 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:1:2-6:3:Trace: Loaded module election, hash iKhGsvHzyhKh947693r9mF5leHM4Iw0rDjeoj6WQyL8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:7:0-7:11:Trace: &quot;Commit Tx 0 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you open the Pact command-line interpreter REPL, you can load this file and test that the <code>list-candidates</code> function returns an empty list.
For example, type <code>pact</code> in the terminal shell to open the Pact command-line interpreter, then load the <code>module.repl</code> file and call the <code>list-candidates</code> function to see output similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;module.repl&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading module.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Begin Tx 0 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module election, hash iKhGsvHzyhKh947693r9mF5leHM4Iw0rDjeoj6WQyL8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Commit Tx 0 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (election.list-candidates)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Type Control-d to exit the Pact command-line interpreter REPL.</p>
</li>
<li>
<p>Add the environment data keyset and signature and the transactions to define a namespace for the <code>election</code> module to the <code>module.repl</code> file before the start of the module declaration.</p>
<p>For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   { &quot;admin-keyset&quot; :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      { &quot;keys&quot; : [ &quot;admin-public-key&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      , &quot;pred&quot; : &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   [{ &quot;key&quot;  : &quot;admin-public-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    , &quot;caps&quot; : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Define a namespace for the module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (define-namespace &#x27;election (read-keyset &#x27;admin-keyset) (read-keyset &#x27;admin-keyset))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Define a keyset to govern the module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (namespace &#x27;election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (define-keyset &quot;election.admin-keyset&quot; (read-keyset &#x27;admin-keyset))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Deploy the election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (module election GOVERNANCE       ; Start the module declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (defcap GOVERNANCE () true)    ; Define the module owner capability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (defun list-candidates () [])  ; Add a new function to the transaction   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )                                 ; End the module declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you might remember from previous tutorials, this code:</p>
<ul>
<li>Loads the <code>admin-keyset</code> context and signatures into the REPL environment.</li>
<li>Defines the <code>election</code> namespace.</li>
<li>Enters the <code>election</code> namespace to define the <code>election.admin-keyset</code> as the namespace owner.</li>
</ul>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You&#x27;ll now see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:0:0-6:1:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:7:0-11:1:Trace: &quot;Setting transaction signatures/caps&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:13:0-13:46:Trace: &quot;Begin Tx 0 Define a namespace for the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:14:4-14:88:Trace: &quot;Namespace defined: election&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:15:0-15:11:Trace: &quot;Commit Tx 0 Define a namespace for the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:16:0-16:49:Trace: &quot;Begin Tx 1 Define a keyset to govern the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:17:4-17:25:Trace: &quot;Namespace set to election&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:18:4-18:71:Trace: &quot;Keyset write success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:19:0-19:11:Trace: &quot;Commit Tx 1 Define a keyset to govern the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:21:0-21:39:Trace: &quot;Begin Tx 2 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:22:2-26:3:Trace: Loaded module election, hash iKhGsvHzyhKh947693r9mF5leHM4Iw0rDjeoj6WQyL8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:27:0-27:11:Trace: &quot;Commit Tx 2 Deploy the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-election-module">Test the election module<a href="#test-the-election-module" class="hash-link" aria-label="Direct link to Test the election module" title="Direct link to Test the election module">​</a></h2>
<p>At this point, the <code>module.repl</code> file includes the minimal code required to define a Pact module named <code>election</code> in the <code>election</code> namespace.
The module is owned by a minimal GOVERNANCE capability and only includes one function—the <code>list-candidates</code> function—that is publicly available because access to the function isn&#x27;t guarded by any keyset or capability.
You can use the <code>list-modules</code> built-in function in the Pact REPL to test access to the <code>election</code> module and then add a transaction to call the <code>list-candidates</code> function.</p>
<p>To test access to the <code>election</code> module:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/module.repl</code> file in the code editor.</p>
</li>
<li>
<p>Add the following transaction to assert that the <code>election</code> module is available:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Look up the election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect &quot;The election module should exist&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   [&quot;election&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (list-modules)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output similar to the following that indicates the <code>election</code> module is defined in the Pact REPL:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:29:0-29:40:Trace: &quot;Begin Tx 3 Look up the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:30:3-33:4:Trace: &quot;Expect: success The election module should exist&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:34:0-34:11:Trace: &quot;Commit Tx 3 Look up the election module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Clear the environment data and signature information and add a transaction to call the <code>list-candidates</code> function on the <code>election</code> module, and assert that the function returns an empty array:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data {})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs [])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Call list-candidates&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect &quot;list-candidates returns an empty list&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (election.list-candidates)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output similar to the following that indicates you were able to call the <code>list-candidates</code> function without signing the transaction and that the function returned an empty list:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:36:0-36:13:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:37:0-37:13:Trace: &quot;Setting transaction signatures/caps&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:38:0-38:33:Trace: &quot;Begin Tx 4 Call list-candidates&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:39:3-42:4:Trace: &quot;Expect: success list-candidates returns an empty list&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:43:0-43:11:Trace: &quot;Commit Tx 4 Call list-candidates&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the <code>election</code> module, some functions—like the <code>list-candidates</code> function—should be publicly accessible.
Other operations—as demonstrated in the next section—should be more carefully guarded.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-election-module">Update the election module<a href="#update-the-election-module" class="hash-link" aria-label="Direct link to Update the election module" title="Direct link to Update the election module">​</a></h2>
<p>When you defined the <code>election</code> namespace for the <code>election</code> module, you also specified the keysets with access rights and with administrative rights.
Changes that update the module must be signed with a keyset that has the necessary rights.
The examples in this section demonstrate how to test that updates work as expected, with transactions that update the Pact module with the correct keyset and fail to update the module with an incorrect keyset.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-module-with-the-correct-keyset">Update the module with the correct keyset<a href="#update-the-module-with-the-correct-keyset" class="hash-link" aria-label="Direct link to Update the module with the correct keyset" title="Direct link to Update the module with the correct keyset">​</a></h3>
<p>To test updating a module by calling the correct administrative keyset:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/module.repl</code> file in the code editor.</p>
</li>
<li>
<p>Reload the election <code>admin-keyset</code> and signature into the Pact REPL with the following lines of code after the last transaction:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { &#x27;admin-keyset :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;keys&quot; : [ &quot;admin-public-key&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    , &quot;pred&quot; : &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [{ &quot;key&quot;  : &quot;admin-public-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &quot;caps&quot; : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Update the <code>election</code> module to change the <code>list-candidates</code> function to return a list containing 1, 2, 3 and test that <code>list-candidates</code> returns the new list.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Update the module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (module election &quot;election.admin-keyset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (defun list-candidates () [1, 2, 3])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Call updated list-candidates function&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect &quot;list-candidates returns a list with numbers&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [1, 2, 3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (election.list-candidates)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output similar to the following that indicates you were able to call the updated <code>list-candidates</code> function and that the function returned a list with numbers:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:45:0-51:2:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:52:1-56:2:Trace: &quot;Setting transaction signatures/caps&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:58:0-58:30:Trace: &quot;Begin Tx 5 Update the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:59:3-61:4:Trace: Loaded module election, hash aqTzmLOHdx5cNTPnhHMu6XXE69KBqDbzWvK70dGTkyo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:62:0-62:11:Trace: &quot;Commit Tx 5 Update the module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:63:0-63:50:Trace: &quot;Begin Tx 6 Call updated list-candidates function&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:64:3-67:4:Trace: &quot;Expect: success list-candidates returns a list with numbers&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:68:0-68:11:Trace: &quot;Commit Tx 6 Call updated list-candidates function&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful   </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-updating-the-module-with-an-incorrect-keyset">Test updating the module with an incorrect keyset<a href="#test-updating-the-module-with-an-incorrect-keyset" class="hash-link" aria-label="Direct link to Test updating the module with an incorrect keyset" title="Direct link to Test updating the module with an incorrect keyset">​</a></h3>
<p>To test that updating a module with an incorrect keyset fails:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/module.repl</code> file in the code editor.</p>
</li>
<li>
<p>Set the environment data and signature to use a different key by adding the following lines of code after the last transaction:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { &quot;admin-keyset&quot; :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;keys&quot; : [ &quot;other-key&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    , &quot;pred&quot; : &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [{ &quot;key&quot;  : &quot;other-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &quot;caps&quot; : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction to attempt to update the module with an incorrect key by adding the following lines of code:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Upgrade the module without permission&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (module election &quot;election.admin-keyset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (defun list-candidates () [])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the <code>Load failed</code> message and that the failure was caused by a <code>Keyset failure</code> error.
With these two tests, you know that you can update the Pact module by signing a transaction with the <code>election.admin-keyset</code> and that no other keyset can update the <code>election</code> module.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:70:0-76:1:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:77:0-81:1:Trace: &quot;Setting transaction signatures/caps&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:83:0-83:50:Trace: &quot;Begin Tx 7 Upgrade the module without permission&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:85:6: Keyset failure (keys-all): [admin-ke...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">85 |       (module election &quot;election.admin-keyset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Remove the code you added for testing an incorrect keyset.</p>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file to verify that the file loads successfully before you continue:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enforce-the-keyset-guard">Enforce the keyset guard<a href="#enforce-the-keyset-guard" class="hash-link" aria-label="Direct link to Enforce the keyset guard" title="Direct link to Enforce the keyset guard">​</a></h2>
<p>With the GOVERNANCE capability set to always pass, there are no restrictions for executing functions in the module code.
This behavior is acceptable for preliminary local testing, but not desirable in any other context.
As an alternative to calling a keyset directly, you can update the module to define a restriction for the GOVERNANCE capability that enforces the use of the administrative keyset.</p>
<p>To test updating the module with a guarded capability:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/module.repl</code> file in the code editor.</p>
</li>
<li>
<p>Update the <code>election</code> module to define a GOVERNANCE capability that enforces the use of the <code>election.admin-keyset</code> keyset.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Update the module with enforce-guard&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (module election GOVERNANCE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (enforce-guard (keyset-ref-guard &quot;election.admin-keyset&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defun list-candidates () [&quot;Chris&quot;, &quot;Harry&quot;, &quot;Tai&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction that imports the <code>election</code> module and tests that the <code>list-candidates</code> function returns the expected list.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Return the list of candidates&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (use election)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (election.list-candidates)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>module.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact module.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output similar to the following that indicates you were able to call the updated <code>list-candidates</code> function and that the function returned a list with strings:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:70:0-70:49:Trace: &quot;Begin Tx 7 Update the module with enforce-guard&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:71:3-76:4:Trace: Loaded module election, hash Z-nnwjtYoQ1RT993qOSGZkoE5b-_iKH_KL1_yMUH8xU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:77:0-77:11:Trace: &quot;Commit Tx 7 Update the module with enforce-guard&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:79:0-79:42:Trace: &quot;Begin Tx 8 Return the list of candidates&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:80:3-80:17:Trace: Loaded imports from election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:81:3-81:29:Trace: [&quot;Chris&quot; &quot;Harry&quot; &quot;Tai&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.repl:82:0-82:11:Trace: &quot;Commit Tx 8 Return the list of candidates&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-pact-module">Deploy the Pact module<a href="#deploy-the-pact-module" class="hash-link" aria-label="Direct link to Deploy the Pact module" title="Direct link to Deploy the Pact module">​</a></h2>
<p>Now that you&#x27;ve seen how to define and update a Pact module, you&#x27;re ready to deploy the module on the local development network with the administrative account you created previously.</p>
<p>To deploy the Pact module on the development network:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact</code> folder in the code editor.</p>
</li>
<li>
<p>Create a new file named <code>election.pact</code> in the <code>pact</code> folder.</p>
</li>
<li>
<p>Add the minimal Pact code required to define a module to the <code>election.pact</code> file.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace (ns.create-principal-namespace (read-keyset &quot;election-admin&quot;)) (read-keyset &quot;election-admin&quot;) (read-keyset &quot;election-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(let ((ns-name (ns.create-principal-namespace (read-keyset &quot;election-admin&quot;))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (namespace ns-name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (define-keyset (format &quot;{}.{}&quot; [ns-name &quot;election-admin&quot;]) (read-keyset &quot;election-admin&quot; ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module election GOVERNANCE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (enforce-guard (keyset-ref-guard &quot;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election-admin&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun list-candidates () [1, 2, 3])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a new transaction template named <code>election-module-devnet.ktpl</code> in the <code>~/.kadena/transaction-templates</code> folder.</p>
</li>
<li>
<p>Open the <code>election-module-devnet.ktpl</code> file and create a reusable transaction request similar to the following using the path to the <code>election.pact</code> file that contains your Pact module code.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">codeFile: &quot;../../election.pact&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  election-admin:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys: [&quot;{{public-key}}&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pred: &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainId: &quot;{{chain-id}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sender: &quot;{{{sender-account}}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasLimit: 80300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasPrice: 0.000001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ttl: 600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - public: &quot;{{public-key}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    caps: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networkId: &quot;{{network-id}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>You can verify the transaction results using the request key for the transaction.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<p>Congratulations!
You now have a smart contract with one <code>election</code> module governed by the <code>election-admin</code> deployed in your principal namespace on the local development network.
In this tutorial, you learned how to:</p>
<ul>
<li>Define a minimal Pact module.</li>
<li>Test a Pact module using the Pact REPL.</li>
<li>Implement governance for a module by using a capability.</li>
<li>Deploy a Pact module on the local development network.</li>
<li>Update a deployed module governed by your keyset.</li>
</ul>
<p>So far, your <code>election</code> module only contains one simple function.
The next tutorial demonstrates how to add a schema and a database table to the <code>election</code> module and how to use that table to store the names of election candidates and the number of votes each candidate receives.</p>
<p>You&#x27;ll also update the <code>list-candidates</code> function to return data from the database table and add a new function to nominate candidates.</p>
<p>To see the code for the activity you completed in this tutorial and get the
starter code for the next tutorial, check out the <code>07-nominate-candidates</code> branch from the <code>election-workshop</code> repository by running the following command in your terminal shell:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout 07-nominate-candidates</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/resources/election-workshop/6-write-a-smart-contract.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before you begin</a></li><li><a href="#define-a-minimal-pact-module" class="table-of-contents__link toc-highlight">Define a minimal Pact module</a></li><li><a href="#test-the-election-module" class="table-of-contents__link toc-highlight">Test the election module</a></li><li><a href="#update-the-election-module" class="table-of-contents__link toc-highlight">Update the election module</a></li><li><a href="#enforce-the-keyset-guard" class="table-of-contents__link toc-highlight">Enforce the keyset guard</a></li><li><a href="#deploy-the-pact-module" class="table-of-contents__link toc-highlight">Deploy the Pact module</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>