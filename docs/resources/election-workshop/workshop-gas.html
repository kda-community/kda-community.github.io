<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-resources/election-workshop/workshop-gas" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Add a gas station | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/resources/election-workshop/workshop-gas"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Add a gas station | Kadena Docs"><meta data-rh="true" name="description" content="Prepare a gas station module to pay the transaction fees for account holders who cast votes in the election application."><meta data-rh="true" property="og:description" content="Prepare a gas station module to pay the transaction fees for account holders who cast votes in the election application."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/resources/election-workshop/workshop-gas"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-gas" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-gas" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Add a gas station</h1></header>
<p>Traditional elections have minimal safeguards against fraud, corruption, mishandling of ballots, and intentional or unintentional disruptions.
Even where voting is available by mail or online, elections can be costly, inefficient, and subject to human error.</p>
<p>By using blockchain technology, elections could be made more convenient, transparent, and reliable.
For example:</p>
<ul>
<li>Every vote can be recorded as a public transaction that can&#x27;t be altered.</li>
<li>Voters can remain anonymous with votes linked to an encrypted digital fingerprint instead of government-issued identification.</li>
<li>Election results can be independently verified by anyone.</li>
</ul>
<p>However, there is one main drawback to using a blockchain to cast votes in an election.
Because every vote is a public transaction that changes the state of the blockchain, every vote requires computational resources and incurs a processing fee—commonly referred to as a <strong>gas</strong> payment.</p>
<p>Paying for transaction processing is normal in the context of many business operations, but paying to vote is essentially undemocratic.
To address this issue, Kadena introduced a transaction processing clearing house for paying fees called a <strong>gas station</strong>.</p>
<p>A gas station is an account that exists only to make transaction fee payments on behalf of other accounts and under specific conditions.
For example, a government agency could apply a fraction of its budget for a traditional election to fund a gas station.
The gas station could then pay the transaction fee for every voting transaction, allowing all citizens to vote for free.</p>
<p>For more information about the introduction of gas stations, see <a href="https://medium.com/kadena-io/the-first-crypto-gas-station-is-now-on-kadenas-blockchain-6dc43b4b3836" target="_blank" rel="noopener noreferrer">The First Crypto Gas Station is Now on Kadena’s Blockchain</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before you begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before you begin" title="Direct link to Before you begin">​</a></h2>
<p>Before you start this tutorial, verify the following basic requirements:</p>
<ul>
<li>You have an internet connection and a web browser installed on your local computer.</li>
<li>You have a code editor, such as <a href="https://code.visualstudio.com/download" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>, access to an interactive terminal shell, and are generally familiar with using command-line programs.</li>
<li>You have cloned the <a href="https://github.com/kadena-community/voting-dapp.git" target="_blank" rel="noopener noreferrer">voting-dapp</a> repository to create your project directory as described in <a href="/docs/resources/election-workshop/workshop-prepare">Prepare your workspace</a>.</li>
<li>You have the development network running in a Docker container as described in <a href="/docs/resources/election-workshop/workshop-start">Start a local blockchain</a>.</li>
<li>You are <a href="/docs/resources/election-workshop/workshop-start#connect-to-the-development-network">connected to the development network</a> using your local host IP address and port number 8080.</li>
<li>You have created and funded an administrative account as described in <a href="/docs/resources/election-workshop/workshop-admin">Add an administrator account</a>.</li>
<li>You have created a principal namespace on the development network as described in <a href="/docs/resources/election-workshop/workshop-namespace">Define a namespace</a>.</li>
<li>You have defined the keyset that controls your namespace using the administrative account as described in <a href="/docs/resources/election-workshop/workshop-keysets">Define keysets</a>.</li>
<li>You have created an <code>election</code> Pact module and deployed it as described in <a href="/docs/resources/election-workshop/workshop-write">Write a smart contract</a>.</li>
<li>You have added functions and updated the <code>election</code> module deployed on the development network as described in <a href="/docs/resources/election-workshop/workshop-nominate">Nominate candidates</a> and <a href="/docs/resources/election-workshop/workshop-vote">Add vote management</a>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-voter-account">Create a voter account<a href="#create-a-voter-account" class="hash-link" aria-label="Direct link to Create a voter account" title="Direct link to Create a voter account">​</a></h2>
<p>In the previous tutorial, you voted with your administrative account.
The transaction was successful because the account had sufficient funds to pay the transaction fee.
For this tutorial, you need to create a new voter account on the development network.
Initially, you&#x27;ll use the voter account to see that voting in the election application requires you to have funds in an account.
Later, you&#x27;ll use the voter account to verify that voting transactions are paid using a separate gas station account.</p>
<p>As previously discussed, there are many ways you can create keys and accounts, including <code>kadena-cli</code> commands, Chainweaver, or another wallet application.
For this tutorial, you&#x27;ll create an account in the wallet you created when you ran the <code>kadena config init</code> command in <a href="/docs/resources/election-workshop/workshop-start#create-an-account">Create an account</a>.</p>
<p>To create a voter account:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open a terminal shell on your computer.</p>
</li>
<li>
<p>Add a new account to the wallet by running <code>kadena account add</code> and following the prompts displayed.</p>
<p>For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? How would you like to add the account locally? Wallet - Add an account by providing public keys from a list of available wallets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a wallet: Wallet: pistolas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter an alias for an account: voter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the name of a fungible: coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select public keys to add to account(index - alias - publickey): Generate new public key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the wallet password: ********</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a keyset predicate: keys-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The account configuration &quot;voter&quot; has been saved in .kadena/accounts/voter.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You now have a new local <code>voter</code> account.
However, the account doesn&#x27;t exist on any specific network or chain.
You could use <code>kadena account fund</code> to give the account a minimal balance on the development network.
For the purposes of this tutorial, you want to add the account to the coin ledger with a zero (0.0) balance.
To do that, you can create a transaction that calls the <code>coin.create-account</code> function.</p>
</li>
<li>
<p>Add a new <code>create-account.ktpl</code> transaction template for creating an account in the <code>.kadena/transaction-templates</code> folder.
For example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">account &quot;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">new</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot; (read</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keyset &quot;account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">guard&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">account-guard</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pred</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">predicate</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">chainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{chain-id}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sender</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">wallet</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasPrice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.00000001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ttl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">signers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">public</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">wallet</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">caps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;coin.GAS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networkId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{network:networkId}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> exec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
<p>For this transaction:</p>
<ul>
<li>Use the <code>voter</code> account name from your wallet for the <code>new-account-name</code> variable.</li>
<li>Use the <code>voter</code> public key for the <code>publicKey</code> variable.</li>
<li>Use the <code>wallet</code> account name for the <code>wallet-account</code> variable.</li>
<li>Use the <code>wallet</code> public key for the <code>wallet-publicKey</code> variable.</li>
</ul>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
<p>For this transaction, select the <code>Sign with wallet</code> option and specify the wallet password.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="attempt-to-cast-a-vote">Attempt to cast a vote<a href="#attempt-to-cast-a-vote" class="hash-link" aria-label="Direct link to Attempt to cast a vote" title="Direct link to Attempt to cast a vote">​</a></h2>
<p>To attempt to cast a vote with the new <code>voter</code> account:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Add a new <code>vote.ktpl</code> transaction template in the <code>.kadena/transaction-templates</code> folder.
For example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (n_90785a0e8c65525ef342c84991842f851868f7cb.election.vote &quot;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">chainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{chain-id}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">sender</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{{account-name}}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">gasLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">gasPrice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.000001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">ttl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">signers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">public</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{public-key}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">caps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networkId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{network-id}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
<p>For this transaction:</p>
<ul>
<li>Use the voter account name from your wallet for the <code>account-name</code> variable.</li>
<li>Use the chain where you deployed the election module for the <code>chain-id</code> variable.</li>
<li>Use the voter public key for the <code>publicKey</code> variable.</li>
<li>Use development for the <code>network-id</code> variable.</li>
</ul>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command, select the <code>Sign with wallet</code> option, and type the wallet password.</p>
</li>
<li>
<p>Send the signed transaction by running the <code>kadena tx send</code> command and selecting the signed transaction file.</p>
<p>Because the current implementation doesn&#x27;t allow accounts with a zero balance to vote, you&#x27;ll see that the transaction fails with an error message similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Error in processing transaction: &quot;D62Gs0Zx...3f8vuajw&quot; Failed to buy gas: Insufficient funds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implement-the-gas-payer-interface">Implement the gas payer interface<a href="#implement-the-gas-payer-interface" class="hash-link" aria-label="Direct link to Implement the gas payer interface" title="Direct link to Implement the gas payer interface">​</a></h2>
<p>Before accounts without funds can vote, you need to add a second Pact module—the <code>election-gas-station</code> module—that implements the <code>gas-payer</code> interface to your <code>election</code> smart contract.</p>
<p>To create the gas station module:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact</code> folder in the code editor on your computer.</p>
</li>
<li>
<p>Create a new <code>election-gas-station.pact</code> file in the <code>pact</code> folder.</p>
</li>
<li>
<p>Open the <code>election-gas-station.pact</code> file and add the Pact code to specify the namespace, module name, and module owner.</p>
<p>For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module election-gas-station GOVERNANCE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard (keyset-ref-guard &quot;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election-admin&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see in this example, the new module—like the <code>election</code> module—is deployed in the principal namespace and governed by the <code>election-admin</code> keyset.
Be sure you replace the namespace and keyset information with the principal namespace and keyset you have deployed on the development network.</p>
</li>
<li>
<p>Add <code>gas-payer-v1</code> as the interface you want to implement in this module inside of the module declaration.</p>
<p>For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module election-gas-station GOVERNANCE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard (keyset-ref-guard &quot;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election-admin&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (implements gas-payer-v1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can find the <code>gas-payer-v1</code> interface locally in the <code>election-workshop/pact/root/gas-payer-v1.pact</code> file for your project so that you can test your module in the Pact REPL.
The interface is also pre-installed on the Kadena development, test, and main networks, so you don&#x27;t need to deploy it when you deploy the <code>election-gas-station</code> module.
However, you must implement the capabilities, types, and functions that are defined in the <code>gas-payer-v1.pact</code> file before you can start testing.</p>
</li>
<li>
<p>Implement the <code>GAS_PAYER</code> capability as defined in the <code>gas-payer-v1.pact</code> file and compose an inner capability called <code>ALLOW_GAS</code> to use as a guard for the account used to pay transaction fees:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GAS_PAYER:bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ( user  : string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       limit : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       price : decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (compose-capability (ALLOW_GAS))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap ALLOW_GAS () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-gas-payer-guard:guard ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (create-capability-guard (ALLOW_GAS))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this code, an account granted the <code>GAS_PAYER</code> capability can pay gas fees for any transaction.
In addition, the <code>create-gas-payer-guard</code> function uses the built-in <code>create-capability-guard</code> function to return a guard for the <code>ALLOW_GAS</code> capability.
The guarded inner capability <code>ALLOW_GAS</code> always returns <code>true</code> so that the gas station account can pay the transaction fees on behalf of any account.</p>
</li>
<li>
<p>Create a <code>election-gas-station.repl</code> file in the <code>pact</code> folder and add the following lines of code:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(load &quot;setup.repl&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load election gas station module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;root/gas-payer-v1.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;election-gas-station.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>election-gas-station.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact election-gas-station.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:3:2-3:33:Trace: &quot;Loading root/gas-payer-v1.pact...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root/gas-payer-v1.pact:0:0-31:1:Trace: Loaded interface gas-payer-v1, hash iIWAP1oen_kpXjFbnQM87AJRZIgtsfZcAwYrEy21RWQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:4:2-4:36:Trace: &quot;Loading election-gas-station.pact...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.pact:1:0-1:56:Trace: &quot;Namespace set to n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.pact:3:0-22:1:Trace: Loaded module n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election-gas-station, hash vYfspyHz004xJXyR224XLZsktOtPI5qEN5VcW7pZsdM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:5:0-5:11:Trace: &quot;Commit Tx 3 Load election gas station module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that you have a working implementation of the <code>gas-payer-v1</code> interface, you can deploy the new module on the development network to test whether it can pay the transaction fee for votes cast using the election application.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-module-on-the-development-network">Deploy the module on the development network<a href="#deploy-the-module-on-the-development-network" class="hash-link" aria-label="Direct link to Deploy the module on the development network" title="Direct link to Deploy the module on the development network">​</a></h2>
<p>To deploy the new Pact module on the development network:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Copy the <code>election-module-devnet.ktpl</code> transaction template that you created previously and rename the file as <code>election-gas-module-devnet.ktpl</code> to add create new transaction template.</p>
</li>
<li>
<p>Remove the <code>&quot;init-candidates&quot;: true</code> and <code>&quot;upgrade&quot;: true</code> properties, then save the file.</p>
</li>
<li>
<p>Create a transaction that uses the <code>election-gas-module-devnet.ktpl</code> template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>You can verify the transaction results using the request key for the transaction.</p>
<p><img decoding="async" loading="lazy" alt="Election module deployed on the development chain" src="/docs/assets/images/gas-module-loaded-29382f36478f60f937f79676c0adea82.jpg" width="1728" height="118" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-gas-station-account">Create the gas station account<a href="#create-the-gas-station-account" class="hash-link" aria-label="Direct link to Create the gas station account" title="Direct link to Create the gas station account">​</a></h2>
<p>Because the GAS_PAYER account is guarded by the ALLOW_GAS capability, you can use the <code>create-principal</code> built-in function to automatically create its account name with a <code>c:</code> prefix.
You can then define the gas station account name as a constant in the <code>election-gas-station.pact</code> file.</p>
<p>To create a capability-guarded account:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact</code> folder in the code editor on your computer.</p>
</li>
<li>
<p>Open the <code>election-gas-station.pact</code> file and add the following line of code to the end of the module declaration:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defconst GAS_STATION_ACCOUNT (create-principal (create-gas-payer-guard)))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>./pact/election-gas-station.repl</code> file and update the transaction to display the capability-guarded gas station account name when you run the file.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(load &quot;setup.repl&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load election gas station module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;root/gas-payer-v1.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;election-gas-station.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [GAS_STATION_ACCOUNT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>election-gas-station.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact election-gas-station.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:4:2-4:36:Trace: &quot;Loading election-gas-station.pact...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.pact:1:0-1:56:Trace: &quot;Namespace set to n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.pact:3:0-24:1:Trace: Loaded module n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election-gas-station, hash QZMPB9N5frFc_gcJ3o7YtqTqCvMKhLA4OUxVT9X8sPU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:5:2-5:23:Trace: [&quot;c:1PaIauckhwRAVXP8YyoxSIczy60Nh9s9-_K59ugzW8A&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:6:0-6:11:Trace: &quot;Commit Tx 3 Load election gas station module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>election-gas-station.pact</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Add an <code>init</code> function that uses the <code>create-account</code> function from the <code>coin</code> module to create the gas station account in the <code>election-gas-station</code> module:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun init ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create-account GAS_STATION_ACCOUNT (create-gas-payer-guard))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this code:</p>
<ul>
<li>The first argument of the function is the account name you just defined.</li>
<li>The second argument is the guard for the account.</li>
</ul>
</li>
<li>
<p>Add an if-statement after the module declaration that calls the <code>init</code> function if the module is deployed with <code>{ &quot;init&quot;: true }</code> in the transaction data:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(if (read-msg &#x27;init)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [(init)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&quot;not creating the gas station account&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Update the <code>election-gas-station.repl</code> file to set <code>init</code> to true for the next transaction by adding the following lines of code after loading the <code>setup.repl</code> module:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { &quot;init&quot;: true }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>election-gas-station.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact election-gas-station.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.pact:29:0-32:1:Trace: [&quot;Write succeeded&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:9:2-9:23:Trace: [&quot;c:1PaIauckhwRAVXP8YyoxSIczy60Nh9s9-_K59ugzW8A&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election-gas-station.repl:10:0-10:11:Trace: &quot;Commit Tx 3 Load election gas station module&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you&#x27;re successful loading the <code>election-gas-station module</code> in the Pact REPL, you can update the module deployed on the development network.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-gas-station-module">Update the gas station module<a href="#update-the-gas-station-module" class="hash-link" aria-label="Direct link to Update the gas station module" title="Direct link to Update the gas station module">​</a></h2>
<p>To deploy the new Pact module on the development network:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open the <code>election-gas-module-devnet.ktpl</code> file, add the <code>&quot;init&quot;: true</code> property to the transaction data, and save the file.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">election-admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;{{public-key}}&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pred</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keys-all&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&quot;init&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the <code>election-gas-module-devnet.ktpl</code> template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>You can verify the transaction results using the request key for the transaction.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fund-the-gas-station-account">Fund the gas station account<a href="#fund-the-gas-station-account" class="hash-link" aria-label="Direct link to Fund the gas station account" title="Direct link to Fund the gas station account">​</a></h2>
<p>Now that you have created and deployed a secure gas station account, you&#x27;re ready to fund the account to pay transaction fees.</p>
<p>To fund the gas station account:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Create a transaction that uses the <code>transfer.ktpl</code> template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
<p>For this transaction:</p>
<ul>
<li>Use the election administrator account for the <code>account:from</code> variable.</li>
<li>Use the capability-guarded account (c:) for the <code>account:to</code> variable.</li>
<li>Use 1.0 for the <code>decimal:amount</code> variable.</li>
<li>Use the chain identifier where you deployed the election module for the <code>chain-id</code> variable.</li>
<li>Use the public key for election administrator for the <code>key:fromt</code> variable.</li>
<li>Use development for the <code>network-id</code> variable.</li>
</ul>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-vote-function">Update the vote function<a href="#update-the-vote-function" class="hash-link" aria-label="Direct link to Update the vote function" title="Direct link to Update the vote function">​</a></h2>
<p>The next step is to ensure that the signature of the voter account is within the scope of the <code>GAS_PAYER</code> capability.
To do this, you&#x27;ll update the <code>vote</code> function to accept the following arguments:</p>
<ul>
<li>The voter account name.</li>
<li>Zero as the gas limit to allow unlimited gas.</li>
<li>Zero as the gas price.</li>
</ul>
<p>You&#x27;ll also change the <code>senderAccount</code> in the transaction metadata to use the <code>election-gas-station</code> module so that the election gas station account pays the transaction fee for voting transactions instead of the voter account.</p>
<p>To update the <code>vote</code> function:</p>
<ol>
<li>
<p>Open the <code>frontend/src/repositories/vote/DevnetVoteRepository.ts</code> file in the code editor.</p>
</li>
<li>
<p>Update the <code>vote</code> function to change the <code>.addSigner(accountKey(account))</code> code as follows:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">accountKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">withCapability</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">withCapability</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NAMESPACE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">.election-gas-station.GAS_PAYER</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> int</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> decimal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Update the <code>senderAccount</code> in the transaction metadata to use the capability-guarded gas station account.</p>
<p>For example as follows:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMeta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   chainId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CHAIN_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ttl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   gasLimit</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   gasPrice</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.000001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   senderAccount</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;c:6mPDcWM1oMKDI3mdEio-Yczjul4IYZYcjlhZ--Rkhe8&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-the-scope-for-signatures">Set the scope for signatures<a href="#set-the-scope-for-signatures" class="hash-link" aria-label="Direct link to Set the scope for signatures" title="Direct link to Set the scope for signatures">​</a></h2>
<p>At this point, most of the work required to use a gas station to pay transaction fees is done.
However, when you added the <code>ACCOUNT-OWNER</code> capability to the <code>election-workshop/pact/election.pact</code> file in the previous tutorial, you didn&#x27;t set the scope for the capability.</p>
<p>In a test from the previous tutorial, the <code>caps</code> field passed to <code>env-sigs</code> is an empty array:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [{ &#x27;key  : &quot;voter&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &#x27;caps : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because the signature isn&#x27;t scoped to any capability, the unrestricted signing key automatically approves all capabilities required for the function to execute.</p>
<p>However, in this tutorial, you modified the <code>vote</code> function in the <code>frontend/src/repositories/vote/DevnetVoteRepository.ts</code> file to scope the signature of the <code>vote</code> transaction to grant the <code>GAS_PAYER</code> capability, but not the <code>ACCOUNT-OWNER</code> capability.</p>
<p>If you sign for some capabilities but not for all capabilities that are required for a transaction, the transaction will fail at the point where a capability is required that you didn&#x27;t sign for.
Therefore, you need to add a second capability to the array passed to <code>addSigners</code> in the <code>vote</code> function.</p>
<p>To set the scope for the <code>ACCOUNT-OWNER</code> capability:</p>
<ol>
<li>
<p>Open the <code>frontend/src/repositories/vote/DevnetVoteRepository.ts</code> file in the code editor.</p>
</li>
<li>
<p>Add the <code>ACCOUNT-OWNER</code> capability to the <code>.addSigner</code> with the following line of code:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">withCapability</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NAMESPACE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">.election.ACCOUNT-OWNER</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After making this change, the voter signature is scoped to two capabilities:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addSigner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">accountKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">withCapability</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">withCapability</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NAMESPACE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">.election-gas-station.GAS_PAYER</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> int</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> decimal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">withCapability</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NAMESPACE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">.election.ACCOUNT-OWNER</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cast-a-vote">Cast a vote<a href="#cast-a-vote" class="hash-link" aria-label="Direct link to Cast a vote" title="Direct link to Cast a vote">​</a></h2>
<p>To cast a vote with the voter account:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open <code>http://localhost:5173</code> in your browser and verify that there&#x27;s at least one candidate listed.</p>
</li>
<li>
<p>Click <strong>Set Account</strong>, copy and paste the voter account name from Chainweaver to vote using that account, then click <strong>Save</strong>.</p>
</li>
<li>
<p>Click <strong>Vote Now</strong> for a candidate, sign the transaction, and wait for it to complete.</p>
<p>You should see the vote count for the candidate you voted for incremented by one vote.</p>
<p><img decoding="async" loading="lazy" alt="View the result after voting" src="/docs/assets/images/election-two-votes-19cb60bc6ad6174684e68fce07066b2b.png" width="1542" height="804" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enforce-a-limit-on-transaction-fees">Enforce a limit on transaction fees<a href="#enforce-a-limit-on-transaction-fees" class="hash-link" aria-label="Direct link to Enforce a limit on transaction fees" title="Direct link to Enforce a limit on transaction fees">​</a></h2>
<p>You now have a functioning gas station for the election application. However, you might want to make some additional changes to make the module more secure. For example, you should enforce an upper limit for transaction fees to help ensure that funds in the gas station account aren&#x27;t drained too quickly.</p>
<p>To set an upper limit for transaction fees:</p>
<ol>
<li>
<p>Open the <code>election-gas-station.pact</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Add the following function to retrieve the gas price from the metadata of the transaction using the built-in <code>chain-data</code> function:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun chain-gas-price ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (at &#x27;gas-price (chain-data))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the following function to force the gas price to be below a specified limit.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun enforce-below-or-at-gas-price:bool (gasPrice:decimal)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce (&lt;= (chain-gas-price) gasPrice)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (format &quot;Gas Price must be lower than or equal to {}&quot; [gasPrice]))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Update the <code>GAS_PAYER</code> capability by adding <code>(enforce-below-or-at-gas-price 0.000001)</code> right before <code>(compose-capability (ALLOW_GAS))</code>.</p>
<p>For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(enforce-below-or-at-gas-price 0.000001)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(compose-capability (ALLOW_GAS))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-limits-on-the-transactions-allowed">Set limits on the transactions allowed<a href="#set-limits-on-the-transactions-allowed" class="hash-link" aria-label="Direct link to Set limits on the transactions allowed" title="Direct link to Set limits on the transactions allowed">​</a></h2>
<p>In its current state, any module can use your gas station to pay for any type of transaction, including transactions that involve multiple steps and could be quite costly. For example, a cross-chain transfer is a transaction that requires a continuation with part of the transaction taking place on the source chain and completed on the destination chain. This type of &quot;continued&quot; transaction requires more computational resources—that is, more gas—than a simple transaction that completes in a single step.</p>
<p>To prevent the gas station account from being depleted by transactions that require multiple steps, you can configure the gas station module to only allow simple transactions, identified by the <code>exec</code> transaction type. Transactions identified with the <code>exec</code> transaction type can contain multiple functions but complete in a single step.</p>
<p>To set limits on the transactions allowed to access the gas station account:</p>
<ol>
<li>
<p>Open the <code>election-gas-station.pact</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Restrict the transaction type to only allow <code>exec</code> transactions by adding the following line to the start of the <code>GAS_PAYER</code> capability definition:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(enforce (= &quot;exec&quot; (at &quot;tx-type&quot; (read-msg))) &quot;Can only be used inside an exec&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An <code>exec</code> transaction can contain multiple function calls. You can further restrict access to the funds in the gas station account by only allowing specific function calls.</p>
<p>An <code>exec</code> transaction can contain multiple function calls. You can also restrict access to the gas station account by only allowing specific function calls.</p>
</li>
<li>
<p>Restrict access to only allow one function call by adding the following line to the <code>GAS_PAYER</code> capability definition:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(enforce (= 1 (length (at &quot;exec-code&quot; (read-msg)))) &quot;Can only be used to call one pact function&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Restrict access to only pay transaction fees for functions defined in the <code>election</code> module by adding the following line to the <code>GAS_PAYER</code> capability definition:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(enforce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (= &quot;(n_14912521e87a6d387157d526b281bde8422371d1.election.&quot; (take 52 (at 0 (at &quot;exec-code&quot; (read-msg)))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Only election module calls are allowed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-smart-contract-on-the-development-network">Update the smart contract on the development network<a href="#update-the-smart-contract-on-the-development-network" class="hash-link" aria-label="Direct link to Update the smart contract on the development network" title="Direct link to Update the smart contract on the development network">​</a></h2>
<p>After you&#x27;ve completed the changes to secure the gas station account, you are ready to update the smart contract you have deployed on the development network and complete the workshop.</p>
<p>To update the smart contract and complete the workshop:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact</code> folder in a terminal shell on your computer and verify all of the tests you created in the workshop pass using the Pact REPL.</p>
<ul>
<li>pact/candidates.repl</li>
<li>pact/election-gas-station.repl</li>
<li>pact/keyset.repl</li>
<li>pact/module.repl</li>
<li>pact/namespace.repl</li>
<li>pact/principal-namespace.repl</li>
<li>pact/setup.repl</li>
</ul>
</li>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open and unlock the Chainweaver desktop or web application and verify that:</p>
<ul>
<li>You&#x27;re connected to <strong>development network (devnet)</strong> from the network list.</li>
<li>Your administrative account name with the <strong>k:</strong> prefix exists on chain 1.</li>
<li>Your administrative account name is funded with KDA on chain 1.</li>
</ul>
</li>
<li>
<p>Open the <code>election-workshop/snippets</code> folder in a terminal shell on your computer.</p>
</li>
<li>
<p>Update your <code>election-gas-station</code> module on the development network by running a command similar to the following with your administrative account name:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run deploy-gas-station:devnet -- k:&lt;your-public-key&gt; upgrade</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember that <code>k:&lt;your-public-key&gt;</code> is the default <strong>account name</strong> for the administrative account that you funded in <a href="/docs/resources/election-workshop/workshop-admin">Add an administrator account</a>. You can copy this account name from Chainweaver when viewing the account watch list. When you run the script, you should see Chainweaver display a QuickSign Request.</p>
</li>
<li>
<p>Click <strong>Sign All</strong> to sign the request.</p>
<p>After you click Sign All, the transaction is executed and the results are displayed in your terminal shell.</p>
</li>
<li>
<p>Verify your contract changes in the Chainweaver Module Explorer by refreshing the list of <strong>Deployed Contracts</strong>, then clicking <strong>View</strong> for the <code>election-gas-station</code> module.</p>
<p>After you click View, you should see the updated list of functions and capabilities. If you click <strong>Open</strong>, you can view the module code in the editor pane and verify that the <code>election-gas-station</code> module deployed on the local development network is what you expect.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<p>In this tutorial, you learned how to:</p>
<ul>
<li>Add a second module to your smart contract.</li>
<li>Define a gas station account that pays transaction fees on behalf of other accounts.</li>
<li>Restrict access to the gas station account based on conditions you specify in the Pact module.</li>
<li>Deploy the gas station module on the development network.</li>
</ul>
<p>In this workshop, you configured an election application to use the Kadena client to interact with a smart contract deployed on the Kadena blockchain as its backend. The workshop demonstrates the basic functionality for conducting an election online that uses a blockchain to provide more efficient, transparent, and tamper-proof results. However, as you saw in <a href="/docs/resources/election-workshop/workshop-vote">Add vote management</a>, it&#x27;s possible for individuals to vote more than once by simply creating additional Kadena accounts. That might be a challenge you want to explore.</p>
<p>As an alternative, you might want to deploy the election application and smart contract on the Kadena test network, making it available to community members.</p>
<p>We can&#x27;t wait to see what you build next.</p>
<p>To see the code for the activity you completed in this tutorial, check out the <code>00-complete</code> branch from the <code>voting-dapp</code> repository by running the following command in your terminal shell:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout 00-complete</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/resources/election-workshop/9-add-a-gas-station.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before you begin</a></li><li><a href="#create-a-voter-account" class="table-of-contents__link toc-highlight">Create a voter account</a></li><li><a href="#attempt-to-cast-a-vote" class="table-of-contents__link toc-highlight">Attempt to cast a vote</a></li><li><a href="#implement-the-gas-payer-interface" class="table-of-contents__link toc-highlight">Implement the gas payer interface</a></li><li><a href="#deploy-the-module-on-the-development-network" class="table-of-contents__link toc-highlight">Deploy the module on the development network</a></li><li><a href="#create-the-gas-station-account" class="table-of-contents__link toc-highlight">Create the gas station account</a></li><li><a href="#update-the-gas-station-module" class="table-of-contents__link toc-highlight">Update the gas station module</a></li><li><a href="#fund-the-gas-station-account" class="table-of-contents__link toc-highlight">Fund the gas station account</a></li><li><a href="#update-the-vote-function" class="table-of-contents__link toc-highlight">Update the vote function</a></li><li><a href="#set-the-scope-for-signatures" class="table-of-contents__link toc-highlight">Set the scope for signatures</a></li><li><a href="#cast-a-vote" class="table-of-contents__link toc-highlight">Cast a vote</a></li><li><a href="#enforce-a-limit-on-transaction-fees" class="table-of-contents__link toc-highlight">Enforce a limit on transaction fees</a></li><li><a href="#set-limits-on-the-transactions-allowed" class="table-of-contents__link toc-highlight">Set limits on the transactions allowed</a></li><li><a href="#update-the-smart-contract-on-the-development-network" class="table-of-contents__link toc-highlight">Update the smart contract on the development network</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>