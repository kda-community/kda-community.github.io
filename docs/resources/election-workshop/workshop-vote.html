<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-resources/election-workshop/workshop-vote" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Add vote management | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/resources/election-workshop/workshop-vote"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Add vote management | Kadena Docs"><meta data-rh="true" name="description" content="Add voting and vote counting functionality to the election application in the Pact module smart contract backend."><meta data-rh="true" property="og:description" content="Add voting and vote counting functionality to the election application in the Pact module smart contract backend."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/resources/election-workshop/workshop-vote"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-vote" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/resources/election-workshop/workshop-vote" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Add vote management</h1></header>
<p>In the previous tutorial, you built and deployed an <code>election</code> module on the local development network.
You then connected the frontend built with the <code>@kadena/client</code> library to the development network backend.
After connecting the frontend to the development network backend, you were able to view the candidate you added to the <code>candidates</code> database table.</p>
<p>In this tutorial, you&#x27;ll update the <code>election</code> module to allow anyone with a Kadena single-key account to cast a vote on a candidate.
After you update the backend functionality, you&#x27;ll modify the vote functionality for the frontend to use the development network.
After making these changes, Kadena account holders can vote using the <code>election</code> module and have their votes recorded on the blockchain, ensuring the security and transparency of the election process.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before you begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before you begin" title="Direct link to Before you begin">​</a></h2>
<p>Before you start this tutorial, verify the following basic requirements:</p>
<ul>
<li>You have an internet connection and a web browser installed on your local computer.</li>
<li>You have a code editor, such as <a href="https://code.visualstudio.com/download" target="_blank" rel="noopener noreferrer">Visual Studio Code</a>, access to an interactive terminal shell, and are generally familiar with using command-line programs.</li>
<li>You have cloned the <a href="https://github.com/kadena-community/voting-dapp.git" target="_blank" rel="noopener noreferrer">voting-dapp</a> repository to create your project directory as described in <a href="/docs/resources/election-workshop/workshop-prepare">Prepare your workspace</a>.</li>
<li>You have the development network running in a Docker container as described in <a href="/docs/resources/election-workshop/workshop-start">Start a local blockchain</a>.</li>
<li>You are <a href="/docs/resources/election-workshop/workshop-start#connect-to-the-development-network">connected to the development network</a> using your local host IP address and port number 8080.</li>
<li>You have created and funded an administrative account as described in <a href="/docs/resources/election-workshop/workshop-admin">Add an administrator account</a>.</li>
<li>You have created a principal namespace on the development network as described in <a href="/docs/resources/election-workshop/workshop-namespace">Define a namespace</a>.</li>
<li>You have defined the keyset that controls your namespace using the administrative account as described in <a href="/docs/resources/election-workshop/workshop-keysets">Define keysets</a>.</li>
<li>You have created an election Pact module and deployed it as described in <a href="/docs/resources/election-workshop/workshop-write">Write a smart contract</a> and updated its functionality as described in <a href="/docs/resources/election-workshop/workshop-nominate">Nominate candidates</a>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="organize-tests-in-repl-files">Organize tests in REPL files<a href="#organize-tests-in-repl-files" class="hash-link" aria-label="Direct link to Organize tests in REPL files" title="Direct link to Organize tests in REPL files">​</a></h2>
<p>So far, you have added all of your tests for the <code>election</code> module to the  <code>election-workshop/pact/election.repl</code> file.
While this is convenient if you have a small number of tests, continuing to add tests to a single file will make testing more complex and more difficult to follow.
To keep tests more organized, you can split them into multiple <code>.repl</code> files and reuse the code by loading one file into the other.</p>
<p>To organize tests into separate files:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact</code> folder in the code editor on your computer.</p>
</li>
<li>
<p>Rename <code>election.repl</code> to <code>candidates.repl</code>.</p>
</li>
<li>
<p>Create a new <code>setup.repl</code> file in the <code>pact</code> folder.</p>
</li>
<li>
<p>Move the code before <code>(begin-tx &quot;Load election module&quot;)</code> from the <code>candidates.repl</code> into the <code>setup.repl</code> file.</p>
</li>
<li>
<p>Create a new <code>voting.repl</code> file in the <code>pact</code> folder and add the following as the first line in the file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(load &quot;setup.repl&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>candidates.repl</code> file and add the following as the first line in the file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(load &quot;setup.repl&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Verify tests in the <code>candidates.repl</code> file still pass by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact candidates.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Verify that <code>voting.repl</code> loads successfully by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implement-and-test-a-vote-function">Implement and test a vote function<a href="#implement-and-test-a-vote-function" class="hash-link" aria-label="Direct link to Implement and test a vote function" title="Direct link to Implement and test a vote function">​</a></h2>
<p>When an account holder clicks <strong>Vote Now</strong> in the election application, it triggers a call to the <code>vote</code> function in the <code>frontend/src/repositories/vote/DevnetVoteRepository.ts</code> file, passing the current account name and the name of the candidate corresponding to the table row that was clicked.
The <code>vote</code> function in the frontend uses the Kadena client to execute the <code>vote</code> function defined in the <code>election</code> module.</p>
<p>To implement the <code>vote</code> function in the <code>election</code> Pact module, you can test your code as you go using the Pact REPL as you did in previous tutorials.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-incrementing-votes">Test incrementing votes<a href="#test-incrementing-votes" class="hash-link" aria-label="Direct link to Test incrementing votes" title="Direct link to Test incrementing votes">​</a></h3>
<p>Based on the work you did in the previous tutorial, the election application website displays a table of the candidates you have added.
Each candidate starts with zero (0) votes.
Each row in the table has a <strong>Vote Now</strong> button.
If you click <strong>Vote Now</strong>, the number of votes displayed in corresponding row should be increased by one.
The table is rendered based on the result of a call to the <code>list-candidates</code> function of the <code>election</code> Pact module.
So, in the Pact REPL you can test the behavior of the new <code>vote</code> function against the return value of <code>list-candidates</code>.</p>
<p>To test incrementing votes for a candidate:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/election.pact</code> file in your code editor.</p>
</li>
<li>
<p>Define the <code>vote</code> function after the <code>add-candidate</code> function with the following lines of code:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun vote (candidateKey:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-read candidates candidateKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot; := name, &quot;votes&quot; := numberOfVotes }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (update candidates candidateKey { &quot;votes&quot;: (+ numberOfVotes 1) })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this code:</p>
<ul>
<li>The <code>vote</code> function takes one argument—<code>candidateKey</code>—with a type of string.</li>
<li>The <code>candidateKey</code> specifies the key for the row in the <code>candidates</code> table to read using the <code>with-read</code>  built-in function.</li>
<li>The database column named <code>&quot;votes&quot;</code> is assigned a value from the <code>numberOfVotes</code> variable.</li>
</ul>
<p>The <code>vote</code> function then calls the <code>update</code> built-in function with three arguments to specify:</p>
<ul>
<li>The table to update (<code>candidates</code>).</li>
<li>The key for the row to update (<code>candidateKey</code>).</li>
<li>An object with the column names to update and the new value for the respective columns.
In this case, the <code>vote</code> function only updates the <code>votes</code> column.
The new value is the current number of votes that was obtained from <code>with-read</code> and stored in the <code>numberOfVotes</code> variable incremented by one (<code>(+ numberOfVotes 1)</code>).</li>
</ul>
</li>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor.</p>
</li>
<li>
<p>Add transactions to load the <code>election</code> Pact module and to add a candidate to the <code>candidates</code> table:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load election module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;election.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Add a candidate&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (add-candidate { &quot;key&quot;: &quot;1&quot;, &quot;name&quot;: &quot;Candidate A&quot; })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
<li>
<p>Add a transaction to test casting a vote for Candidate A by adding the following lines of code to the <code>voting.repl</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Voting for a candidate&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Candidate A has 0 votes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (at &quot;votes&quot; (at 0 (list-candidates)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (vote &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Candidate A has 1 vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (at &quot;votes&quot; (at 0 (list-candidates)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This code:</p>
<ul>
<li>Verifies that the candidate is initialized with zero votes.</li>
<li>Calls the <code>vote</code> function with the key value (<code>1</code>) of the candidate as the only argument.</li>
<li>Asserts that the candidate has one vote.</li>
</ul>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:11:0-11:35:Trace: &quot;Begin Tx 4 Voting for a candidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:12:5-12:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:13:5-17:6:Trace: &quot;Expect: success Candidate A has 0 votes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:18:5-18:15:Trace: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:19:5-23:6:Trace: &quot;Expect: success Candidate A has 1 vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:24:3-24:14:Trace: &quot;Commit Tx 4 Voting for a candidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-voting-for-an-invalid-candidate">Test voting for an invalid candidate<a href="#test-voting-for-an-invalid-candidate" class="hash-link" aria-label="Direct link to Test voting for an invalid candidate" title="Direct link to Test voting for an invalid candidate">​</a></h3>
<p>To make the <code>vote</code> function more robust, you should handle the scenario where the <code>candidateKey</code> doesn&#x27;t exist in the database.</p>
<p>To test casting a vote for a candidate that doesn&#x27;t exist:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Add a new transaction to test that voting for a candidate the doesn&#x27;t exist fails.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Voting for a candidate that doesn&#x27;t exist fails&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Cannot vote for a non-existing candidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (vote &quot;20&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:26:3-26:63:Trace: &quot;Begin Tx 5 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:27:5-27:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:28:5-31:6:Trace: &quot;Expect failure: Success: Cannot vote for a non-existing candidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:32:3-32:14:Trace: &quot;Commit Tx 5 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The test returns the expected result—failure—because the call to <code>with-read</code> fails for the <code>candidateKey</code> value of <code>&quot;20&quot;</code>.
The failure prevents the execution of the <code>update</code> function.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-error-handling">Test error handling<a href="#test-error-handling" class="hash-link" aria-label="Direct link to Test error handling" title="Direct link to Test error handling">​</a></h3>
<p>In its current implementation, the <code>vote</code> function doesn&#x27;t provide any specific checks or error handling.
As you iterate and improve the <code>vote</code> function to check for specific error conditions, you should return error messages with specific information about why the call to the function failed.</p>
<p>In the previous example, the <code>expect-failure</code> function didn&#x27;t include an expected outcome message.
If you update the invalid candidate transaction to specify an expected error message and that message isn&#x27;t returned by the <code>vote</code> function, the transaction would fail.</p>
<p>For example, you could modify the transaction to include <code>&quot;Candidate does not exist&quot;</code> as the expected outcome like this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Voting for a non-existing candidate&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (expect-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Cannot vote for a non-existing candidate&quot; ; Name of the test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Candidate does not exist&quot;                 ; Expected outcome message for the failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (vote &quot;X&quot;)                                 ; Function call to execute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This transaction would fail with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:28:5-32:6:Trace: &quot;FAILURE: Cannot vote for a non-existing candidate: expected error message &#x27;Candidate does not exist&#x27;, got &#x27;No value found in table n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election_candidates for key: X&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:33:3-33:14:Trace: &quot;Commit Tx 5 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:28:5-32:6:FAILURE: Cannot vote for a non-existing candidate: expected error message &#x27;Candidate does not exist&#x27;, got &#x27;No value found in table n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election_candidates for key: X&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load failed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because the error message doesn&#x27;t contain the expected output of <code>Candidate does not exist</code> that you specified in the previous step, the <code>with-read</code> function returns a default error message.</p>
<p>If you want to provide a more specific error message, you can use the <code>with-default-read</code> built-in function.
The <code>with-default-read</code> function enables you to return a default object with default values or a specific error message if a specific condition is detected.</p>
<p>To add a specific error message to the <code>vote</code> function:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/election.pact</code> file in your code editor.</p>
</li>
<li>
<p>Update the <code>vote</code> function to use the <code>with-default-read</code> function:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun vote (candidateKey:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-default-read candidates candidateKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot;: &quot;&quot;, &quot;votes&quot;: 0 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot; := name, &quot;votes&quot; := numberOfVotes }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce (&gt; (length name) 0) &quot;Candidate does not exist&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (update candidates candidateKey { &quot;votes&quot;: (+ numberOfVotes 1) })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this code, a successful read operation assigns the value of the <code>&quot;name&quot;</code> column to a <code>name</code> variable and the value of the <code>&quot;votes&quot;</code> column to the <code>numberOfVotes</code> variable.
The function also checks that the candidate <code>name</code> associated with the <code>candidateKey</code> is not an empty string, and returns a specific error if it is.</p>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because the error message you specified in the <code>vote</code> function is returned, you should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:26:3-26:63:Trace: &quot;Begin Tx 5 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:27:5-27:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:28:5-32:6:Trace: &quot;Expect failure: Success: Cannot vote for a non-existing candidate&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:33:3-33:14:Trace: &quot;Commit Tx 5 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you add a transaction to call the vote function with an invalid candidate, the transaction fails with the expected error message.</p>
<p>For example, if you add this transaction to the <code>voting.repl</code> file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Voting for a candidate that doesn&#x27;t exist fails&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (vote &quot;1a&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You would see that the transaction fails with the expected error message:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:35:3-35:63:Trace: &quot;Begin Tx 6 Voting for a candidate that doesn&#x27;t exist fails&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:36:3-36:60:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election.pact:42:7: Candidate does not exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42 |        (enforce (&gt; (length name) 0) &quot;Candidate does not exist&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  at(n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election.vote.{DdbfNmuc8IcjjPjhqEltltjMr8sxvn_GcuPciJvLq3E} &quot;1a&quot;):voting.repl:37:5-37:16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load failed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prevent-double-votes">Prevent double votes<a href="#prevent-double-votes" class="hash-link" aria-label="Direct link to Prevent double votes" title="Direct link to Prevent double votes">​</a></h2>
<p>At this point, the <code>election</code> module allows voting, but it doesn&#x27;t yet restrict each Kadena account to only voting once.
To keep track of the accounts that have already voted, you can create a new <code>votes</code> table that uses the account name for each voter as the key and the candidate key as the only column.
In addition to a check against this table, you&#x27;ll also need to check the keyset used to sign each voting transaction.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-votes-schema-and-table">Define votes schema and table<a href="#define-votes-schema-and-table" class="hash-link" aria-label="Direct link to Define votes schema and table" title="Direct link to Define votes schema and table">​</a></h3>
<p>To define the database schema and table:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/election.pact</code> file in your code editor.</p>
</li>
<li>
<p>Add the schema for the <code>votes</code> database table inside of the <code>election</code> module declaration after the definition of the <code>candidates</code> schema and table with the following lines of code:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema votes-schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    candidateKey:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable votes:{votes-schema})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create the table outside of the election module by adding the following lines of code at the end of <code>./pact/election.pact</code>, after the <code>election</code> module definition and the <code>init-candidates</code> code snippet:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(if (read-msg &quot;init-votes&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [(create-table votes)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this code, the <code>read-msg</code> function reads the <code>init-votes</code> field from the transaction data.
If you set this field to <code>true</code> in your module deployment transaction, the statement between the first square brackets is executed.
This statement creates the <code>votes</code> table based on its schema definition inside the module when you load the module into the Pact REPL or upgrade the module on the blockchain.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact/setup.repl</code> file in your code editor.</p>
</li>
<li>
<p>Add <code>, &#x27;init-votes: true</code> to the <code>env-data</code> so that this data is loaded in the Pact REPL environment when you load the <code>election</code> module and the <code>votes</code> table is created:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   { &quot;election-admin&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       { &quot;keys&quot; : [ &quot;d0aa32802596b8e31f7e35d1f4995524f11ed9c7683450b561e01fb3a36c18ae&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       , &quot;pred&quot; : &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &quot;init-candidates&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &#x27;init-votes: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with <code>TableCreated</code> twice in the output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election.pact:55:0-58:1:Trace: [&quot;TableCreated&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">election.pact:59:0-62:1:Trace: [&quot;TableCreated&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-votes-table">Test the votes table<a href="#test-the-votes-table" class="hash-link" aria-label="Direct link to Test the votes table" title="Direct link to Test the votes table">​</a></h3>
<p>To test that an account can only vote once:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor.</p>
</li>
<li>
<p>Add a transaction to assert that it is not possible to cast more than one vote:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Double vote&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Cannot vote more than once&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Multiple voting not allowed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (vote &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction fails with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:35:0-35:24:Trace: &quot;Begin Tx 6 Double vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:36:3-36:60:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:37:3-41:4:Trace: &quot;FAILURE: Multiple voting not allowed: expected failure, got result: &quot;Write succeeded&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:42:0-42:11:Trace: &quot;Commit Tx 6 Double vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:37:3-41:4:FAILURE: Multiple voting not allowed: expected failure, got result: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load failed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because all transactions in the <code>voting.repl</code> file are signed with the <code>election-admin</code> signature defined in the <code>setup.repl</code> file, your administrative account can cast more than one vote on any <code>candidateKey</code>, making the election unfair.</p>
<p>To fix this issue, you&#x27;ll need to update the <code>vote</code> function in the <code>election</code> module.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact/election.pact</code> file in your code editor.</p>
</li>
<li>
<p>Update the <code>vote</code> function to include the account name and prevent the same account from voting more than once:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun vote (account:string candidateKey:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (let ((double-vote (account-voted account)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce (= double-vote false) &quot;Multiple voting not allowed&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-default-read candidates candidateKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot;: &quot;&quot;, &quot;votes&quot;: 0 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot; := name, &quot;votes&quot; := numberOfVotes }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce (&gt; (length name) 0) &quot;Candidate does not exist&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (update candidates candidateKey { &quot;votes&quot;: (+ numberOfVotes 1) })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (insert votes account { &quot;candidateKey&quot;: candidateKey })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This code:</p>
<ul>
<li>Adds the account of the voter as the first parameter of the <code>vote</code> function.</li>
<li>Stores the result from a new <code>account-voted</code> function in the <code>double-vote</code> variable and uses that value to prevent an account from voting more than once.</li>
<li>Enforces that no row in the <code>votes</code> table is keyed with the account name using the <code>with-default-read</code> pattern that you used to prevent voting on a non-existent candidate.</li>
<li>Inserts a new row into the <code>votes</code> table with the account name as the key and the candidate key as the value for the <code>candidateKey</code> column every time the <code>vote</code> function is called.</li>
</ul>
</li>
<li>
<p>Add the <code>account-voted</code> function to check if an account has already voted:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun account-voted:bool (account:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-default-read votes account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;candidateKey&quot;: &quot;&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;candidateKey&quot; := candidateKey }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (&gt; (length candidateKey) 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The frontend of the election application can then use the result from the <code>account-voted</code> function to determine if <strong>Vote Now</strong> should be enabled.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Update all calls to the <code>vote</code> function to pass your administrative account name as the first argument.</p>
<p>For example, update the <code>vote</code> function in the <code>Double vote</code> transaction:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Double vote&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Cannot vote more than once&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Multiple voting not allowed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (vote &quot;k:d0aa32802596b8e31f7e35d1f4995524f11ed9c7683450b561e01fb3a36c18ae&quot; &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:44:0-44:24:Trace: &quot;Begin Tx 7 Double vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:45:5-45:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:46:5-50:6:Trace: &quot;Expect failure: Success: Cannot vote more than once&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:51:0-51:11:Trace: &quot;Commit Tx 7 Double vote&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With these changes, the same account can&#x27;t call the <code>vote</code> function more than once.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prevent-voting-on-behalf-of-other-accounts">Prevent voting on behalf of other accounts<a href="#prevent-voting-on-behalf-of-other-accounts" class="hash-link" aria-label="Direct link to Prevent voting on behalf of other accounts" title="Direct link to Prevent voting on behalf of other accounts">​</a></h2>
<p>The current implementation of the <code>vote</code> function allows the administrative account to vote on behalf of other accounts.</p>
<p>To demonstrate voting on behalf of another account:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/setup.repl</code> file in the code editor on your computer.</p>
</li>
<li>
<p>Add a <code>voter-keyset</code> to <code>env-data</code> so that this data is loaded in the Pact REPL environment when you load the <code>election</code> module:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">, &quot;voter-keyset&quot;: { &quot;keys&quot;: [&quot;voter&quot;], &quot;pred&quot;: &quot;keys-all&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Load the <code>coin</code> module and the interfaces it implements with the following lines of code in the <code>setup.repl</code>:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Set up coin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;root/fungible-v2.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;root/fungible-xchain-v1.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;root/coin-v5.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (create-table coin.coin-table)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (create-table coin.allocation-table)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create-account &quot;voter&quot; (read-keyset &quot;voter-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create-account &quot;election-admin&quot; (read-keyset &quot;election-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This code:</p>
<ul>
<li>Creates the <code>coin.coin-table</code> and <code>coin.allocation-table</code> required to create the <code>voter</code> account.</li>
<li>Creates the <code>voter</code> account and your administrative account in the <code>coin</code> module database.</li>
</ul>
<p>In this example, the <code>election-admin</code> is the administrative account name and keyset defined in previous tutorials.
Remember to replace this information with the administrative account name that you funded on one or more chains.
For single-key accounts, the default convention is a <code>k:</code> prefix and public key.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor.</p>
</li>
<li>
<p>Add a transaction at the end of the file to cast a vote on behalf of the <code>voter</code> account signed by the <code>election-admin</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Vote on behalf of another account&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Voting on behalf of another account should not be allowed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Keyset failure (keys-all): [voter...]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (vote &quot;voter&quot; &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction fails with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:53:0-53:46:Trace: &quot;Begin Tx 9 Vote on behalf of another account&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:54:5-54:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:55:5-59:6:Trace: &quot;FAILURE: Keyset failure (keys-all): [voter]: expected failure, got result: &quot;Write succeeded&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:60:0-60:11:Trace: &quot;Commit Tx 9 Vote on behalf of another account&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:55:5-59:6:FAILURE: Keyset failure (keys-all): [voter]: expected failure, got result: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load failed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The test failed because the <code>voter</code> account name doesn&#x27;t exist in the <code>votes</code> table keys and the candidate exists, so the number of votes for the candidate is incremented.
You need to make sure that the signer of the transaction owns the <code>account</code> passed to the <code>vote</code> function.</p>
</li>
<li>
<p>Open the <code>election-workshop/pact/election.pact</code> file in the code editor.</p>
</li>
<li>
<p>Define the <code>ACCOUNT-OWNER</code> capability to enforce the guard of the account passed to the <code>vote</code> function:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(use coin [ details ])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(defcap ACCOUNT-OWNER (account:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard (at &quot;guard&quot; (coin.details account)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This code imports the <code>details</code> function from the <code>coin</code> module, then uses the <code>coin.details</code> function to get the guard for an account by account name.
In this case, <code>voter-keyset</code> is the guard for the account.
By enforcing this guard, you can ensure that the keyset used to sign the <code>vote</code> transaction belongs to the account name passed to the function.
For simplicity, the frontend code in the workshop assumes that account names always use the <code>k:</code> prefix followed by a public key convention.
Frontend code changes are required to differentiate between account names and public keys if you want to use arbitrary account names that don&#x27;t follow this convention.</p>
</li>
<li>
<p>Apply the capability by wrapping the <code>update</code> and <code>insert</code> statements in the <code>vote</code> function inside a <code>with-capability</code> statement as follows:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun vote (account:string candidateKey:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (let ((double-vote (account-voted account)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce (= double-vote false) &quot;Multiple voting not allowed&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-default-read candidates candidateKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot;: &quot;&quot;, &quot;votes&quot;: 0 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    { &quot;name&quot; := name, &quot;votes&quot; := numberOfVotes }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce (&gt; (length name) 0) &quot;Candidate does not exist&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (with-capability (ACCOUNT-OWNER account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (update candidates candidateKey { &quot;votes&quot;: (+ numberOfVotes 1) })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (insert votes account { &quot;candidateKey&quot;: candidateKey })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
</li>
</ol>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:53:0-53:46:Trace: &quot;Begin Tx 9 Vote on behalf of another account&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:54:5-54:62:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:55:5-59:6:Trace: &quot;Expect failure: Success: Voting on behalf of another account should not be allowed&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:60:0-60:11:Trace: &quot;Commit Tx 9 Vote on behalf of another account&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With these changes, the administrative account can&#x27;t vote on behalf of another account.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-voting-on-ones-own-behalf">Verify voting on one&#x27;s own behalf<a href="#verify-voting-on-ones-own-behalf" class="hash-link" aria-label="Direct link to Verify voting on one&#x27;s own behalf" title="Direct link to Verify voting on one&#x27;s own behalf">​</a></h3>
<p>To verify that the voter account can vote on its own behalf:</p>
<ol>
<li>
<p>Open the <code>election-workshop/pact/voting.repl</code> file in the code editor.</p>
</li>
<li>
<p>Add a transaction to verify that the <code>voter</code> account can vote on its own behalf, leading to an increase of the number of votes on <code>Candidate A</code> to 2:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [{ &quot;key&quot;  : &quot;voter&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   , &quot;caps&quot; : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Vote as voter&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (vote &quot;voter&quot; &quot;1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Candidate A has 2 votes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (at &quot;votes&quot; (at 0 (list-candidates)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Remember to replace the namespace with your own principal namespace.</p>
</li>
<li>
<p>Execute the code in the <code>voting.repl</code> file using the Pact command-line interpreter and the <code>--trace</code> command-line option.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact voting.repl -t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction succeeds with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:68:2-68:28:Trace: &quot;Begin Tx 10 Vote as voter&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:69:4-69:61:Trace: Loaded imports from n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80.election</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:70:4-70:22:Trace: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:71:4-75:5:Trace: &quot;Expect: success Candidate A has 2 votes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voting.repl:76:2-76:13:Trace: &quot;Commit Tx 10 Vote as voter&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>Impressive!
You now have a simple smart contract with the basic functionality for conducting an election that allows Kadena account holders to vote on the candidate of their choice.
With these changes, you&#x27;re ready to upgrade the <code>election</code> module on the development network.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-deployed-module">Update the deployed module<a href="#update-the-deployed-module" class="hash-link" aria-label="Direct link to Update the deployed module" title="Direct link to Update the deployed module">​</a></h2>
<p>Now that you&#x27;ve updated and tested your <code>election</code> module using the Pact REPL, you can update the module deployed on the local development network.</p>
<p>To update the <code>election</code> module on the development network:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open the <code>election-module-devnet.ktpl</code> file, replace the <code>&quot;init-candidates&quot;: true</code> with <code>&quot;init-votes&quot;: true</code> and add the <code>&quot;upgrade&quot;: true</code> property to the transaction data, and save the file.</p>
<p>For example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">election-admin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;{{public-key}}&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pred</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keys-all&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&quot;init-votes&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">&quot;upgrade&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Because you created in the <code>candidates</code> table in the previous tutorial, you must remove the <code>&quot;init-candidates&quot;: true</code> property from the transaction data.
You must include <code>&quot;init-votes&quot;: true</code> in the transaction data to create the <code>votes</code> table using the <code>(create-table votes)</code> statement when you update the <code>election</code> module.
Because you are redeploying your module on the same network and chain, you also must include <code>&quot;upgrade&quot;: true</code> in the transaction data.</p>
</li>
<li>
<p>Create a transaction that uses the <code>election-module-devnet.ktpl</code> template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed.</p>
</li>
<li>
<p>Send the signed transaction to the blockchain by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>You can verify the transaction results using the request key for the transaction.
If the transaction succeeded, you should see the TableCreated result in the transaction output.</p>
<p><img decoding="async" loading="lazy" alt="Successful deployment on the development network" src="/docs/assets/images/votes-table-f66062f17c14d73d8f53bfcaadde67e9.jpg" width="1750" height="490" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-frontend">Update the frontend<a href="#update-the-frontend" class="hash-link" aria-label="Direct link to Update the frontend" title="Direct link to Update the frontend">​</a></h2>
<p>As you learned in <a href="/docs/resources/election-workshop/workshop-nominate">Nominate candidates</a>, the election application frontend is written in TypeScript and uses repositories to exchange data with the backend.
By default, the frontend uses the in-memory implementations of the repositories.
By making changes to the implementation of the <code>interface IVoteRepository</code> in the <code>frontend/src/repositories/candidate/DevnetVoteRepository.ts</code> file, you can configure the frontend to use the <code>devnet</code> backend instead of the <code>in-memory</code> backend.
After making these changes, you can use the frontend to cast votes on candidates listed in the <code>candidates</code> table and managed by the <code>election</code> module running on the development network.</p>
<p>To update the frontend to use the <code>election</code> module:</p>
<ol>
<li>
<p>Open <code>election-workshop/frontend/src/repositories/candidate/DevnetVoteRepository.ts</code> in your code editor.</p>
</li>
<li>
<p>Update the values for the <code>CHAIN_ID</code> and <code>NAMESPACE</code> constants with the chain where you deployed the <code>election</code> module and your own principal namespace.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NETWORK_ID</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;development&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CHAIN_ID</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">API_HOST</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">http://localhost:8080/chainweb/0.0/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NETWORK_ID</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">/chain/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">CHAIN_ID</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">/pact</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NAMESPACE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;n_d5ff15d933b83c1ef691dce3dabacfdfeaeade80&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Review the <code>hasAccountVoted</code> function:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> hasAccountVoted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">account</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Promise</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">boolean</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> transaction </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Pact</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// @ts-ignore</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pact</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">NAMESPACE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">.election</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;account-voted&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">account</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setMeta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> chainId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CHAIN_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setNetworkId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">NETWORK_ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> result </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dirtyRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">transaction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">valueOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">boolean</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Remove the <code>@ts-ignore</code> comment from the function and notice the resulting errors.
To fix the errors, you must generate types for your Pact module that can be picked up by <code>@kadena/client</code>.</p>
</li>
<li>
<p>Open a terminal, change to the <code>election-workshop/frontend</code> directory, then generate types for your <code>election</code> module by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run pactjs:generate:contract:election</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This command uses the <code>pactjs</code> library to generate the TypeScript definitions for the election contract and should clear the errors reported by the code editor.
Depending on the code editor, you might need to close the project in the editor and reopen it to reload the code editor window with the change.</p>
</li>
<li>
<p>Review the <code>vote</code> function, remove the <code>@ts-ignore</code> comment, and save your changes to the <code>DevnetVoteRepository.ts</code> file.</p>
</li>
<li>
<p>In the terminal where <code>election-workshop/frontend</code> is your current working directory, install the frontend dependencies by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Start the frontend application configured to use the development network running locally by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run start-devnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cast-a-vote">Cast a vote<a href="#cast-a-vote" class="hash-link" aria-label="Direct link to Cast a vote" title="Direct link to Cast a vote">​</a></h2>
<p>Now that you have deployed the <code>election</code> module on the development network and updated the frontend to use the <code>election</code> module backend, you can use the election website to cast votes.</p>
<p>To cast a vote using the election website:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Open and unlock the Chainweaver desktop application and verify that:</p>
<ul>
<li>You&#x27;re connected to <strong>development</strong> network from the network list.</li>
<li>Your administrative account name with the <strong>k:</strong> prefix exists on the chain where you&#x27;ve deployed the <code>election</code> module.</li>
<li>Your administrative account name has funds on the chain where you&#x27;ve deployed the <code>election</code> module.</li>
</ul>
<p>For simplicity, the frontend uses the <code>createSignWithChainweaver</code> method to sign the transaction that calls the <code>vote</code> function.
The code for this call uses the default URL for the Chainweaver desktop application, 127.0.0.1:9467.
To sign the transaction with the key you generated for the administrative account using kadena-cli, you can add your account to Chainweaver or replace the call to the <code>createSignWithChainweaver</code> method with <code>createSignWithKeypair</code>.</p>
</li>
<li>
<p>Open <code>http://localhost:5173</code> in your browser, then click <strong>Set Account</strong>.</p>
</li>
<li>
<p>Paste your administrative account, then click <strong>Set</strong>.</p>
</li>
<li>
<p>Click <strong>Add Candidate</strong> to add candidates, if necessary.</p>
</li>
<li>
<p>Click <strong>Vote Now</strong> for a candidate row.</p>
</li>
<li>
<p>Sign the transaction, and wait for the transaction to finish.</p>
</li>
<li>
<p>Verify that the number of votes for the candidate you voted for increased by one vote.</p>
<p>After you vote, the Vote Now button is disabled because the frontend checks if your account has already voted by making a <code>local</code> request to the <code>account-voted</code> function of the <code>election</code> Pact module.</p>
<p><img decoding="async" loading="lazy" alt="View the result after voting" src="/docs/assets/images/election-after-voting-5885eb6df13db04a926b5f3bac59d8c6.jpg" width="2206" height="790" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<p>In this tutorial, you learned how to:</p>
<ul>
<li>Organize test cases into separate REPL files.</li>
<li>Modify the <code>vote</code> function iteratively using test cases and expected results.</li>
<li>Use the <code>with-default-read</code> function.</li>
<li>Add a <code>votes</code> database table to store the vote cast by each account holder.</li>
<li>Connect the voting functionality from the frontend to the development network as a backend.</li>
</ul>
<p>With this tutorial, you completed the functional requirements for the <code>election</code> Pact module, deployed the module on your local development network, and interacted with the blockchain backend through the frontend of the election application website.</p>
<p>However, you might have noticed that your administrative account had to pay for gas to cast a vote.</p>
<p>To make the election accessible, account holders should be able to cast a vote without having to pay transaction fees.
The next tutorial demonstrates how to add a <strong>gas station</strong> module to the <code>election</code> smart contract.
With this module, an election organization can act as the owner of an account that provides funds to pay the transaction fees on behalf of election voters.
By using a gas station, voters can cast votes without incurring any transaction fees.</p>
<p>To see the code for the activity you completed in this tutorial and get the starter code for the next tutorial, check out the <code>09-gas-station</code> branch from the <code>election-workshop</code> repository by running the following command in your terminal shell:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout 09-gas-station</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/resources/election-workshop/8-add-vote-management.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before you begin</a></li><li><a href="#organize-tests-in-repl-files" class="table-of-contents__link toc-highlight">Organize tests in REPL files</a></li><li><a href="#implement-and-test-a-vote-function" class="table-of-contents__link toc-highlight">Implement and test a vote function</a></li><li><a href="#prevent-double-votes" class="table-of-contents__link toc-highlight">Prevent double votes</a></li><li><a href="#prevent-voting-on-behalf-of-other-accounts" class="table-of-contents__link toc-highlight">Prevent voting on behalf of other accounts</a></li><li><a href="#update-the-deployed-module" class="table-of-contents__link toc-highlight">Update the deployed module</a></li><li><a href="#update-the-frontend" class="table-of-contents__link toc-highlight">Update the frontend</a></li><li><a href="#cast-a-vote" class="table-of-contents__link toc-highlight">Cast a vote</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>