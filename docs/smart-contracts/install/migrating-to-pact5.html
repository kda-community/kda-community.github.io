<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-smart-contracts/install/migrating-to-pact5" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Migrating to Pact 5 | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/smart-contracts/install/migrating-to-pact5"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Migrating to Pact 5 | Kadena Docs"><meta data-rh="true" name="description" content="Update your development environment and smart contracts to use the Pact 5 smart contract language and command-line interpreter."><meta data-rh="true" property="og:description" content="Update your development environment and smart contracts to use the Pact 5 smart contract language and command-line interpreter."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/smart-contracts/install/migrating-to-pact5"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/smart-contracts/install/migrating-to-pact5" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/smart-contracts/install/migrating-to-pact5" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/smart-contract-dev">Smart contracts</a><button aria-label="Collapse sidebar category &#x27;Smart contracts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/get-started-intro">Get started: Introduction to Pact</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/smart-contracts/install">Installation and setup</a><button aria-label="Collapse sidebar category &#x27;Installation and setup&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/install/linux">Install on Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/install/macos">Install on macOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/install/windows">Install on Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/install/tooling">Developer tooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/install/local-dev-node">Local development network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/smart-contracts/install/migrating-to-pact5">Migrating to Pact 5</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/basic-concepts">Basic concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/accounts">Accounts, keys, and principals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/lang-features">Pact features and conventions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/functions-variables">Functions, variables, and types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/modules">Modules and interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/capabilities">Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/guards">Guards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/databases">Database model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/transactions">Transaction format and flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contracts/best-practices">Pact best practices</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides">How-to guides</a><button aria-label="Expand sidebar category &#x27;How-to guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/coding-projects/coding-projects">Coding projects</a><button aria-label="Expand sidebar category &#x27;Coding projects&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/resources">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/smart-contract-dev"><span itemprop="name">Smart contracts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/smart-contracts/install"><span itemprop="name">Installation and setup</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Migrating to Pact 5</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrating to Pact 5</h1></header>
<p>The Pact programming language was designed to optimize the transactional logic in smart contracts executed in a resource-constrained blockchain environment.
Pact 5 represents a comprehensive refactoring of the Pact language and command-line interpreter that offers improvements in efficiency, performance, and ergonomics.
The improvements in Pact 5 ensure lower transaction costs, faster module loading, and enhanced testing and debugging capabilities.
To take advantage of these improvements, you need to update your development environment and smart contracts to use Pact 5.
This article covers the basics of upgrading to Pact 5 and details some of the breaking changes that might require you to update and redeploy existing contracts or fix potential coding errors.</p>
<p>The timeline for migrating to Pact 5 looks like this:</p>
<ul>
<li>Chainweb nodes will be upgraded to Pact 5 with the <code>chainweb-node</code> 2.27 release on 29 January 2025.</li>
<li>The Kadena main production network (<code>mainnet01</code>) will be upgraded to use Pact 5 on 10 February 2025.</li>
<li>The Kadena test network (<code>testnet04</code>) will be upgraded to use Pact 5 on 6 February 2025.</li>
<li>An interim test network (<code>testnet05</code>) is currently available for testing with Pact 5.
The <code>testnet05</code> network will be decommissioned and removed from service on 7 February 2025 after the <code>testnet04</code> network is upgraded to use Pact 5.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-to-migrate">Preparing to migrate<a href="#preparing-to-migrate" class="hash-link" aria-label="Direct link to Preparing to migrate" title="Direct link to Preparing to migrate">​</a></h2>
<p>Ideally, you should test any smart contracts you&#x27;ve written by installing Pact 5 locally before Pact 5 is released on the Kadena main production network.
If you install Pact 5 locally in your development environment, you can run all of your existing contract tests that you&#x27;ve defined in REPL files using the Pact 5 binary to verify that they work as expected.
For information about installing the Pact 5 binary locally, see <a href="/docs/smart-contracts/install">Installation and setup</a>.</p>
<p>You can also test that existing smart contracts work with Pact 5 by deploying them on the Kadena <code>testnet05</code> network.
You can connect to the <code>testnet05</code> network by using the API node available at <code>api.testnet05.chainweb.com</code>.
For examples of how to deploy contracts, see the <a href="/docs/guides/contracts/howto-deploy-contracts">Deploy smart contracts</a> guide.</p>
<p>Pact 5 will also be deployed by default on the <code>development</code> network that you can run locally beginning with the <code>chainweb-node</code> 2.27 release.
After <code>chainweb-node</code> 2.27 is released, you can start a local development node to build and test contracts using Pact 5 by default.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="after-upgrading-to-pact-5">After upgrading to Pact 5<a href="#after-upgrading-to-pact-5" class="hash-link" aria-label="Direct link to After upgrading to Pact 5" title="Direct link to After upgrading to Pact 5">​</a></h2>
<p>Most smart contracts written in Pact 4, or earlier, should be compatible with Pact 5 and continue to operate as expected without any issues.
However, some of the bugs that were found in earlier versions of Pact and corrected in the Pact 5 implementation might cause unexpected behavior in your contracts or require some type of modification to the contract code.</p>
<p>You can find details about new features and the types of issues you might encounter in the remainder of this document.</p>
<p>You don&#x27;t need to redeploy any existing contracts to use Pact 5.
However, redeploying will reduce the gas required to execute contract functions, because the newly-deployed version will use the Pact 5 on-disk format.
Pact 5 includes a new built-in function for redeploying contracts, so you can take advantage of reduced transaction costs without modifying any contract code or module hashes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="semantic-changes">Semantic changes<a href="#semantic-changes" class="hash-link" aria-label="Direct link to Semantic changes" title="Direct link to Semantic changes">​</a></h2>
<p>Pact 5 includes some changes to correct previously allowed but unintended behavior.
These changes might require you to modify your smart contract to conform to Pact 5 that enforces expected behavior.
Code examples illustrate the old behavior and how to modify your contract, if necessary.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="duplicate-capabilities-cannot-be-installed">Duplicate capabilities cannot be installed<a href="#duplicate-capabilities-cannot-be-installed" class="hash-link" aria-label="Direct link to Duplicate capabilities cannot be installed" title="Direct link to Duplicate capabilities cannot be installed">​</a></h3>
<p>In Pact 4, you could install a managed capability with identical parameters multiple times and specify a different value for the managed parameter in each <code>install-capability</code> expression.
This behavior was not the way the <code>install-capability</code> was intended to be used.
Using the <code>install-capability</code> function in this way didn&#x27;t introduce any security issues because you can&#x27;t install a capability to override a managed parameter specified in a signature.
However, the code did result in unexpected behavior as illustrated in the following code sample:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(module m g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun cap-mgr (a:integer b:integer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (let*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ((remaining (- a b)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (enforce (&gt;= remaining 0) &quot;Remaining must be non-negative&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap MANAGED (user:string amount:integer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @managed amount cap-mgr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun managed-example (user:string amount:integer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (with-capability</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (MANAGED user amount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;The capability was acquired successfully!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(install-capability (MANAGED &quot;stuart&quot; 1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(install-capability (MANAGED &quot;stuart&quot; 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(managed-example &quot;stuart&quot; 1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As illustrated in this example, Pact 4 allows you to install the <code>MANAGED</code> capability twice, but it selects the lexicographically smallest managed parameter.
In this case, because <code>0</code> comes before <code>1</code>, so the <code>(MANAGED &quot;stuart&quot; 0)</code> capability is selected instead of the <code>(MANAGED &quot;stuart&quot; 1)</code> capability, leading to the following output:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;scratch/discreps/install-cap.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/install-cap.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module m, hash oT9RPcfHZVhmCzHX3n51FKI0DC_Uwst06fqGQZu3hKI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Installed capability&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Installed capability&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scratch/discreps/install-cap.repl:8:5:Error: Remaining must be non-negative</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> at scratch/discreps/install-cap.repl:8:5: (enforce (native `&gt;=`  True if X &gt;= Y.  Type: x:&lt;a[integer,... &quot;Remaining must be non-negative&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> at scratch/discreps/install-cap.repl:5:2: (cap-mgr 0 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> at scratch/discreps/install-cap.repl:18:4: (with-capability (m.MANAGED &quot;stuart&quot; 1) [&quot;The capability was acquired successfully!&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> at scratch/discreps/install-cap.repl:27:0: (managed-example &quot;stuart&quot; 1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pact 5 does not allow installing duplicate capabilities, as shown below:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;scratch/discreps/install-cap.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/install-cap.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module m, hash gY4DlgJg2XkK6LPH1H81M5EhPohOSz9yd_sucAcRF9w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Installed capability&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scratch/discreps/install-cap.repl:26:0: Capability already installed: (m.MANAGED &quot;stuart&quot; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26 | (install-capability (MANAGED &quot;stuart&quot; 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In most cases, you can correct this issue by simply deleting the invocation of <code>install-capability</code> in your smart contracts because most managed capabilities are signed for, and thus implicitly installed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-install-capability-is-only-supported-for-managed-capabilities">Using install-capability is only supported for managed capabilities<a href="#using-install-capability-is-only-supported-for-managed-capabilities" class="hash-link" aria-label="Direct link to Using install-capability is only supported for managed capabilities" title="Direct link to Using install-capability is only supported for managed capabilities">​</a></h3>
<p>In Pact 4, you can use the <code>install-capability</code> function with any capability, regardless of whether it is a managed capability.
However, the sole purpose of this function is to track the value of a managed parameter.
Using this function with a capability that isn&#x27;t a managed capability has no effect.
The following code is a minimal reproduction:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(module m g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap UNMANAGED () 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(install-capability (UNMANAGED))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you execute this code in Pact 4, the output doesn&#x27;t report this behavior as an error:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;scratch/discreps/unmanaged-install.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/unmanaged-install.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module m, hash hha21FQe4BjRLJ4L5mfHLTBE18QhKFyf-hXlEF21g_Y&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Installed capability&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To prevent mistakes, Pact 5 is more strict, disallowing this behavior:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;scratch/discreps/unmanaged-install.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/unmanaged-install.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module m, hash E4C8JfW1e6rIThBWNDw3GON0COvPQVqm3ZXOWT80iCI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scratch/discreps/unmanaged-install.repl:7:0: Install capability error: capability is not managed and cannot be installed: m.UNMANAGED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7 | (install-capability (UNMANAGED))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="acquiring-module-administrator-privileges-for-operations">Acquiring module administrator privileges for operations<a href="#acquiring-module-administrator-privileges-for-operations" class="hash-link" aria-label="Direct link to Acquiring module administrator privileges for operations" title="Direct link to Acquiring module administrator privileges for operations">​</a></h3>
<p>Pact requires module administrator privileges to be acquired before performing the following operations:</p>
<ul>
<li>Upgrading a module.</li>
<li>Accessing or modifying a table.</li>
<li>Acquiring capabilities using the <code>with-capability</code> function.</li>
</ul>
<p>Pact 4 automatically attempts to acquire the module administrator privileges when executing these operations.
To prevent contracts from accidentally executing privileged actions, Pact 5 no longer automatically acquires the module administrator privileges except in the case of upgrading a module.
To acquire module administrator privileges explicitly, you can use the new <code>acquire-module-admin</code> built-in function,
This change makes security boundaries between modules much clearer.</p>
<p>For example, in the following contract code, the user Bob acquires module administrator privileges by writing directly to the table <code>foo</code> and gives himself a balance of <code>10000000000000</code> using Pact 4:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">; Uncomment the line when running with Pact 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; (env-exec-config [&quot;DisablePact44&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-data {&quot;admin&quot;:{&quot;keys&quot;:[&quot;some-key&quot;], &quot;pred&quot;:&quot;keys-all&quot;}})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;admin&quot; (read-keyset &quot;admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module m g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () (enforce-guard (keyset-ref-guard &quot;admin&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema fooschema user:string balance:integer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable foo:{fooschema})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(create-table foo)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(env-sigs [{&quot;key&quot;:&quot;some-key&quot;, &quot;caps&quot;:[]}])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Admin is being acquired here automatically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(write m.foo &quot;bob&quot; {&quot;user&quot;:&quot;bob&quot;, &quot;balance&quot;:10000000000000})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the administrator privileges are granted implicitly for the transaction that contains the <code>write</code> function, and the result that gives Bob a balance of 10000000000000 coins might be difficult to spot.
In Pact 5, Bob must explicitly acquire the administrative rights for the module.
For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(acquire-module-admin m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(write m.foo &quot;bob&quot; {&quot;user&quot;:&quot;bob&quot;, &quot;balance&quot;:10000000000000})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By acquiring the administrative rights before sending the <code>(write m.foo &quot;bob&quot; {&quot;user&quot;:&quot;bob&quot;, &quot;balance&quot;:10000000000000})</code> transaction, it&#x27;s clearer that the code is performing an administrative operation.
Note that this change doesn&#x27;t affect module deployment or upgrade transactions.
Module administrator privileges are requested automatically to redeploy a module.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-hashing">Module hashing<a href="#module-hashing" class="hash-link" aria-label="Direct link to Module hashing" title="Direct link to Module hashing">​</a></h3>
<p>In Pact 4, the same contract code would always yield the same module hash.
In Pact 5, a module’s hash is computed from both the module itself and the modules it depends on, increasing reliability and integrity.
The following REPL script illustrates this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module dependency g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun f () 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module m g </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun use-dependency ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module dependency g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun f () 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module m g </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun use-dependency ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output for this code in Pact 4 looks like this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;module-hashing.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/module-hashing.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Begin Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module dependency, hash QVQ9B6vNg3TNBrLeDH2jR7geVvFGPPHd6OOXthb6k_k&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module m, hash tyMLK_Kg71M2QSEHEJOZn8Q3x9KV_Wj0ldpkyTTwOEE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Commit Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Begin Tx 1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module dependency, hash zp3ZGRtmIeLSZnFsDuhqhsqJ3zcbnQ--R5wSjWCJJXA&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module m, hash tyMLK_Kg71M2QSEHEJOZn8Q3x9KV_Wj0ldpkyTTwOEE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Commit Tx 1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice that despite the change in the hash of <code>dependency</code>, the hash for the <code>m</code>  module doesn&#x27;t change.
This is no longer the case in Pact 5.
In Pact 5, the output for this code looks like this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;module-hashing.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/module-hashing.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Begin Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module dependency, hash YTZXSZChVLwUJkpm3_dSzidkfVB14Y8smFf7x1CfukY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module m, hash 5BpfxcjVb4usVyuLg25bk821RL_u9raD8e76U2zfS3M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Commit Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Begin Tx 1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module dependency, hash L9gxBgNRNESJIqS0wZN3xDAcuRa1IC3-yNN03mtFttQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module m, hash D45G9PizSn59QTRyUObLesCM9IEf_xrIM5OlpgQXxQg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Commit Tx 1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the Pact 5 output, the hash for the <code>m</code> module reflects the change in the dependencies.
This change is required for integrity, because otherwise, modules with the same hash can behave differently.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-names-and-variable-identifiers">Function names and variable identifiers<a href="#function-names-and-variable-identifiers" class="hash-link" aria-label="Direct link to Function names and variable identifiers" title="Direct link to Function names and variable identifiers">​</a></h3>
<p>In Pact 4, it was possible to use variable identifiers with the same name as built-in functions.
For example, in Pact 4, you can write a function like the following that uses <code>identity</code> as a variable identifier:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun register-identity:bool (user-address:string user-guard:guard identity:string country:integer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>However, <code>identity</code> is a reserved keyword for a built-in function.
In Pact 4, you are allowed to override or shadow the function name.
Pact 5 doesn&#x27;t allow this behavior, and variables that use the same name as a built-in function resolve as the built-in function.
If you use any variable identifiers with the same name as a built-in function name, you should modify the variable identifier to use a different name if you want to redeploy the contract as a Pact 5 contract.</p>
<p>For a list of the reserved built-in function names, see <a href="/docs/pact-5/func-quick-ref">Function quick reference</a>.
For a list of reserved keywords, see <a href="/docs/reference/syntax">Syntax and keywords</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integers-returned-as-objects">Integers returned as objects<a href="#integers-returned-as-objects" class="hash-link" aria-label="Direct link to Integers returned as objects" title="Direct link to Integers returned as objects">​</a></h3>
<p>In Pact 5, functions that return integer values return an object with <code>int</code> as the key field and a number as a string or a JSON number.
For example, you might see a return value similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">result: {status: &quot;success&quot;, data: {int: 1}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>According to the Pact specification for encoding and decoding values, if you return a raw JSON number without the <code>int</code> field, the value is a double.
If a function returns an object with the <code>int</code> field and a number, the value is an integer.</p>
<p>In Pact 4, integer values that were returned as objects were silently converted to doubles in results.
The silent conversion of integers to doubles caused tests that were written to expect integer values to fail.</p>
<p>In Pact 5, values are returned as described by the Pact codec.
Integer values are always returned as objects <code>{int: X}</code> and raw JSON numbers are always interpreted as doubles.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="changed-or-removed-built-in-functions">Changed or removed built-in functions<a href="#changed-or-removed-built-in-functions" class="hash-link" aria-label="Direct link to Changed or removed built-in functions" title="Direct link to Changed or removed built-in functions">​</a></h2>
<ul>
<li><code>pact-version</code> was usable in the REPL and with the <code>/local</code> endpoint to determine the current Pact version. It was removed in Pact 5 due to time constraints.</li>
<li><code>enforce-pact-version</code> was usable in the REPL and with the <code>/local</code> endpoint to assert on the current Pact version. It was removed in Pact 5 due to time constraints.</li>
<li><code>list</code> was removed in Pact 5 after it was deprecated with a warning and increased gas costs in Pact 4. <code>(list 1 2 3)</code> is equivalent to <code>[1 2 3]</code>.</li>
<li><code>decrypt-cc20p1305</code> and <code>validate-keypair</code> have been removed in Pact 5 due to time constraints and lack of users.</li>
<li><code>constantly</code> has changed in Pact 5. It now accepts exactly two arguments, and behaves as if it were <code>(lambda (x y) x)</code>.</li>
<li><code>txlog</code> was removed in Pact 5 due to time constraints and lack of users.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-built-in-functions">New built-in functions<a href="#new-built-in-functions" class="hash-link" aria-label="Direct link to New built-in functions" title="Direct link to New built-in functions">​</a></h2>
<p>The following functions are new in Pact 5.</p>
<ul>
<li>
<p><code>do</code> is a new special form that you can use to sequence statements. For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce (= 1 2) &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce (= 3 4) &quot;&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>acquire-module-admin</code> is a new function that you can use to explicitly acquire module administrator privileges as described in <a href="#acquiring-module-administrator-privileges-for-operations">Acquiring module administrator privileges for operations</a>.</p>
</li>
<li>
<p><code>static-redeploy</code> is a new function that you can use to redeploy existing modules into their Pact 5 format, making them cheaper and faster to load, without changing the contract code or updating the contract dependencies.
Note that the use of this function is not a privileged operation.
Anyone can do it to any module, and the module hash remains the same.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-and-result-interface">Request and result interface<a href="#request-and-result-interface" class="hash-link" aria-label="Direct link to Request and result interface" title="Direct link to Request and result interface">​</a></h2>
<p>In general, Pact 4 and Pact 5 command requests and command results can be parsed successfully by the Pact 5 parser as follows:</p>
<ul>
<li>
<p>Existing Pact 4 command requests can be parsed as Pact 5 commands, and Pact 5 command requests can be parsed as Pact 4 commands.</p>
</li>
<li>
<p>Pact 4 command results can be parsed as Pact 5 command results.</p>
</li>
<li>
<p>Successful Pact 5 command results can be parsed as Pact 4 command results.</p>
</li>
<li>
<p>Pact 5 command results with errors are not valid Pact 4 command results because the error format has changed.
Errors in Pact 5 include both a textual description of the error, and a hexadecimal error code to distinguish the exact error case.
The <code>pact</code> executable in Pact 5 can explain these error codes using the <code>--explain-error-code</code> option, but they can lack some more specific information from the textual error message.
For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; pact --explain-error-code 0x0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Encountered failure in: PELexerError, caused by: LexicalError</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gas-changes">Gas changes<a href="#gas-changes" class="hash-link" aria-label="Direct link to Gas changes" title="Direct link to Gas changes">​</a></h2>
<p>Because the Pact interpreter has been structurally changed, Pact 5 has different gas costs than Pact 4.
Pact 5 also uses more precise methods to determine the gas costs for certain built-in functions.</p>
<p>In practice, most functions require less gas when executed with Pact 5.
However, the only way to be sure your transactions don&#x27;t exceed gas limits is to test them using Pact 5, either by running smart contracts on <code>testnet05</code>, or by executing functions locally in a Pact 5 REPL.</p>
<p>In addition to lower gas costs, Pact 5 is stricter in checking the signature used to buy gas.
In Pact 4, you could successfully sign for the <code>coin.GAS</code> capability even if you included extra arguments, such as <code>(coin.GAS &quot;&quot;)</code> or <code>(coin.GAS 1)</code>.
In Pact 5, you can only sign for the <code>coin.GAS</code> capability with <code>(coin.GAS)</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="formal-verification">Formal verification<a href="#formal-verification" class="hash-link" aria-label="Direct link to Formal verification" title="Direct link to Formal verification">​</a></h2>
<p>The Pact 4 formal verification system is tightly coupled to the internal implementation of Pact 4.
Because Pact 5 is a complete re-implementation of the Pact language and command-line interpreter, Pact 5 doesn&#x27;t support the Pact 4 formal verification system.
A new formal verification system compatible with Pact 5 isn&#x27;t available at this time.
However, plans for improving or simplifying formal verification for Pact 5 contracts have been discussed and remain under consideration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parser-fixes">Parser fixes<a href="#parser-fixes" class="hash-link" aria-label="Direct link to Parser fixes" title="Direct link to Parser fixes">​</a></h2>
<p>In Pact 4, parser bugs allowed some syntactically invalid code to be parsed.
Executing this invalid code often caused unexpected behavior.
This section describes the most common syntactic errors that were found on-chain that are now disallowed by Pact 5, and how to fix them.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="let-expressions-binding-multiple-expressions-to-the-same-variable">Let-expressions binding multiple expressions to the same variable<a href="#let-expressions-binding-multiple-expressions-to-the-same-variable" class="hash-link" aria-label="Direct link to Let-expressions binding multiple expressions to the same variable" title="Direct link to Let-expressions binding multiple expressions to the same variable">​</a></h3>
<p><code>(let ((x 1 (enforce false &quot;boom&quot;))) x)</code></p>
<p>This is syntactically incorrect, as each let-bound variable can only bind one expression.
In Pact 4, this code is parsed successfully, with the result that <code>(enforce false &quot;boom&quot;)</code> is never evaluated.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="invalid-object-types">Invalid object types<a href="#invalid-object-types" class="hash-link" aria-label="Direct link to Invalid object types" title="Direct link to Invalid object types">​</a></h3>
<p><code>(defun f (a:object:{some-schema}) ...)</code></p>
<p>The correct syntax for object types is <code>object{schema}</code> where <code>schema</code> is a user-defined schema, not <code>object:{schema}</code>.
In Pact 4, this will lead to errors at runtime when invoking <code>f</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="binding-lists-missing-commas">Binding lists missing commas<a href="#binding-lists-missing-commas" class="hash-link" aria-label="Direct link to Binding lists missing commas" title="Direct link to Binding lists missing commas">​</a></h3>
<p>In the following module, the expression <code>(with-read my-table &quot;k&quot; { &quot;a&quot; := a b := b} 1)</code> is missing a comma between the bindings of the <code>a</code> and <code>b</code> variables:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(module m g </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema s a:integer) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable my-table:{s}) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun f () (with-read my-table &quot;k&quot; { &quot;a&quot; := a b := b} a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To fix this issue, add the comma to the expression.
For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;a&quot; := a, &quot;b&#x27; := b }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schemas-are-no-longer-allowed-in-terms">Schemas are no longer allowed in terms<a href="#schemas-are-no-longer-allowed-in-terms" class="hash-link" aria-label="Direct link to Schemas are no longer allowed in terms" title="Direct link to Schemas are no longer allowed in terms">​</a></h3>
<p>In Pact, a schema is essentially a type definition for an object type.
The schema type itself is not a value.
The following example is thus invalid:</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(module m g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap g () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema location city:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable locations:{location})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun get-city(entry:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (at &quot;city&quot; (read location entry))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the user intended to read the location at <code>entry</code> from the table <code>locations</code>, but instead wrote <code>location</code>, which is the schema.
It’s not uncommon for a user to name a schema in a similar fashion as the table that holds object of that schema.
In Pact 4, this code can be deployed, and leads to a hard-to-debug issue with a strange error message.
In Pact 5, this code cannot be deployed at all.</p>
<p>Running the above code with Pact 4 results in the following output:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;scratch/discreps/schemas-in-term.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/schemas-in-term.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loaded module m, hash 2SkSSD_LJqjZUSVxaqyXP7BYhP7Zl-D93awJPQeDHOM&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In Pact 5, the code output looks like this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt;(load &quot;scratch/discreps/schemas-in-term.repl&quot; true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading scratch/discreps/schemas-in-term.repl...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scratch/discreps/schemas-in-term.repl:9:21: Invalid definition in term variable position: location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9 |     (at &quot;city&quot; (read location entry))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   |                      ^^^^^^^^</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/smart-contracts/install/migrate-pact5.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/smart-contracts/install/local-dev-node"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Local development network</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/smart-contracts/basic-concepts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Basic concepts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparing-to-migrate" class="table-of-contents__link toc-highlight">Preparing to migrate</a></li><li><a href="#after-upgrading-to-pact-5" class="table-of-contents__link toc-highlight">After upgrading to Pact 5</a></li><li><a href="#semantic-changes" class="table-of-contents__link toc-highlight">Semantic changes</a></li><li><a href="#changed-or-removed-built-in-functions" class="table-of-contents__link toc-highlight">Changed or removed built-in functions</a></li><li><a href="#new-built-in-functions" class="table-of-contents__link toc-highlight">New built-in functions</a></li><li><a href="#request-and-result-interface" class="table-of-contents__link toc-highlight">Request and result interface</a></li><li><a href="#gas-changes" class="table-of-contents__link toc-highlight">Gas changes</a></li><li><a href="#formal-verification" class="table-of-contents__link toc-highlight">Formal verification</a></li><li><a href="#parser-fixes" class="table-of-contents__link toc-highlight">Parser fixes</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>