<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-coding-projects/rotate-auth" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Rotate authorized keys | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/coding-projects/rotate-auth"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rotate authorized keys | Kadena Docs"><meta data-rh="true" name="description" content="Develop a smart contract that allows users to change their account name and rotate authorized keys."><meta data-rh="true" property="og:description" content="Develop a smart contract that allows users to change their account name and rotate authorized keys."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/coding-projects/rotate-auth"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/coding-projects/rotate-auth" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/coding-projects/rotate-auth" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/smart-contract-dev">Smart contracts</a><button aria-label="Expand sidebar category &#x27;Smart contracts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides">How-to guides</a><button aria-label="Expand sidebar category &#x27;How-to guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/coding-projects/coding-projects">Coding projects</a><button aria-label="Collapse sidebar category &#x27;Coding projects&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/hello-world">Hello world, revisited</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/transfers">Simple payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/coding-projects/rotate-auth">Rotate authorized keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/contract-interactions">Contract interactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/gas-station">Gas station accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/loans">Loans in multiple tables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/local-testing">Local testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/estimate-gas">Estimate gas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/pact-server-api">Pact built-in server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/conditions-control">Conditions and control flow</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/resources">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/coding-projects/coding-projects"><span itemprop="name">Coding projects</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Rotate authorized keys</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Rotate authorized keys</h1></header>
<p>The <em>Rotate authorized keys</em> coding project demonstrates how to create a smart contract with rotatable authorization keys and how to enforce row level permissions.
This project continues to build on concepts and challenges presented in other coding projects and covered in <a href="/docs/smart-contract-dev">Smart contracts</a> topics.
Specifically, this project demonstrates the following:</p>
<ul>
<li>How you can use keysets as row level <strong>guards</strong> for assets.</li>
<li>How to allow users to update information in tables based on their keyset.</li>
<li>How to change ownership by rotating keyset values to authorize a new owner.</li>
</ul>
<p>To implement these features, you&#x27;ll create an <code>auth</code> module with four functions, one table, and two keysets:</p>
<p><img decoding="async" loading="lazy" alt="Rotate authorized keys overview" src="/docs/assets/images/auth-overview-ae1b923c5290fd26714c9e454ee4e7d4.png" width="1070" height="640" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before you begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before you begin" title="Direct link to Before you begin">​</a></h2>
<p>Before starting this project, verify your environment meets the following basic requirements:</p>
<ul>
<li>You have a GitHub account and can run <code>git</code> commands.</li>
<li>You have installed the <a href="/docs/smart-contracts/install">Pact</a> programming language and command-line interpreter.</li>
<li>You have installed the <a href="/docs/smart-contracts/install/tooling#kadena-command-line-interface"><code>kadena-cli</code></a> package and have a working directory with initial configuration settings.</li>
<li>You have a <a href="/docs/smart-contracts/install/local-dev-node">local development</a> node that you can connect to that runs the <code>chainweb-node</code> program, either in a Docker container or on a physical or virtual computer.</li>
<li>You must have at least one <a href="/docs/guides/accounts/howto-fund-accounts">account</a> that&#x27;s funded with KDA on at least one chain for deployment on the local development network or the Kadena test network.</li>
<li>You should be familiar with the basics for defining <a href="/docs/smart-contracts/modules">modules</a> and using keysets.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-starter-code">Get the starter code<a href="#get-the-starter-code" class="hash-link" aria-label="Direct link to Get the starter code" title="Direct link to Get the starter code">​</a></h2>
<p>To get started:</p>
<ol>
<li>
<p>Open a terminal shell on your computer.</p>
</li>
<li>
<p>Clone the <code>pact-coding-projects</code> repository by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/kadena-docs/pact-coding-projects.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Change to the <code>02-rotate-auth</code> directory by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd pact-coding-projects/02-rotate-auth</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you list the contents of this directory, you&#x27;ll see the following files:</p>
<ul>
<li><code>starter-auth.pact</code> provides a starting point with the framework for the project code and comments for every challenge.</li>
<li><code>auth.pact</code> contains the final solution code that can be deployed.</li>
<li><code>auth.repl</code> provides a complete test file for testing the final <code>auth.pact</code> contract.</li>
</ul>
</li>
<li>
<p>Open and review the <code>starter-auth.pact</code> file.</p>
<p>This file describes all of the tasks that you need to complete for the <em>Rotate authorized keys</em> coding project.
You can follow the instructions embedded in the file to try to tackle this coding project on your own without looking at the solutions to each step, or follow the instructions in the next sections if you need additional guidance.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-a-namespace-keyset-and-module">Define a namespace, keyset, and module<a href="#define-a-namespace-keyset-and-module" class="hash-link" aria-label="Direct link to Define a namespace, keyset, and module" title="Direct link to Define a namespace, keyset, and module">​</a></h2>
<p>As you might have seen in other coding projects, modules are defined in a <strong>namespace</strong> and are governed by either an administrative keyset or a governance capability.</p>
<p>To simplify the initial code required, this coding project assumes you are defining a custom <code>dev</code> namespace for local development.
As an alternative, you could use the <code>free</code> namespace.
The <code>free</code> namespace is a publicly-available namespace that you can use to deploy smart contracts on the Kadena test network.
However, the best practice is to create a unique <strong>principal namespace</strong> where you can deploy all of your modules.
Creating a principal namespace is covered later.</p>
<p>Like namespaces, keysets are defined outside of module code and passed into the module from message data that you provide separate from module code.</p>
<p>This coding project requires two keysets:</p>
<ul>
<li>The <strong>module-admin</strong> keyset allows authorized users to define and update modules.</li>
<li>The <strong>operate-admin</strong> keyset allows authorized users to create user accounts.</li>
</ul>
<p>To define the namespace, keysets, and module for this coding project:</p>
<ol>
<li>
<p>Open the <code>starter-auth.pact</code> file in your code editor and save it as <code>auth.pact</code>.</p>
</li>
<li>
<p>Enter the <code>free</code> namespace as the workspace for the keysets and module.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Define and read the <code>module-admin</code> administrative keyset in the <code>free</code> namespace as the owner of the <code>auth</code> module.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (read-keyset &quot;module-admin-keyset&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Define and read the <code>operate-admin</code> operator keyset to control who can create new user accounts.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (read-keyset &quot;module-operate-keyset&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a module named <code>auth</code> that is governed by an <code>AUTH</code> capability that enforces the administrative keyset.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ;; Module declaration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Save your changes.</p>
</li>
</ol>
<p>For more information about defining and reading keysets, see <a href="/docs/pact-5/keysets/define-keyset">define-keyset</a>.
For more information about defining governance capabilities, see <a href="/docs/smart-contracts/modules#module-governance">Module governance</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-schema-and-table">Define the schema and table<a href="#define-the-schema-and-table" class="hash-link" aria-label="Direct link to Define the schema and table" title="Direct link to Define the schema and table">​</a></h2>
<p>The <code>auth</code> modules stores information about user accounts in the <code>users-table</code> database table.
The schema for this table is named <strong>user</strong> with two columns:</p>
<table><thead><tr><th>Field name</th><th>Field type</th></tr></thead><tbody><tr><td>nickname</td><td>string</td></tr><tr><td>keyset</td><td>guard</td></tr></tbody></table>
<p>To define the schema and table:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Define a <code>user</code> schema for a table with the columns <code>nickname</code> with the type of <code>string</code> and <code>keyset</code> with the type of <code>guard</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyset:guard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Define the <code>users-table</code> to use the <code>{user}</code> schema you created in the previous step.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(deftable users-table:{user})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Move the closing parenthesis that marks the end of the <code>auth</code> module declaration after the table definition to include the schema and table inside of the module.</p>
<p>Without comments, your code should look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace &quot;dev&quot; (read-keyset &quot;module-admin-keyset&quot;) (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-operate-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable users-table:{user})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For more information about creating schemas and tables, see the descriptions for the <a href="/docs/reference/syntax#defschema">defschema</a> and <a href="/docs/reference/syntax#deftable">deftable</a> keywords.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-functions">Define functions<a href="#define-functions" class="hash-link" aria-label="Direct link to Define functions" title="Direct link to Define functions">​</a></h2>
<p>For this coding project, the <code>auth</code> module provides the following functions:</p>
<ul>
<li><code>create-user</code> to allow users with the <code>operate-admin</code> keyset to add rows to the user table.</li>
<li><code>enforce-user-auth</code> to restrict access permissions to users with a given id.</li>
<li><code>change-nickname</code> to allow users with a specific keyset to update their nickname.</li>
<li><code>rotate-keyset</code> to allow the owner of a keyset to change the keyset being used.</li>
</ul>
<p>These functions give users the ability to create and manage their own accounts.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-create-user-function">Define the create-user function<a href="#define-the-create-user-function" class="hash-link" aria-label="Direct link to Define the create-user function" title="Direct link to Define the create-user function">​</a></h3>
<p>The <code>create-user</code> function specifies that only users with the <code>operate-admin</code> keyset can add rows to the user table.</p>
<p>To define the <code>create-user</code> function:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Start the <code>create-user</code> function definition with the keyword <code>defun</code> and add the parameters <code>id</code>, <code>nickname</code>, and <code>keyset</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun create-user:string (id:string nickname:string keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Within the function, use <code>enforce-keyset</code> to restrict access to this function, so that new users can only be created by the <code>operate-admin</code> keyset.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-guard &quot;dev.operate-admin&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Within the function, insert a row into the <code>users-table</code> with the specified <code>nickname</code> and <code>keyset</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (insert users-table id {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;keyset&quot;: keyset,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;nickname&quot;: nickname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Without comments, your code should look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace &quot;dev&quot; (read-keyset &quot;module-admin-keyset&quot;) (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-operate-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable users-table:{user})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-user:string (id:string nickname:string keyset:keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-keyset &quot;dev.operate-admin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (insert users-table id {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;keyset&quot;: keyset,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nickname&quot;: nickname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For more information, see the descriptions for the <a href="/docs/pact-5/general/enforce-guard">enforce-guard</a> and <a href="/docs/pact-5/database/insert">insert</a> functions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-enforce-user-auth-function">Define the enforce-user-auth function<a href="#define-the-enforce-user-auth-function" class="hash-link" aria-label="Direct link to Define the enforce-user-auth function" title="Direct link to Define the enforce-user-auth function">​</a></h3>
<p>It’s sometimes useful to restrict access to specific data for specific users.
For example, you might want to prevent users from seeing account balances or other sensitive information that should be private.
In Pact, you can restrict access to specific rows in a table by using <strong>row-level keysets</strong>.</p>
<p>To define a row-level keyset, you must first be able to view the keyset associated with a specific key-row.
The following example demonstrates reading a keyset for a specified <code>id</code> key-row:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun enforce-keyset-of-id (id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (with-read table id { &quot;keyset&quot; := keyset }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-guard keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The purpose of this function is only to identify the keyset associated with the specified <code>id</code> key-row.
This function doesn’t provide access to any of the data in the row.
However, other functions can call this function if they want to act on the information, for example, to place row-level restrictions on the data.</p>
<p>To define the <code>enforce-user-auth</code> function:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Start the <code>enforce-user-auth</code> function definition that takes the parameter <code>id</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun enforce-user-auth (id:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Within the function, use <code>with-read</code> to read the <code>users-table</code> to find the specified <code>id</code>, and bind the <code>keyset</code> column for the <code>id</code> to the <code>k</code> variable, then return the <code>keyset</code> value with the <code>k</code> variable.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(with-read users-table id { &quot;keyset&quot;:= k }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (enforce-guard k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   k)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Without comments, your code should look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace &quot;dev&quot; (read-keyset &quot;module-admin-keyset&quot;) (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-operate-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable users-table:{user})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-user:string (id:string nickname:string keyset:keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-keyset &quot;dev.operate-admin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (insert users-table id {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;keyset&quot;: keyset,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nickname&quot;: nickname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun enforce-user-auth:guard (id:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       (with-read users-table id { &quot;keyset&quot;:= k }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       (enforce-guard k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For more information, see the descriptions for the <a href="/docs/pact-5/general/enforce-guard">enforce-guard</a> and <a href="/docs/pact-5/database/with-read">with-read</a> functions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-change-nickname-function">Define the change-nickname function<a href="#define-the-change-nickname-function" class="hash-link" aria-label="Direct link to Define the change-nickname function" title="Direct link to Define the change-nickname function">​</a></h3>
<p>After you define a function to restrict access to data, you can allow users to take specific actions based on the data they have access to.
For example, users might want to update their profile name, or make changes to sensitive information that other users should not be able to access.</p>
<p>To do that, you can write a function that calls the <code>enforce-user-auth</code> function to only allow users to update their own data.
For example, the following <code>update-data</code> function allows users to update existing information in the <code>example-table</code> by leveraging the <code>enforce-keyset-of-id</code> function:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun update-data (id new-data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-keyset-of-id id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (update example-table id { &quot;data&quot;: new-data })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (format &quot;Data updated in row {} to {}&quot; [id new-data]))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By calling the <code>enforce-keyset-of-id</code> function, this function allows users with a specific keyset to make updates to restricted information.</p>
<p>To define the <code>change-nickname</code> function:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Start the <code>change-nickname</code> function definition that takes the parameters <code>id</code> and <code>new-name</code>.</p>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre>
</li>
</ol>
<p>(defun change-nickname<!-- -->:string<!-- --> (id<!-- -->:string<!-- --> new-name<!-- -->:string<!-- -->)
)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Within the function, use the `enforce-user-auth` function to enforce authorization for the specified `id`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ```pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (enforce-user-auth id)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Within the function, call the <code>update</code> function to update the <code>nickname</code> column for the specified <code>id</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(update users-table id { &quot;nickname&quot;: new-name })</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Within the function, return a message to the user formatted as &quot;Updated name for user [id] to [name]&quot;.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(format &quot;Updated name for user {} to {}&quot; [id new-name])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Without comments, your code should look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace &quot;dev&quot; (read-keyset &quot;module-admin-keyset&quot;) (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-operate-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable users-table:{user})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-user:string (id:string nickname:string keyset:keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-keyset &quot;dev.operate-admin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (insert users-table id {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;keyset&quot;: keyset,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nickname&quot;: nickname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun enforce-user-auth:guard (id:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (with-read users-table id { &quot;keyset&quot;:= k }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-guard k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun change-nickname:string (id:string new-name:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-user-auth id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (update users-table id { &quot;nickname&quot;: new-name })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (format &quot;Updated name for user {} to {}&quot; [id new-name])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For more information, see the descriptions for the <a href="/docs/pact-5/database/update">update</a> and <a href="/docs/pact-5/general/format">format</a> functions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-rotate-keyset-function">Define the rotate-keyset function<a href="#define-the-rotate-keyset-function" class="hash-link" aria-label="Direct link to Define the rotate-keyset function" title="Direct link to Define the rotate-keyset function">​</a></h3>
<p>Now that users can update their name, you can apply this same functionality to other information.
For this coding project, you can allow users to update their authorized keyset.
Being able to rotate the keyset is similar to being able to update your password.
For single key keysets, this feature enables a user to replace a potentially compromised key.
For keysets with multiple keys, this feature enables the set of owners or authorized signers to change when needed.</p>
<p>To define the <code>rotate-keyset</code> function:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Start the <code>rotate-keyset</code> function definition that takes the parameters <code>id</code> and <code>new-keyset</code>.</p>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre>
</li>
</ol>
<p>(defun rotate-keyset<!-- -->:string<!-- --> (id<!-- -->:string<!-- --> new-keyset<!-- -->:string<!-- -->)
)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Within the function, use the `enforce-user-auth` function to enforce authorization for the specified `id`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ```pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (enforce-user-auth id)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>Within the function, call the <code>update</code> function to update the <code>keyset</code> column to the <code>new-keyset</code> for the specified <code>id</code>.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(update users-table id { &quot;keyset&quot;: new-keyset })</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Within the function, return a message describing the update in the format &quot;Updated keyset for user [id]&quot;.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(format &quot;Updated keyset for user {}&quot; [id])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Without comments, your code should look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define-namespace &quot;dev&quot; (read-keyset &quot;module-admin-keyset&quot;) (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;dev&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.module-admin&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;dev.operate-admin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (read-keyset &quot;module-operate-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module auth AUTH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap AUTH ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;dev.module-admin&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defschema user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     nickname:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (deftable users-table:{user})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-user:string (id:string nickname:string keyset:keyset)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-keyset &quot;dev.operate-admin&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (insert users-table id {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;keyset&quot;: keyset,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;nickname&quot;: nickname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun enforce-user-auth:guard (id:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (with-read users-table id { &quot;keyset&quot;:= k }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-guard k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      k)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun change-nickname:string (id:string new-name:string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-user-auth id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (update users-table id { &quot;nickname&quot;: new-name })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (format &quot;Updated name for user {} to {}&quot; [id new-name])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (defun rotate-keyset:string (id:string new-keyset:guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-user-auth id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (update users-table id { &quot;keyset&quot;: new-keyset})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (format &quot;Updated keyset for user {}&quot; [id])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For more information about updating a table, see <a href="/docs/smart-contracts/databases#update">Update</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-table">Create table<a href="#create-table" class="hash-link" aria-label="Direct link to Create table" title="Direct link to Create table">​</a></h2>
<p>Although you defined a schema and a table inside of the <code>auth</code> module, tables are created outside of the module code.
This distinction between what you define inside of the module and outside of the module is important because the module acts as a guard to protect access to database functions and records.
This separation also allows module code to be potentially updated without replacing the table in Pact state.</p>
<p>To create the table:</p>
<ol>
<li>
<p>Open the modified <code>auth.pact</code> file in your code editor.</p>
</li>
<li>
<p>Locate the closing parenthesis for the <code>auth</code> module.</p>
</li>
<li>
<p>Create the table using the <code>create-table</code> reserved keyword.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(create-table users-table)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>The code for the <em>Rotate authorized keys</em> smart contract is now complete.
From here, the next steps involve testing module functions, adding features, and deploying the contract in your local development environment or the Kadena public test network.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-file-for-local-testing">Create a file for local testing<a href="#create-a-file-for-local-testing" class="hash-link" aria-label="Direct link to Create a file for local testing" title="Direct link to Create a file for local testing">​</a></h2>
<p>The most common way to test Pact modules is to create a <code>&lt;module-name&gt;.repl</code> file that uses REPL-only built-in functions to simulate data that must be provided by the environment, like keysets and signatures.
In this part of the project, you&#x27;ll see how to create a test file—the <code>auth.repl</code> file—to call REPL-only functions to test the functions you&#x27;ve defined in the <code>auth</code> module.</p>
<p>To create the test file:</p>
<ol>
<li>
<p>Create a new <code>auth.repl</code> file in your code editor.</p>
</li>
<li>
<p>Add a transaction that loads the <code>auth</code> module using the <code>begin-tx</code> and <code>commit-tx</code> built-in functions.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (load &quot;auth.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction that imports the <code>auth</code> module, sets environment data to simulate keyset information, and creates three test user accounts.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">;; Import the &quot;auth&quot; module and set basic environment data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use auth)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-data </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;admin-keyset&quot; : [&quot;admin&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;sarah-keyset&quot;: [&quot;sarah&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;james-keyset&quot;: [&quot;james&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; Use the create-user function to create three accounts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (create-user &quot;admin&quot; &quot;Administrator&quot; (read-keyset &quot;admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (create-user &quot;Sarah&quot; &quot;Sarah&quot; (read-keyset &quot;sarah-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (create-user &quot;James&quot; &quot;James&quot; (read-keyset &quot;james-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction to test the <code>enforce-user-auth</code> function with failure and successful scenarios.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">;; Test an expected failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Test enforce user authentication&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use dev.auth)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure &quot;Keyset not in scope&quot; &quot;Keyset failure (keys-all)&quot; (enforce-user-auth &quot;Sarah&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; Specify the keyset and expect the operation to succeed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-keys [&quot;sarah&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-user-auth &quot;Sarah&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction to test the <code>change-nickname</code> function with failure and successful scenarios.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Test change nickname&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use dev.auth)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-keys [&quot;&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure &quot;Keyset not in scope&quot; &quot;Keyset failure (keys-all)&quot; (change-nickname &quot;Sarah&quot; &quot;Sarah&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ;; Specify the keyset and expect the operation to succeed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-keys [&quot;sarah&quot;, &quot;james&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (change-nickname &quot;Sarah&quot; &quot;Sarah&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (change-nickname &quot;James&quot; &quot;James&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-keys [&quot;&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a transaction to test the <code>rotate-keyset</code> function with failure and successful scenarios.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Test rotate keyset&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use dev.auth)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-data </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;sarah-keyset&quot;: [&quot;sarah&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;james-keyset&quot;: [&quot;james&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure &quot;Keyset not in scope&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Keyset failure (keys-all)&quot; (rotate-keyset &quot;Sarah&quot; (read-keyset &quot;sarah-keyset&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (expect-failure &quot;Keyset not in scope&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Keyset failure (keys-all)&quot; (rotate-keyset &quot;James&quot; (read-keyset &quot;james-keyset&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ;; Specify the keyset and expect the operation to succeed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (env-keys [&quot;sarah&quot;, &quot;james&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (rotate-keyset &quot;Sarah&quot; (read-keyset &quot;james-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (rotate-keyset &quot;James&quot; (read-keyset &quot;sarah-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open a terminal shell on your computer and test execution by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact auth.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:1:0-1:51:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:2:0-5:47:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:11:0-11:10:Trace: &quot;Begin Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:12:2-12:20:Trace: &quot;Loading    auth.pact...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:5:0-5:96:Trace: &quot;Namespace defined: dev&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:6:0-6:17:Trace: &quot;Namespace set to dev&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:9:0-10:39:Trace: &quot;Keyset write success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:13:0-14:41:Trace: &quot;Keyset write success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:18:0-85:1:Trace: Loaded module dev.auth, hash Wbu3gTpE0umJ5F_yNTzBq-puX0Ts78aUrYMA4-548y4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.pact:90:0-90:26:Trace: &quot;TableCreated&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:13:0-13:11:Trace: &quot;Commit Tx 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:16:0-16:10:Trace: &quot;Begin Tx 1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:17:2-17:19:Trace: &quot;Namespace set to dev&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:18:2-18:12:Trace: Loaded imports from auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:19:2-25:3:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:28:2-28:68:Trace: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:29:2-29:60:Trace: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:30:2-30:61:Trace: &quot;Write succeeded&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:32:0-32:11:Trace: &quot;Commit Tx 1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:35:0-35:45:Trace: &quot;Begin Tx 2 Test enforce user authentication&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:36:2-36:16:Trace: Loaded imports from dev.auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:38:2-38:96:Trace: &quot;Expect failure: Success: Keyset not in scope&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:41:2-41:22:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:42:2-42:29:Trace: KeySet {keys: [sarah],pred: keys-all}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:44:0-44:11:Trace: &quot;Commit Tx 2 Test enforce user authentication&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:47:0-47:33:Trace: &quot;Begin Tx 3 Test change nickname&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:48:2-48:16:Trace: Loaded imports from dev.auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:49:2-49:17:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:50:2-50:102:Trace: &quot;Expect failure: Success: Keyset not in scope&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:53:2-53:31:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:54:2-54:34:Trace: &quot;Updated name for user Sarah to Sara&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:55:2-55:33:Trace: &quot;Updated name for user James to Jim&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:56:2-56:17:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:58:0-58:11:Trace: &quot;Commit Tx 3 Test change nickname&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:61:0-61:31:Trace: &quot;Begin Tx 4 Test rotate keyset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:62:2-62:16:Trace: Loaded imports from dev.auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:63:2-68:3:Trace: &quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:70:2-71:85:Trace: &quot;Expect failure: Success: Keyset not in scope&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:72:2-73:85:Trace: &quot;Expect failure: Success: Keyset not in scope&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:76:2-76:31:Trace: &quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:77:2-77:53:Trace: &quot;Updated keyset for user Sarah&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:78:2-78:53:Trace: &quot;Updated keyset for user James&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth.repl:80:0-80:11:Trace: &quot;Commit Tx 4 Test rotate keyset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can also test functions interactively by loading the file into the Pact REPL.
Type <code>pact</code> in a terminal shell to open the Pact REPL environment.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (env-keys [&quot;admin&quot;, &quot;moduleadmin&quot;, &quot;operateadmin&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Setting transaction keys&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (env-data{&quot;module-admin-keyset&quot;: [&quot;moduleadmin&quot;],&quot;module-operate-keyset&quot;: [&quot;operateadmin&quot;]})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (load &quot;auth.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Loading auth.pact...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Namespace defined: dev&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Namespace set to dev&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Keyset write success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Keyset write success&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loaded module dev.auth, hash Wbu3gTpE0umJ5F_yNTzBq-puX0Ts78aUrYMA4-548y4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;TableCreated&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can then set environment data and call functions interactively.
For example, to create the <code>sarah</code> user:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (env-data{&quot;sarah-keyset&quot;:[&quot;sarah-keyset&quot;]})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Setting transaction data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pact&gt; (dev.auth.create-user &quot;sarah&quot; &quot;Sarah Rae Fitzpatrick&quot; (read-keyset &quot;sarah-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Write succeeded&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-contract">Deploy the contract<a href="#deploy-the-contract" class="hash-link" aria-label="Direct link to Deploy the contract" title="Direct link to Deploy the contract">​</a></h2>
<p>After testing the contract using the Pact interpreter and the REPL file, you can deploy the contract on your local development network or the Kadena test network.</p>
<p>However, you must deploy to an existing namespace—such as the <code>free</code> namespace—or a registered <a href="/docs/guides/transactions/howto-namespace-tx">principal namespace</a> to deploy on any Kadena network.
If you want to deploy in an existing namespace, you must also ensure that your module name and keyset name are unique across all of the modules that exist in that namespace.</p>
<p>In general, the best practice is to create a principal namespace for deploying your modules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-network-chain-and-account-information">Verify network, chain, and account information<a href="#verify-network-chain-and-account-information" class="hash-link" aria-label="Direct link to Verify network, chain, and account information" title="Direct link to Verify network, chain, and account information">​</a></h3>
<p>Before you deploy on the local development network, verify the following:</p>
<ul>
<li>
<p>The development network is currently running on your local computer.</p>
</li>
<li>
<p>You have at least one <strong>account</strong> with <strong>funds</strong> on at least one <strong>chain</strong> in the development network.</p>
<p>If you don&#x27;t have keys and at least one account on any chain on the network, you need to generate keys, create an account, and fund the account on at least one chain before continuing.</p>
</li>
<li>
<p>You have the public key for the account on the chain where you have funds.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-principal-namespace">Create a principal namespace<a href="#create-a-principal-namespace" class="hash-link" aria-label="Direct link to Create a principal namespace" title="Direct link to Create a principal namespace">​</a></h3>
<p>For this coding project, you can define a principal namespace by executing a transaction using the following <code>simple-define-namespace.ktpl</code> transaction template.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (define</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">namespace (ns.create</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">principal</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">namespace (read</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keyset &quot;k&quot;)) (read</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keyset &quot;k&quot;) (read</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keyset &quot;k&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">&quot;k&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;{{public-key}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">chainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{chain-id}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sender</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{{sender-account}}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasPrice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.000001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ttl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">signers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">public</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{public-key}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">caps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;coin.GAS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networkId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{network-id}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can use <code>kadena tx add</code> to replace the variables in the template with the values for your public key, sender account, chain, and network.
For example:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? Which template do you want to use: simple-define-namespace.ktpl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? File path of data to use for template .json or .yaml (optional):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value public-key: a6731ce7...93119689</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value chain-id: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value sender-account: k:a6731ce7...93119689</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value network-id: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Where do you want to save the output: myNamespace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After you save the transaction to a file, you can use <code>kadena tx sign</code> to sign the transaction with your wallet password or public and secret keys.</p>
<p>After signing the transaction, you can use <code>kadena tx send</code> to send the transaction to the blockchain network.</p>
<p>After the transaction is complete, copy the principal namespace from the transaction results and use it to replace all occurrences of the original <code>&quot;dev&quot;</code> namespace.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;n_1cc1f83c56f53b8865cc23a61e36d4b17e73ce9e&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define-keyset &quot;n_1cc1f83c56f53b8865cc23a61e36d4b17e73ce9e.admin-keyset&quot; (read-keyset &quot;admin-keyset&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module payments &quot;n_1cc1f83c56f53b8865cc23a61e36d4b17e73ce9e.admin-keyset&quot; ...)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-deployment-transaction">Create a deployment transaction<a href="#create-a-deployment-transaction" class="hash-link" aria-label="Direct link to Create a deployment transaction" title="Direct link to Create a deployment transaction">​</a></h3>
<p>You can deploy the <code>auth.pact</code> module on the local development network using the same workflow of <code>kadena tx add</code>, <code>sign</code>, and <code>send</code> commands that you used to execute the <code>define-namespace</code> transaction.</p>
<p>To deploy the module:</p>
<ol>
<li>
<p>Create a new transaction template named <code>coding-project.ktpl</code> in the <code>~/.kadena/transaction-templates</code> folder.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/.kadena/transaction-templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch coding-project.ktpl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>coding-project.ktpl</code> file in a code editor and create a reusable transaction request in YAML format similar to the following to specify the path to the <code>auth.pact</code> file that contains your Pact module code.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">codeFile: &quot;../../auth.pact&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  module-admin-keyset:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys: [&quot;{{admin-public-key}}&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pred: &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  module-operate-keyset:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys: [&quot;{{operate-public-key}}&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pred: &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainId: &quot;{{chain-id}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sender: &quot;{{{sender-account}}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasLimit: 80300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasPrice: 0.000001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ttl: 600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - public: &quot;{{public-key}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    caps: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networkId: &quot;{{network-id}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
<p>For example:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? Which template do you want to use: coding-project.ktpl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? File path of data to use for template .json or .yaml (optional):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value admin-public-key: a6731ce7...93119689</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value operate-public-key: 1d5a5e10...0b242ed4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value chain-id: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value sender-account: k:a6731ce7...93119689</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value public-key: a6731ce7...93119689</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value network-id: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Where do you want to save the output: auth-deploy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the unsigned transaction is saved in a <code>auth-deploy.json</code> file.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed to sign with a wallet account or a public and secret key pair.</p>
<p>For example:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? Select an action: Sign with wallet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a transaction file: Transaction: auth-deploy.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? 1 wallets found containing the keys for signing this transaction, please select a wallet to sign this transaction with first: Wallet: pistolas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the wallet password: ********</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Send the transaction by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>After the transaction is complete, you should see the message <code>TableCreated</code> in the transaction results.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-additional-transactions">Create additional transactions<a href="#create-additional-transactions" class="hash-link" aria-label="Direct link to Create additional transactions" title="Direct link to Create additional transactions">​</a></h3>
<p>After you deploy the module, you can create additional transactions to verify contract functions running on the development network.
For example, you can create a transaction template for the <code>auth.create-user</code> function similar to the following:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (n_1cc1f83c56f53b8865cc23a61e36d4b17e73ce9e.auth.create</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user &quot;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">nickname</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot; (read</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">keyset &quot;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">guard</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">guard</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{user-publicKey}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pred</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{user-predicate}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">chainId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{chain-id}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sender</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{sender-account}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gasPrice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.00000001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ttl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">signers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">public</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{signer-public-key}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">caps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networkId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{{networkId}}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> exec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this template, you can create a transaction that adds the specified user <code>id</code>, <code>nickname</code>, and <code>guard</code> to the <code>users-table</code>.
For example, this template prompts you to provide the user details when you run <code>kadena tx add</code>:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Which template do you want to use: create-user.ktpl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? File path of data to use for template .json or .yaml (optional):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value user-id: sarah</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value user-nickname: Sarah Rae Foster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value user-guard: sarah-keyset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value user-publicKey: 1d5a5e10...0b242ed4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value user-predicate: keys-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value chain-id: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value sender-account: k:1d5a5e10...0b242ed4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value signer-public-key: 1d5a5e10...0b242ed4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value networkId: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Where do you want to save the output: SARAH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/coding-projects/rotate-auth.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/coding-projects/transfers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Simple payments</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/coding-projects/contract-interactions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contract interactions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before you begin</a></li><li><a href="#get-the-starter-code" class="table-of-contents__link toc-highlight">Get the starter code</a></li><li><a href="#define-a-namespace-keyset-and-module" class="table-of-contents__link toc-highlight">Define a namespace, keyset, and module</a></li><li><a href="#define-the-schema-and-table" class="table-of-contents__link toc-highlight">Define the schema and table</a></li><li><a href="#define-functions" class="table-of-contents__link toc-highlight">Define functions</a></li><li><a href="#create-table" class="table-of-contents__link toc-highlight">Create table</a></li><li><a href="#create-a-file-for-local-testing" class="table-of-contents__link toc-highlight">Create a file for local testing</a></li><li><a href="#deploy-the-contract" class="table-of-contents__link toc-highlight">Deploy the contract</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>