<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-coding-projects/gas-station" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Gas station accounts | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/coding-projects/gas-station"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Gas station accounts | Kadena Docs"><meta data-rh="true" name="description" content="Create and configure a gas station account to pay for transactions submitted by application users."><meta data-rh="true" property="og:description" content="Create and configure a gas station account to pay for transactions submitted by application users."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/coding-projects/gas-station"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/coding-projects/gas-station" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/coding-projects/gas-station" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/smart-contract-dev">Smart contracts</a><button aria-label="Expand sidebar category &#x27;Smart contracts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides">How-to guides</a><button aria-label="Expand sidebar category &#x27;How-to guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/coding-projects/coding-projects">Coding projects</a><button aria-label="Collapse sidebar category &#x27;Coding projects&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/hello-world">Hello world, revisited</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/transfers">Simple payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/rotate-auth">Rotate authorized keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/contract-interactions">Contract interactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/coding-projects/gas-station">Gas station accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/loans">Loans in multiple tables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/local-testing">Local testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/estimate-gas">Estimate gas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/pact-server-api">Pact built-in server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coding-projects/conditions-control">Conditions and control flow</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/resources">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/coding-projects/coding-projects"><span itemprop="name">Coding projects</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Gas station accounts</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Gas station accounts</h1></header>
<p>In the <em>Gas station account</em> coding project, you&#x27;ll learn how to create a smart contract that allows application users to complete a transaction on the blockchain without having an account or any tokens to pay the transaction fee.
With this smart contract, an autonomous account is used to pay transaction fees on behalf of users.
The autonomous account—often referred to as a <strong>gas station</strong>—simplifies the user experience and eliminates the friction associated with onboarding users who are new to blockchain technology, digital wallets, transaction signing, and managing public and secret keys.
Gas station accounts make it easier for new users to interact with applications, but require some extra work by the application developer.
For example, you&#x27;ll most likely want to set limits on how and when the funds in the gas station account can be used to prevent the account balance from being drained too quickly or funding transactions that require a lot of computational overhead.</p>
<p>In this coding project, you&#x27;ll see a simple example of how to create a <code>coin</code> contract account that pays transaction fees—that is, the gas fees—on behalf of users.
This coding project explores how to:</p>
<ul>
<li>Create a gas station principal account with a capability guard.</li>
<li>Implement the interface required to allow the account to pay transaction fees for any type of transaction.</li>
<li>Scope the gas station account to only pay transaction fees for transactions that meet specific criteria.</li>
</ul>
<p>By completing this project, you&#x27;ll have a basic understanding of the functions used to create a secure gas station account and how to set limits to protect the account from misuse.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="principal-accounts-and-guards">Principal accounts and guards<a href="#principal-accounts-and-guards" class="hash-link" aria-label="Direct link to Principal accounts and guards" title="Direct link to Principal accounts and guards">​</a></h2>
<p>A gas station account is similar to any other <code>coin</code> contract account.
It must have an account name, guard, and balance, so that it can be uniquely identified, sign transactions securely, and hold funds for paying fees.
However, it&#x27;s important for you to restrict access to the gas station account to ensure it&#x27;s only used as intended.
The primary way to secure access to the gas station account is by creating it as a <strong>principal account</strong> with a unique guard.</p>
<p>For an introduction to principal accounts, see <a href="/docs/smart-contracts/accounts">Accounts, keys, and principals</a>.
For information about the different types of guards, see <a href="/docs/smart-contracts/guards">Guards</a>.
The following example illustrates how to use the <code>create-user-guard</code> and <code>create-principal</code> functions to create a <code>coin</code> account with a <strong>user guard</strong> for the <code>allow</code> function:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;free&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module test-gas GOV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOV() true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defun allow() true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(let ((guard (create-user-guard (test-gas.allow))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create-account (create-principal guard) guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>coin.create-account</code> function creates a new principal account with a user guard in the <code>coin-table</code> with a default balance of 0.0.
You can use similar code to create a new account that makes use of a <strong>capability guard</strong>.
For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;free&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module test-gas GOV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap GOV() true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (defcap ALLOW-ALL() true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(let ((guard (create-capability-guard (test-gas.ALLOW-ALL))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (coin.create-account (create-principal guard) guard)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A capability guard is an essential part of the code that makes creating a gas station principal account possible.
In the next step, you&#x27;ll implement the <code>gas-payer-v1</code> interface to add a <code>GAS_PAYER</code> capability and guard to your module.</p>
<h1>Before you begin</h1>
<p>Before starting this project, verify your environment meets the following basic requirements:</p>
<ul>
<li>You have a GitHub account and can run <code>git</code> commands.</li>
<li>You have installed the <a href="/docs/smart-contracts/install">Pact</a> programming language and command-line interpreter.</li>
<li>You have installed the <a href="/docs/smart-contracts/install/tooling#kadena-command-line-interface"><code>kadena-cli</code></a> package and have a working directory with initial configuration settings.</li>
<li>You have a <a href="/docs/smart-contracts/install/local-dev-node">local development</a> node that you can connect to that runs the <code>chainweb-node</code> program, either in a Docker container or on a physical or virtual computer.</li>
<li>You must have at least one <a href="/docs/guides/accounts/howto-fund-accounts">account</a> that&#x27;s funded with KDA on at least one chain for deployment on the local development network or the Kadena test network.</li>
<li>You should be familiar with the basics for defining <a href="/docs/smart-contracts/modules">modules</a> and using keysets.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-starter-code">Get the starter code<a href="#get-the-starter-code" class="hash-link" aria-label="Direct link to Get the starter code" title="Direct link to Get the starter code">​</a></h2>
<p>To get started:</p>
<ol>
<li>
<p>Open a terminal shell on your computer.</p>
</li>
<li>
<p>Clone the <code>pact-coding-projects</code> repository by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/kadena-docs/pact-coding-projects.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Change to the <code>04-gas-station</code> directory by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd pact-coding-projects/04-gas-station</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you list the contents of this directory, you&#x27;ll see the following files:</p>
<ul>
<li><code>starter-gas-account.pact</code> provides a framework for the project code in comments.</li>
<li><code>gas-account.pact</code> contains the final module code for the sample gas account.</li>
<li><code>gas-account.repl</code> provides the complete test file for testing the final <code>gas-account.pact</code> file.</li>
</ul>
</li>
<li>
<p>Open and review the <code>starter-gas-account.pact</code> file.</p>
<p>This file describes all of the tasks that you need to complete for the <em>Gas station accounts</em> coding project.
You can follow the instructions embedded in the file to try to tackle this coding project on your own
without looking at the solutions to each step, or follow the instructions in the next sections if you need additional guidance.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implement-the-gas-payer-interface">Implement the gas payer interface<a href="#implement-the-gas-payer-interface" class="hash-link" aria-label="Direct link to Implement the gas payer interface" title="Direct link to Implement the gas payer interface">​</a></h2>
<p>Because paying gas fees is a common operation, the <code>gas-payer-v1</code> interface is defined in a module that&#x27;s deployed by default on the Kadena development, test, and main networks.
For this coding project, you&#x27;ll implement this interface in a new Pact module—the <code>test-gas</code> module—in a <code>gas-account.pact</code> file.</p>
<p>To create the gas station module:</p>
<ol>
<li>
<p>Open the code editor on your computer.</p>
</li>
<li>
<p>Create a new <code>gas-account.pact</code> file.</p>
</li>
<li>
<p>Add the minimal Pact code required to define a module.</p>
<p>Remember that a module requires the following information:</p>
<ul>
<li>namespace</li>
<li>governing keyset or capability</li>
<li>at least one function</li>
</ul>
<p>The function in this case is an implementation of the <code>gas-payer-v1</code> interface as defined in the <code>gas-payer-v1.pact</code> file.
For example:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(namespace &quot;free&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (define-keyset &quot;free.dev-account&quot; (read-keyset &quot;dev-account&quot; ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(module test-gas GOVERNANCE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GOVERNANCE () </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (enforce-guard &quot;free.pistolas-dev-account&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (implements gas-payer-v1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To deploy the gas station module, you must use an existing namespace such as your principal namespace or the <code>&quot;free&quot;</code> namespace.
For local testing, you can create the <code>test-gas</code> module in a custom namespace that you define for the local development network.</p>
<p>After you issue the <code>implements gas-payer-v1</code> statement, you must implement the capabilities, types, and functions that are defined in the <code>gas-payer-v1.pact</code> file in the <code>test-gas</code> module.
The interface definition looks like this:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(interface gas-payer-v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GAS_PAYER:bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ( user:string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      limit:integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      price:decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot; Provide a capability indicating that declaring module supports \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ gas payment for USER for gas LIMIT and PRICE. Functionality \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ should require capability (coin.FUND_TX), and should validate \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ the spend of (limit * price), possibly updating some database \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ entry. \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ Should compose capability required for &#x27;create-gas-payer-guard&#x27;.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-gas-payer-guard:guard ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot; Provide a guard suitable for controlling a coin account that can \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ pay gas via GAS_PAYER mechanics. Generally this is accomplished \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ by having GAS_PAYER compose a capability without parameters,  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ that is required in this guard. Thus, if coin contract is able to \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ successfully acquire GAS_PAYER, the composed &#x27;anonymous&#x27; cap required \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \ here will be in scope, and gas buy will succeed.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Implement the <code>GAS_PAYER</code> capability as defined in the <code>gas-payer-v1.pact</code> file and compose an inner capability called <code>ALLOW_GAS</code> to use as a guard for the account used to pay transaction fees:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap GAS_PAYER:bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ( user  : string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       limit : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       price : decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     (compose-capability (ALLOW_GAS))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defcap ALLOW_GAS () true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (defun create-gas-payer-guard:guard ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (create-capability-guard (ALLOW_GAS))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this code, an account granted the <code>GAS_PAYER</code> capability can pay gas fees for any transaction.
In addition, the <code>create-gas-payer-guard</code> function uses the built-in <code>create-capability-guard</code> function to return a guard for the <code>ALLOW_GAS</code> capability.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-gas-payer-implementation">Test the gas payer implementation<a href="#test-the-gas-payer-implementation" class="hash-link" aria-label="Direct link to Test the gas payer implementation" title="Direct link to Test the gas payer implementation">​</a></h2>
<p>At this point, you have a basic implementation of the <code>gas-payer-v1</code> interface that can be used to pay transaction fees but without any other scoping or restrictions.
Before deploying the new module or updating it to be more restrictive, you should prepare a script for testing operations locally.
To test the module locally, you&#x27;ll need to add the contracts that the gas station module depends on to your local environment.</p>
<p>To prepare a test file:</p>
<ol>
<li>
<p>Open the code editor on your computer.</p>
</li>
<li>
<p>Copy the following required files to your working directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">coin-v5.pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fungible-v2.pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fungible-xchain-v1.pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-payer-v1.pact</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Copying these files to your local environment is required because the contracts aren&#x27;t deployed in the Pact REPL by default.</p>
</li>
<li>
<p>Create a new <code>gas-account.repl</code> file to provide all of the environment data required for the module, including the namespace, keys, signatures, and contracts.</p>
<p>For example, the initial environment information for the <code>gas-account</code> might look similar to the following:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   { &quot;dev-account&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       { &quot;keys&quot; : [ &quot;58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       , &quot;pred&quot; : &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (env-sigs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       [{ &quot;key&quot;  : &quot;58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        , &quot;caps&quot; : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Define principal namespace&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (define-namespace &quot;free&quot; (read-keyset &quot;dev-account&quot; ) (read-keyset &quot;dev-account&quot; ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Define admin-keyset&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (namespace &quot;free&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (define-keyset &quot;free.dev-account&quot; (read-keyset &quot;dev-account&quot; ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load required modules&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;fungible-v2.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;fungible-xchain-v1.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;coin-v5.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (create-table coin-table)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (create-table allocation-table)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;gas-payer-v1.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a call to load the <code>gas-account.pact</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load gas station module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;gas-account.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the <code>gas-account.repl</code> file using the <code>pact</code> command-line interpreter and the <code>--trace</code> option:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact gas-account.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the operations are successful with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:1:0:Trace: Setting transaction data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:8:2:Trace: Setting transaction signatures/caps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:14:0:Trace: Begin Tx 0: Define principal namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:15:2:Trace: Namespace defined: free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:16:0:Trace: Commit Tx 0: Define principal namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:18:0:Trace: Begin Tx 1: Define admin-keyset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:19:2:Trace: Namespace set to free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:20:2:Trace: Keyset defined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:21:0:Trace: Commit Tx 1: Define admin-keyset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:23:0:Trace: Begin Tx 2: Load required modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:24:3:Trace: Loading fungible-v2.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fungible-v2.pact:1:0:Trace: Loaded interface fungible-v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:25:3:Trace: Loading fungible-xchain-v1.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fungible-xchain-v1.pact:1:0:Trace: Loaded interface fungible-xchain-v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:26:3:Trace: Loading coin-v5.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">coin-v5.pact:1:0:Trace: Loaded module coin, hash rE7DU8jlQL9x_MPYuniZJf5ICBTAEHAIFQCB4blofP4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:27:3:Trace: TableCreated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:28:3:Trace: TableCreated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:29:3:Trace: Loading gas-payer-v1.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-payer-v1.pact:1:0:Trace: Loaded interface gas-payer-v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:30:0:Trace: Commit Tx 2: Load required modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:32:0:Trace: Begin Tx 3: Load gas station module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:33:3:Trace: Loading gas-account.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:1:0:Trace: Namespace set to free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:3:0:Trace: Loaded module free.test-gas, hash rqS8Y5Rp-DxlTQHSKgeDJrRTlGFfoA5eaIKtcctwYN0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:34:0:Trace: Commit Tx 3: Load gas station module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-capability-guarded-account">Create the capability-guarded account<a href="#create-the-capability-guarded-account" class="hash-link" aria-label="Direct link to Create the capability-guarded account" title="Direct link to Create the capability-guarded account">​</a></h2>
<p>To make the gas station account more secure, you can create it using a principal account name and guard access to it by using the <code>ALLOW_GAS</code> capability.
Because the gas station account is a capability-guarded account, the <code>create-principal</code> Pact function creates the principal account name with a <code>c:</code> prefix.
You can then define the gas station account name as a constant in the <code>gas-account.pact</code> file.</p>
<p>To create a capability-guarded account:</p>
<ol>
<li>
<p>Open the <code>gas-account.pact</code> file in the code editor.</p>
</li>
<li>
<p>Add a <code>GAS_ACCOUNT</code> constant to store the gas station principal account in the module declaration:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defconst GAS_ACCOUNT (create-principal (create-gas-payer-guard)))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add an <code>init</code> function that uses the <code>coin.create-account</code> function to create the gas station account in the module declaration:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun init ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.create-account GAS_ACCOUNT (create-gas-payer-guard))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this code:</p>
<ul>
<li>The first argument of the function is the account name you defined using the <code>GAS_ACCOUNT</code> constant.</li>
<li>The second argument is the guard for the account.</li>
</ul>
</li>
<li>
<p>Add an expression <strong>after</strong> the module declaration that calls the <code>init</code> function if the module is deployed with <code>{ &quot;init&quot;: true }</code> in the environment data:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(if (read-msg &quot;init&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [(init)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&quot;Not creating the gas station account&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Save your changes to the <code>gas-account.pact</code> file.</p>
</li>
<li>
<p>Open the <code>gas-account.repl</code> file in the code editor.</p>
</li>
<li>
<p>Update the <code>gas-account.repl</code> file to set <code>init</code> to <code>true</code> by adding the following lines of code before loading the <code>gas-account.pact</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(env-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  { &quot;init&quot;: true }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Update the load transaction to display the capability-guarded gas station account name when you execute the file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Load gas station module&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (load &quot;gas-account.pact&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   [GAS_ACCOUNT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the <code>gas-account.repl</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact gas-account.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction completes with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:36:0:Trace: Begin Tx 3: Load gas station module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:37:3:Trace: Loading 01-gas-account.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:1:0:Trace: Namespace set to free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:3:0:Trace: Loaded module free.test-gas, hash q1bMc2SzjAJrbhUyZJ5t4u8Zktvi9H_xOZqsxZljTA4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:28:0:Trace: [&quot;Write succeeded&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:38:3:Trace: [&quot;c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:39:0:Trace: Commit Tx 3: Load gas station module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="verify-the-gas-station-account">Verify the gas station account<a href="#verify-the-gas-station-account" class="hash-link" aria-label="Direct link to Verify the gas station account" title="Direct link to Verify the gas station account">​</a></h2>
<p>In the previous output, the &quot;Write succeeded&quot; message indicates that you have successfully created the principal account for the gas station to use.
You can verify the account information by adding another transaction to the <code>gas-account.repl</code> file that calls the <code>coin.details</code> function with the account name for the capability-guarded gas station account.</p>
<p>To verify the gas account:</p>
<ol>
<li>
<p>Open the <code>gas-account.repl</code> file in your code editor.</p>
</li>
<li>
<p>Add a transaction similar to the following after loading the <code>gas-account.pact</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Verify account&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (coin.details free.test-gas.GAS_ACCOUNT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the <code>gas-account.repl</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact gas-account.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction completes with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:37:3:Trace: Loading 01-gas-account.pact...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:1:0:Trace: Namespace set to free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:3:0:Trace: Loaded module free.test-gas, hash q1bMc2SzjAJrbhUyZJ5t4u8Zktvi9H_xOZqsxZljTA4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.pact:28:0:Trace: [&quot;Write succeeded&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:38:3:Trace: [&quot;c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:39:0:Trace: Commit Tx 3: Load gas station module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:41:0:Trace: Begin Tx 4: Verify account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:42:3:Trace: {&quot;account&quot;: &quot;c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I&quot;,&quot;balance&quot;: 0.0,&quot;guard&quot;: CapabilityGuard {name: free.test-gas.ALLOW_GAS,args: [],pactId: }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:43:0:Trace: Commit Tx 4: Verify account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load successful</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scope-to-specific-transactions">Scope to specific transactions<a href="#scope-to-specific-transactions" class="hash-link" aria-label="Direct link to Scope to specific transactions" title="Direct link to Scope to specific transactions">​</a></h2>
<p>Now that you have a capability-guarded gas station account that can be used to pay transaction fees, you can further scope it to only pay for specific transactions or only when specific conditions are met.
For example, you might want enforce an upper limit for transaction fees to help ensure that funds in a gas station account aren&#x27;t drained too quickly.</p>
<p>The following example illustrates how to enforce specific conditions for the use the gas station account.
In this example, the gas station administrator can use the gas station account for any transaction.
Other users can only use the gas station account to pay transaction fees if the gas price is less than a specified price.</p>
<p>To enforce specific conditions for transactions using the gas station account:</p>
<ol>
<li>
<p>Open the <code>gas-account.pact</code> file in the code editor.</p>
</li>
<li>
<p>Add the <code>enforce-one</code> function to the <code>GAS_PAYER</code> capability to specify two conditions:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  (enforce-one</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Allow the administrator to use the gas station account for any transaction.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce-guard  &quot;free.dev-account&quot; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (enforce (&lt;= 0.00000001 (at &#x27;gas-price (chain-data)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Gas price must be less than 0.00000001&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the <code>enforce-guard</code> function allows the owner of the <code>free.dev-account</code> keyset to the use the gas station account to pay for any transaction.
For all other transactions and users, the gas price must be less the specified 0.00000001.</p>
<p>You can use a similar approach to limit access to gas station funds based on other conditions.
For example, you can set a limit for transaction fees using a function to get the current gas price instead of using a hard-coded value.
You can also create conditions that prevent the gas station account from being used to submit continuation requests, that exclude specific module or function calls, or that set time boundaries for paying transaction fees.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="display-account-details">Display account details<a href="#display-account-details" class="hash-link" aria-label="Direct link to Display account details" title="Direct link to Display account details">​</a></h2>
<p>Before deploying the gas station smart contract, add a function to display the account details when the contract is deployed.
You&#x27;ll need this information to transfer funds to the new account on the network and chain where you deploy the contract.</p>
<p>To add a function that displays the account information:</p>
<ol>
<li>
<p>Open the <code>gas-account.pact</code> file in the code editor.</p>
</li>
<li>
<p>Add the <code>display</code> function to call the <code>coin.details</code> function for the <code>GAS_ACCOUNT</code>:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(defun display:object ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (coin.details free.test-gas.GAS_ACCOUNT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add a call to the <code>display</code> function to the end of the smart contract:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(if (read-msg &quot;init&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [(init)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [&quot;Not creating the gas station account&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(free.test-gas.display)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>gas-account.repl</code> file in the code editor and add a test for the display function.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(begin-tx &quot;Test account display&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (free.test-gas.display)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(commit-tx)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the <code>gas-account.repl</code> file:</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pact gas-account.repl --trace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the transaction completes with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:45:0:Trace: Begin Tx 5: Test account display</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:46:3:Trace: {&quot;account&quot;: &quot;c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I&quot;,&quot;balance&quot;: 0.0,&quot;guard&quot;: CapabilityGuard {name: free.test-gas.ALLOW_GAS,args: [],pactId: }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gas-account.repl:47:0:Trace: Commit Tx 5: Test account display</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-contract">Deploy the contract<a href="#deploy-the-contract" class="hash-link" aria-label="Direct link to Deploy the contract" title="Direct link to Deploy the contract">​</a></h2>
<p>After you&#x27;ve updated and tested the module, you can deploy it on a chain on your local development network or the Kadena test network.</p>
<p>For this example, the contract is deployed in the <code>free</code> namespace using an administrative account that has funds on chain 3 in the development network.
To deploy in the <code>free</code> namespace, the module name and keyset name must be unique across all of the modules that exist in the <code>free</code> namespace.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prepare-to-deploy">Prepare to deploy<a href="#prepare-to-deploy" class="hash-link" aria-label="Direct link to Prepare to deploy" title="Direct link to Prepare to deploy">​</a></h3>
<p>To prepare to deploy the gas station module on the development network:</p>
<ul>
<li>
<p>The development network is currently running on your local computer.</p>
</li>
<li>
<p>You have at least one <strong>account</strong> with <strong>funds</strong> on at least one <strong>chain</strong> in the development network.</p>
<p>If you don&#x27;t have keys and at least one account on any chain on the network, you need to generate keys, create an account, and fund the account on at least one chain before continuing.</p>
</li>
<li>
<p>You have the public key for the account on the chain where you have funds.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-deployment-transaction">Create a deployment transaction<a href="#create-a-deployment-transaction" class="hash-link" aria-label="Direct link to Create a deployment transaction" title="Direct link to Create a deployment transaction">​</a></h3>
<p>You can deploy the <code>gas-account.pact</code> module on the local development network using a transaction template.</p>
<p>To deploy the module:</p>
<ol>
<li>
<p>Create a new transaction template named <code>deploy-contract.ktpl</code> in the <code>~/.kadena/transaction-templates</code> folder.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/.kadena/transaction-templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch deploy-contract.ktpl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>deploy-contract.ktpl</code> file in a code editor and create a reusable transaction request in YAML format similar to the following to specify the path to the <code>gas-account.pact</code> file that contains your Pact module code.</p>
<div class="language-pact codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-pact codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">codeFile: &quot;{{path-to-pact-code}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  admin-keyset:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys: [&quot;{{public-key}}&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pred: &quot;keys-all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  init: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meta:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chainId: &quot;{{chain-id}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sender: &quot;{{{sender-account}}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasLimit: 80300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gasPrice: 0.000001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ttl: 600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - public: &quot;{{public-key}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    caps: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networkId: &quot;{{network-id}}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a transaction that uses the template by running the <code>kadena tx add</code> command and following the prompts displayed.</p>
<p>For example:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? Which template do you want to use: deploy-contract.ktpl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? File path of data to use for template .json or .yaml (optional):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value path-to-pact-code: ../../gas-account.pact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value public-key: 58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value chain-id: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value sender-account: k:58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value network-id: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Where do you want to save the output: GasStationAccount</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the unsigned transaction is saved in a <code>GasStationAccount.json</code> file.</p>
</li>
<li>
<p>Sign the transaction by running the <code>kadena tx sign</code> command and following the prompts displayed to sign with a wallet account or a public and secret key pair.</p>
<p>For example:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">? Select an action: Sign with wallet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a transaction file: Transaction: GasStationAccount.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? 1 wallets found containing the keys for signing this transaction, please select a wallet to sign this transaction with first: Wallet: chainweaver-web-legacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the wallet password: ********</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Send the transaction by running the <code>kadena tx send</code> command and following the prompts displayed.</p>
<p>After the transaction is complete, you should see the account created in the transaction results.
For example:</p>
<p><img decoding="async" loading="lazy" alt="Gas station account" src="/docs/assets/images/gas-station-account-33a3f9c929991ce13caf9b44c89f5e0f.jpg" width="1726" height="124" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fund-the-gas-station-account">Fund the gas station account<a href="#fund-the-gas-station-account" class="hash-link" aria-label="Direct link to Fund the gas station account" title="Direct link to Fund the gas station account">​</a></h2>
<p>Now that you have created and deployed the gas station account, you&#x27;re ready to fund the account to pay transaction fees.
You can use the <code>kadena tx</code> commands to create, sign, and send a transfer transaction to the development network.</p>
<p>To fund the gas station account:</p>
<ol>
<li>
<p>Verify the development network is currently running on your local computer.</p>
</li>
<li>
<p>Create a new unsigned transaction using the <code>kadena tx add</code> command and the <code>transfer.ktpl</code> template and follow the prompts displayed to select the sender, receiver, and amount to transfer.</p>
<ul>
<li>For the <code>account:from</code> template value, specify the administrative account that is providing funds to the gas station account.
In this example, it&#x27;s the Chainweaver wallet account <code>k:58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c</code>.</li>
<li>For the <code>account:to</code> template value, specify the gas station principal account that you created with the capability guard.
In this example, it&#x27;s the principal account <code>c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I</code>.</li>
<li>For the <code>decimal:amount</code> template value, specify the number of coins to transfer as a decimal value.
In this example, the transfer amount is <code>2.0</code>.</li>
</ul>
<p>For example, the prompts and output for creating the transaction look similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">➜  ~ kadena tx add</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Which template do you want to use: transfer.ktpl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? File path of data to use for template .json or .yaml (optional):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select account alias for template value account:from: k-58705e        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Using account name k:58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select account alias for template value account:to: Enter account manually</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Manual entry for account for template value account:to: c:J1yaCWrdEbhKekMRhF5WjOgvzUayxTD24q7UWHwaa9I</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value decimal:amount: 2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template value chain-id: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Template key &quot;key:from&quot; matches account &quot;account:from&quot;. Use public account&#x27;s key? Account public key: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select network id for template value networkId: development</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Where do you want to save the output: fund-gas</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Sign the unsigned transaction using the <code>kadena tx sign</code> command and the transaction file name generated by the <code>kadena tx add</code> command.</p>
<p>For example, the prompts and output for the transaction look similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">➜  ~ kadena tx sign</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select an action: Sign with wallet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a transaction file: Transaction: fund-gas.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? 1 wallets found containing the keys for signing this transaction, please </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select a wallet to sign this transaction with first: Wallet: chainweaver-web-legacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the wallet password: ********</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Send the signed transaction using the <code>kadena tx send</code> command and the signed transaction file name generated by the <code>kadena tx sign</code> command.</p>
<p>For example, the prompts and output for the transaction look similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">➜  ~ kadena tx send</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select a transaction file: Transaction: transaction-6DWOi5enSt-signed.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">⠋ Sending transactions...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction detail for command with hash: 6DWOi5enStLe6WjaUOMJfv-RTm3TSrfe_0m1IAH4yac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Network ID  Chain ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">development 3       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✔ Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction: 6DWOi5enStLe6WjaUOMJfv-RTm3TSrfe_0m1IAH4yac submitted with request key: 6DWOi5enStLe6WjaUOMJfv-RTm3TSrfe_0m1IAH4yac</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the transaction is completed, you can check the results in the block explorer using the request key.</p>
<p>For example, you can open the local block explorer for the development network to view recent transactions:</p>
<p><img decoding="async" loading="lazy" alt="Explore recent transactions" src="/docs/assets/images/gas-tx-f2707646c100f2721fb338bddbf56b5f.jpg" width="2267" height="392" class="img_ev3q"></p>
<p>You can click the link matching the transaction request key to see the details about the funding transaction:</p>
<p><img decoding="async" loading="lazy" alt="Fund gas account transaction details" src="/docs/assets/images/fund-gas-2fcf8ea21487b9456000d70f323780f5.jpg" width="2288" height="1526" class="img_ev3q"></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="review">Review<a href="#review" class="hash-link" aria-label="Direct link to Review" title="Direct link to Review">​</a></h2>
<p>This project demonstrated how to create a capability-guarded principal account to hold funds.
This account can be used to pay for transactions on behalf of other users.
The project also provided a simple example for restricting the use of the gas station account based on a specific condition.
In this example project, the gas station module was deployed on the development network and chain 3 with funds from a Chainweaver wallet account.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/coding-projects/gas-station.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/coding-projects/contract-interactions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Contract interactions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/coding-projects/loans"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Loans in multiple tables</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#principal-accounts-and-guards" class="table-of-contents__link toc-highlight">Principal accounts and guards</a></li><li><a href="#get-the-starter-code" class="table-of-contents__link toc-highlight">Get the starter code</a></li><li><a href="#implement-the-gas-payer-interface" class="table-of-contents__link toc-highlight">Implement the gas payer interface</a></li><li><a href="#test-the-gas-payer-implementation" class="table-of-contents__link toc-highlight">Test the gas payer implementation</a></li><li><a href="#create-the-capability-guarded-account" class="table-of-contents__link toc-highlight">Create the capability-guarded account</a></li><li><a href="#verify-the-gas-station-account" class="table-of-contents__link toc-highlight">Verify the gas station account</a></li><li><a href="#scope-to-specific-transactions" class="table-of-contents__link toc-highlight">Scope to specific transactions</a></li><li><a href="#display-account-details" class="table-of-contents__link toc-highlight">Display account details</a></li><li><a href="#deploy-the-contract" class="table-of-contents__link toc-highlight">Deploy the contract</a></li><li><a href="#fund-the-gas-station-account" class="table-of-contents__link toc-highlight">Fund the gas station account</a></li><li><a href="#review" class="table-of-contents__link toc-highlight">Review</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>