<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/nodes/evm-foundry-dev" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Developing for Chainweb EVM with Foundry | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/guides/nodes/evm-foundry-dev"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Developing for Chainweb EVM with Foundry | Kadena Docs"><meta data-rh="true" name="description" content="Develop smart contract applications using the Foundry toolchain to run on multiple Chainweb EVM-compatible chains."><meta data-rh="true" property="og:description" content="Develop smart contract applications using the Foundry toolchain to run on multiple Chainweb EVM-compatible chains."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/guides/nodes/evm-foundry-dev"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/guides/nodes/evm-foundry-dev" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/guides/nodes/evm-foundry-dev" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Chainweb EVM Foundry integration</h1></header>
<p>The <a href="https://github.com/kadena-io/foundry-chainweb" target="_blank" rel="noopener noreferrer">foundry-chainweb</a> package provides utilities to help you use the Foundry smart contract development toolchain to develop, test, and deploy projects on the Kadena Chainweb EVM blockchain.
These utilities extend the Foundry toolchain to support the Kadena multi-chain network, where transactions can be processed by multiple, parallel, EVM-compatible chains.</p>
<p>For information about installing the Foundry smart contract development toolchain and getting started with Solidity smart contract development, see the <a href="https://getfoundry.sh/introduction/overview" target="_blank" rel="noopener noreferrer">Foundry</a> documentation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before you begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before you begin" title="Direct link to Before you begin">​</a></h2>
<p>Verify that your development environment meets the following basic requirements:</p>
<ul>
<li>You have the Foundry toolchain—with the <code>forge</code>, <code>cast</code>, <code>anvil</code>, and <code>chisel</code> binaries—installed locally or running in a Docker container.</li>
<li>You have Git installed for managing your project.</li>
<li>You have cloned the <a href="https://github.com/kadena-io/kadena-evm-sandbox" target="_blank" rel="noopener noreferrer">kadena-evm-sandbox</a> so that you have access to public and private keys for test accounts with default allocations.</li>
</ul>
<p>If you want to deploy projects on the Kadena Chainweb EVM test network, you must have an EVM-compatible wallet and the private key for an account holding testnet KDA funds.
For more information about deploying projects on the Chainweb EVM test network, see <a href="/docs/guides/nodes/howto-evm">Kadena Chainweb EVM deployment</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start">Quick start<a href="#quick-start" class="hash-link" aria-label="Direct link to Quick start" title="Direct link to Quick start">​</a></h2>
<p>If you have the Foundry toolchain installed, you can clone the <a href="https://github.com/kadena-io/foundry-chainweb" target="_blank" rel="noopener noreferrer">foundry-chainweb</a> repository, navigate to the <code>/examples/Counter</code> folder, and begin experimenting with building, testing, and running scripts without first creating and configuring your own project.</p>
<p>To explore the sample <code>Counter</code> project:</p>
<ol>
<li>
<p>Clone the <code>foundry-chainweb</code> repository:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://github.com/kadena-io/foundry-chainweb.git &amp;&amp; cd foundry-chainweb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Change to the <code>examples/Counter</code> directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd examples/Counter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Build the sample <code>Counter</code> project:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the sample project compiles successfully:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠒] Compiling 1 files with Solc 0.8.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠑] Solc 0.8.30 finished in 568.10ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compiler run successful!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Test the sample <code>Counter</code> project:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see that the tests for the sample project are successful:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No files changed, compilation skipped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ran 2 tests for test/Counter.t.sol:CounterTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[PASS] test_IncrementMultiChain() (gas: 433714)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[PASS] test_SetNumberMultiChain() (gas: 430552)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 1.72s (4.07ms CPU time)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Review the sample project configuration files and contracts for an overview of changes before configuring your own projects:</p>
<ul>
<li>foundry-chainweb/examples/Counter/chainweb.config.json</li>
<li>foundry-chainweb//examples/Counter/foundry.toml</li>
<li>foundry-chainweb/examples/Counter/script/Counter.s.sol</li>
<li>foundry-chainweb/examples/Counter/script/CounterCreate2.s.sol</li>
<li>foundry-chainweb/examples/Counter/src/Counter.sol</li>
<li>foundry-chainweb/examples/Counter/test/Counter.t.sol</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-foundry-chainweb">Install foundry-chainweb<a href="#install-foundry-chainweb" class="hash-link" aria-label="Direct link to Install foundry-chainweb" title="Direct link to Install foundry-chainweb">​</a></h2>
<p>To configure your development environment to use Foundry with Chainweb EVM:</p>
<ol>
<li>
<p>Create a new project directory with template files by running a command similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge init myKadenaCounter &amp;&amp; cd myKadenaCounter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you already have a Foundry project, navigate to the root directory for that project.</p>
</li>
<li>
<p>Install the <code>foundry-chainweb</code> package by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge install kadena-io/foundry-chainweb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Create a <code>remappings.txt</code> file in the root of your project.</p>
</li>
<li>
<p>Add the following to the <code>remappings.txt</code> file to override the default dependency mapping:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kadena-io/foundry-chainweb/=lib/foundry-chainweb/src/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Open the <code>foundry.toml</code> configuration file for your project and enable the Foreign Function Interface (FFI) support by setting the <code>ffi</code> option to <code>true</code> in your profile.</p>
<p>For example:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[profile.default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ffi = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The FFI feature allows Solidity tests and scripts to execute external commands or interact with the file system.</p>
</li>
<li>
<p>Enable <code>read</code> access to the <code>chainweb.config.json</code> file by adding the <code>fs_permissions</code> option to the <code>foundry.toml</code> file:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fs_permissions = [{ access = &quot;read&quot;, path = &quot;./chainweb.config.json&quot; }]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, projects have no file system permissions, and can&#x27;t read or write to any file system files or directories.
The <code>fs_permissions</code> option enables you to configure specific file system permissions for specific files or directories.
In this case, you&#x27;re only allowing the project to read the <code>chainweb.config.json</code> file.
You&#x27;ll use the <code>chainweb.config.json</code> file to configure the settings to use for different network environments.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-environment-settings">Configure environment settings<a href="#configure-environment-settings" class="hash-link" aria-label="Direct link to Configure environment settings" title="Direct link to Configure environment settings">​</a></h2>
<p>A sample <code>chainweb.config.json</code> configuration file is installed by default in the <code>lib/foundry-chainweb</code> directory when you add <code>foundry-chainweb</code> to your project.
You can copy the sample  <code>chainweb.config.json</code> file to the root directory for your project or create a new <code>chainweb.config.json</code> file in the root directory.</p>
<p>You can use the <code>chainweb.config.json</code> file to configure different Chainweb EVM network settings to deploy and run contracts on multiple Chainweb EVM chains.
For example, you can modify the configuration file to define the number of EVM-compatible chains and the chain identifiers to use for different target networks, including <code>anvil</code>, a local Chainweb EVM node, the Chainweb EVM testnet, and Kadena mainnet.</p>
<p>The following sample <code>chainweb.config.json</code> file configures three deployment targets, the <code>anvil</code> target, the <code>evm-local</code> target, and the <code>evm-testnet</code> target, each with multiple EVM-compatible chains and with different Ethereum base chain identifiers:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;anvil&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;evm-local&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1789</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;externalHostUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:1848/chainweb/0.0/evm-development&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;evm-testnet&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;externalHostUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://evm-testnet.chainweb.com/chainweb/0.0/evm-testnet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you see in this example, you can set the following configuration parameters in the <code>chainweb.config.json</code> file:</p>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>numberOfChains</code></td><td><code>number</code></td><td>Number of Chainweb EVM chains to initialize and fork in the target environment.</td></tr><tr><td><code>chainwebChainIdOffset</code></td><td><code>number</code></td><td>Index to start mapping Chainweb EVM chain identifiers to prevent collisions between Chainweb Pact and EVM chains. The Chainweb chain identifiers 0 through 19 are reserved for Pact chains.</td></tr><tr><td><code>chainIdOffset</code></td><td><code>number</code></td><td>Base Ethereum chain identifier to use as the starting point for Chainweb EVM chain identifiers. For example, if you set the base <code>chainIdOffset</code> to 1000, <code>numberOfChains</code> to three, and the <code>chainwebChainIdOffset</code> index to zero, the resulting chain identifiers would be 1000, 1001, and 1002.</td></tr><tr><td><code>externalHostUrl</code></td><td><code>string</code></td><td>Base URL for external Chainweb network access.</td></tr></tbody></table>
<p>You should note that the <code>chainid</code> used in Chainweb EVM tests and scripts for Foundry projects is the blockchain network identifier and is computed using the <code>chainIdOffset</code> defined in the project <code>chainweb.config.json</code> file.
This chain identifier is used as the base and incremented for each chain where a test or script runs.</p>
<p>The Chainweb chain identifier—for example, chains 20, 21, 22, 23, and 24 in the <code>evm-testnet</code> configuration—is computed using the <code>chainwebChainIdOffset</code> defined in the project <code>chainweb.config.json</code> file as a base and incremented for each chain where a test or script runs.</p>
<p><strong>Important</strong>: The  <code>chainweb.config.json</code> configuration file is only used when running scripts with <code>ChainwebScript</code>.
When running tests with <code>ChainwebTest</code>, the configuration parameters are passed directly to the constructor and the configuration file is ignored.</p>
<p>After you configure the settings for different deployment targets, you are ready to update the tests and scripts for your project to run on multiple chains.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-custom-setup-function">Add a custom setup function<a href="#add-a-custom-setup-function" class="hash-link" aria-label="Direct link to Add a custom setup function" title="Direct link to Add a custom setup function">​</a></h2>
<p>To add custom setup logic to tests or scripts, you should use the optional <code>userSetUp</code> method instead of the default Foundry <code>setUp</code> method.</p>
<p>For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract CounterTest is ChainwebTest(2, 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function userSetUp() public override {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom set up logic can be added here if needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&quot;Setting up your test here&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-multi-chain-tests">Add multi-chain tests<a href="#add-multi-chain-tests" class="hash-link" aria-label="Direct link to Add multi-chain tests" title="Direct link to Add multi-chain tests">​</a></h2>
<p>To write tests that run on Chainweb EVM and support the multi-chain network, you should import the <code>ChainwebTest</code> contract that&#x27;s defined in the <code>lib/foundry-chainweb/src/Chainweb.sol</code> file instead of using the default Foundry <code>Test</code> base contract.</p>
<p>The <code>ChainwebTest</code> code extends the Foundry <code>Test</code> contract by adding a <code>chainweb</code> property that provides two additional methods—the <code>getChainIds</code> and <code>switchChain</code> methods—to support the multi-chain network.</p>
<ul>
<li><code>chainweb.getChainIds</code> returns a list of available Chainweb chain identifiers.</li>
<li><code>chainweb.switchChain</code> switches from the current active chain to a specified chain identifier in the Chainweb network.</li>
</ul>
<p>For more information about these methods and other functions defined in the <code>Chainweb.sol</code> contract, see <a href="/docs/reference/evm-integration/foundry-chainweb-ref">Foundry Chainweb EVM - Chainweb.sol</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="input-parameters">Input parameters<a href="#input-parameters" class="hash-link" aria-label="Direct link to Input parameters" title="Direct link to Input parameters">​</a></h3>
<p>The <code>ChainwebTest</code> constructor takes the following parameters to set up multi-chain testing:</p>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>numberOfChains</code></td><td><code>uint24</code></td><td>Number of chains to initialize and fork.</td></tr><tr><td><code>chainwebChainIdOffset</code></td><td><code>uint24</code></td><td>Index to start mapping Chainweb EVM chain identifiers to prevent collisions between Chainweb Pact and EVM chains.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-multi-chain-tests">Adding multi-chain tests<a href="#adding-multi-chain-tests" class="hash-link" aria-label="Direct link to Adding multi-chain tests" title="Direct link to Adding multi-chain tests">​</a></h3>
<p>The following example demonstrates using <code>ChainwebTest</code> with the <code>switchChain</code> method to test the <code>setNumber</code> and <code>increment</code> functions from the <code>Counter</code> contract on two chains:</p>
<div class="language-Solidity language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: UNLICENSED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.13;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {console} from &quot;forge-std/Test.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {Counter} from &quot;../src/Counter.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {ChainwebTest} from &quot;kadena-io/foundry-chainweb/Chainweb.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// numberOfChains is 2 and chainwebChainIdOffset index is 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract CounterTest is ChainwebTest(2, 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function test_SetNumberMultiChain() public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256[] memory chainIds = chainweb.getChainIds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&quot;Chains in the chainweb:&quot;, chainIds.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (uint256 i = 0; i &lt; chainIds.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;i:&quot;, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chainweb.switchChain(chainIds[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Counter counter = new Counter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;Running script on chain:&quot;, block.chainid);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;Counter deployed at:&quot;, address(counter));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counter.setNumber(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertEq(counter.number(), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function test_IncrementMultiChain() public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256[] memory chainIds = chainweb.getChainIds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&quot;Chains in the chainweb:&quot;, chainIds.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (uint256 i = 0; i &lt; chainIds.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;i:&quot;, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chainweb.switchChain(chainIds[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Counter counter = new Counter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;Running script on chain:&quot;, block.chainid);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;Counter deployed at:&quot;, address(counter));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counter.setNumber(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counter.increment();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            assertEq(counter.number(), 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="executing-multi-chain-tests">Executing multi-chain tests<a href="#executing-multi-chain-tests" class="hash-link" aria-label="Direct link to Executing multi-chain tests" title="Direct link to Executing multi-chain tests">​</a></h3>
<p>You can execute the tests defined for your contract by running the <code>forge test</code> command.
For example, you can run the following command to display test results with additional details about test execution:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge test -vv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, tests run on two chains and the offset index is zero.
With the level two logging option, the command displays information about the tests executed similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠒] Compiling 23 files with Solc 0.8.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠑] Solc 0.8.30 finished in 519.96ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compiler run successful!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ran 2 tests for test/Counter.t.sol:CounterTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[PASS] test_IncrementMultiChain() (gas: 357127)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Setting up Chainweb for tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TEST: Setting main RPC node for 2 chains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying chainId precompile for chainId: 0  at address: 0x9b02c3e2dF42533e0FD166798B5A616f59DBd2cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actually stored: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying chainId precompile for chainId: 1  at address: 0x9b02c3e2dF42533e0FD166798B5A616f59DBd2cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actually stored: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Chains in the chainweb: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Running script on chain: 31337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Counter deployed at: 0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Running script on chain: 31338</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Counter deployed at: 0x2e234DAe75C793f67A35089C9d99245E1C58470b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[PASS] test_SetNumberMultiChain() (gas: 355387)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Setting up Chainweb for tests...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TEST: Setting main RPC node for 2 chains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying chainId precompile for chainId: 0  at address: 0x9b02c3e2dF42533e0FD166798B5A616f59DBd2cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actually stored: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying chainId precompile for chainId: 1  at address: 0x9b02c3e2dF42533e0FD166798B5A616f59DBd2cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actually stored: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Chains in the chainweb: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Running script on chain: 31337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Counter deployed at: 0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Running script on chain: 31338</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Counter deployed at: 0x2e234DAe75C793f67A35089C9d99245E1C58470b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Suite result: ok. 2 passed; 0 failed; 0 skipped; finished in 758.11ms (3.57ms CPU time)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ran 1 test suite in 768.88ms (758.11ms CPU time): 2 tests passed, 0 failed, 0 skipped (2 total tests)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="write-multi-chain-scripts">Write multi-chain scripts<a href="#write-multi-chain-scripts" class="hash-link" aria-label="Direct link to Write multi-chain scripts" title="Direct link to Write multi-chain scripts">​</a></h2>
<p>To write scripts that run on Chainweb EVM and support the multi-chain network, you should import the <code>ChainwebScript</code> contract that&#x27;s defined in the <code>lib/foundry-chainweb/src/Chainweb.sol</code> file instead of using the default Foundry <code>Script</code> contract.
Like <code>ChainwebTest</code>, the <code>ChainwebScript</code> code extends the default Foundry <code>Script</code> contract by adding a <code>chainweb</code> property that provides two additional methods—the <code>getChainIds</code> and <code>switchChain</code> methods—to support the multi-chain network.</p>
<ul>
<li><code>chainweb.getChainIds</code> returns a list of available Chainweb chain identifiers.</li>
<li><code>chainweb.switchChain</code> switches from the current active chain to a specified chain identifier in the Chainweb network.</li>
</ul>
<p>For more information about these methods and other functions defined in the <code>Chainweb.sol</code> contract, see <a href="/docs/reference/evm-integration/foundry-chainweb-ref">Foundry Chainweb EVM - Chainweb.sol</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="writing-a-multi-chain-deployment-script">Writing a multi-chain deployment script<a href="#writing-a-multi-chain-deployment-script" class="hash-link" aria-label="Direct link to Writing a multi-chain deployment script" title="Direct link to Writing a multi-chain deployment script">​</a></h3>
<p>The following example demonstrates using <code>ChainwebScript</code> with the <code>getChainIds</code> and <code>switchChain</code> methods to deploy the <code>Counter</code> contract on multiple chains:</p>
<div class="language-Solidity language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: UNLICENSED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.13;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {Script, console} from &quot;forge-std/Script.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {Counter} from &quot;../src/Counter.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import {ChainwebScript} from &quot;kadena-io/foundry-chainweb/Chainweb.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract CounterScript is ChainwebScript {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function run() public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256[] memory chainIds = chainweb.getChainIds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // loop over chains and deploy the contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (uint256 i = 0; i &lt; chainIds.length; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chainweb.switchChain(chainIds[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            uint256 activeChainId = chainweb.getActiveChainId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            console.log(&quot;Active Chainweb chain ID:&quot;, activeChainId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            require(activeChainId == chainIds[i], &quot;Active Chainweb chain ID does not match expected chain ID&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            vm.startBroadcast();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Counter counter1 = new Counter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counter1.setNumber(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            vm.stopBroadcast();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reading-configuration-settings">Reading configuration settings<a href="#reading-configuration-settings" class="hash-link" aria-label="Direct link to Reading configuration settings" title="Direct link to Reading configuration settings">​</a></h3>
<p>The script automatically reads configuration settings from the <code>chainweb.config.json</code> file and uses the <code>CHAINWEB</code> environment variable, if specified, to determine which configuration settings to apply.
If you don&#x27;t specify the <code>CHAINWEB</code> environment variable, the script uses the <code>anvil</code> environment by default.</p>
<p>For example, you can deploy the <code>Counter</code> contract with the default configuration that uses the <code>anvil</code> node environment and the private key for a test account by running the <code>Counter.s.sol</code> script like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge script --multi script/Counter.s.sol:CounterScript \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --broadcast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠒] Compiling 1 files with Solc 0.8.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠑] Solc 0.8.30 finished in 498.98ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compiler run successful!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Multi chain deployment is still under development. Use with caution.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Script ran successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gas used: 554347</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">== Logs ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Setting up Chainweb for scripts...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SCRIPT: Setting main RPC node for 3 chains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:15686</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:4667</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:32834</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Active Chainweb chain ID: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Active Chainweb chain ID: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Active Chainweb chain ID: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Setting up 3 EVMs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 264211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000528422000264211 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 264211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000528422000264211 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62601</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 264211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000528422000264211 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x69a7fe2ef2f94b3f712a3fe57029284079e9ecf9dd4a1b2902911675ba0710df</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000156813000156813 ETH (156813 gas * 1.000000001 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x3b6e4deed1bdae3daf55a9bf1fe618049ff6141479a37f0b43de0d9209b78ae1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000038291100884096 ETH (43696 gas * 0.876306776 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62601</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0xe42061b95d948bc6fe04ae2eed17f5adcb9814b78806d07e07baef9fff6f9284</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000156813000156813 ETH (156813 gas * 1.000000001 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62601</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0xdad0643eb985923056c17fd1ca3ffca119557acf918692d4ffb0ef2d9fdbe6ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000038291100884096 ETH (43696 gas * 0.876306776 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0xffadef8eaa3ba206e1878bb481691f121bd362b42509a4b6c30229b2c553c9cc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000156813000156813 ETH (156813 gas * 1.000000001 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 62602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x688439a4a551a573a1ea706bc1bed424f879e5143f5672de2ea29a12863b1cfb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000038291100884096 ETH (43696 gas * 0.876306776 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ Sequence #1 on 62600 | Total Paid: 0.000195104101040909 ETH (200509 gas * avg 0.938153388 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ Sequence #2 on 62601 | Total Paid: 0.000195104101040909 ETH (200509 gas * avg 0.938153388 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ Sequence #3 on 62602 | Total Paid: 0.000195104101040909 ETH (200509 gas * avg 0.938153388 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ONCHAIN EXECUTION COMPLETE &amp; SUCCESSFUL.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transactions saved to: /Users/pistolas/myKadenaCounter/broadcast/multi/Counter.s.sol-latest/run.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sensitive details saved to: /Users/pistolas/myKadenaCounter/cache/multi/Counter.s.sol-latest/run.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can run the deployment script using the <code>evm-local</code> configuration from the <code>chainweb.config.json</code> file as the target environment by running a command similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CHAINWEB=evm-local forge script --multi script/Counter.s.sol:CounterScript \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --broadcast --legacy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-configuration-and-deployment">Sample configuration and deployment<a href="#sample-configuration-and-deployment" class="hash-link" aria-label="Direct link to Sample configuration and deployment" title="Direct link to Sample configuration and deployment">​</a></h2>
<p>The following sample <code>chainweb.config.json</code> file demonstrates the configuration settings for the default <code>anvil</code> local environment, a custom <code>evm-local</code> local development environment, and the Chainweb EVM <code>evm-testnet</code> network.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;anvil&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;evm-local&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1789</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;externalHostUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:1848/chainweb/0.0/evm-development&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;evm-testnet&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;numberOfChains&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainwebChainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;chainIdOffset&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5920</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;externalHostUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://evm-testnet.chainweb.com/chainweb/0.0/evm-testnet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To deploy the Counter contract using the <code>evm-local</code> configuration settings and the private key for one of the predefined development wallet accounts:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CHAINWEB=evm-local forge script --multi script/Counter.s.sol:CounterScript \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private-key 0x67a8e3847c417e5c8989af0c161aea6a601bcd8f4f5fd7dbad89d7e74bf28dbc \                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --broadcast --legacy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This deployment script deploys the contract on two Chainweb EVM chains with output similar to the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No files changed, compilation skipped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Multi chain deployment is still under development. Use with caution.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Script ran successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gas used: 382845</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">== Logs ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Setting up Chainweb for scripts...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SCRIPT: Setting main RPC node for 2 chains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Using custom RPC URL: http://localhost:1848/chainweb/0.0/evm-development/chain/20/evm/rpc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Using custom RPC URL: http://localhost:1848/chainweb/0.0/evm-development/chain/21/evm/rpc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Active Chainweb chain ID: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Active Chainweb chain ID: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Setting up 2 EVMs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 1790</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 1.000000007 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 264211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000264211001849477 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 1789</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 1.000000007 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 264211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000264211001849477 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 1789</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x81b13a99253bc4b0554675c9421d1e40ea4765a1f603e02fd3284cd7ebcf2292</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 3521</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000043696000305872 ETH (43696 gas * 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 1789</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x9176eee2c9d556b9a575fe6de32c0636e982a4dc9b4d2e4e4c155714f3d6d60b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contract Address: 0xfab4C60CF33e03d4F35c7d3E0aBF33e0e4E6E6d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 3521</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000156813001097691 ETH (156813 gas * 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 1790</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x668a2be6866b89559f01e5b764b1fe1832b08ddba50d5c47cb282218a2c1ea58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 3522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000043696000305872 ETH (43696 gas * 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##### 1790</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅  [Success] Hash: 0x2e6022c1189995acead47a1870c79562a86bc31bdb76563c3de4556687601f82</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Contract Address: 0xfab4C60CF33e03d4F35c7d3E0aBF33e0e4E6E6d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Block: 3522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Paid: 0.000156813001097691 ETH (156813 gas * 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ Sequence #1 on 1789 | Total Paid: 0.000200509001403563 ETH (200509 gas * avg 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ Sequence #2 on 1790 | Total Paid: 0.000200509001403563 ETH (200509 gas * avg 1.000000007 gwei)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ONCHAIN EXECUTION COMPLETE &amp; SUCCESSFUL.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transactions saved to: /Users/pistolas/myKadenaCounter/broadcast/multi/Counter.s.sol-latest/run.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sensitive details saved to: /Users/pistolas/myKadenaCounter/cache/multi/Counter.s.sol-latest/run.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the sample output for deploying the contract on multiple chains, you&#x27;ll notice that the Foundry chain identifiers are computed using the default value from the <code>chainIdOffset</code> property in <code>chainweb.config.json</code> file as a base value and incremented for each Chainweb EVM chain.
As a result of the computation, Chainweb EVM chain 20 (index 0) maps to the base chain identifier 62600 for the <code>anvil</code> network, <code>1789</code> for the <code>evm-local</code> network, or 5920 for the <code>evm-testnet</code> network.
In this example with only two EVM chains, CChainweb EVM chain 20 (index 0) is mapped to the <code>chainIdOffset</code> 1789 (base)and Chainweb EVM chain 21 (index 1) is incremented to the chain identifier 1790.</p>
<p>You should note that Chainweb chain identifiers 0 through 19 are reserved for chains that support Pact, so Kadena public networks use the <code>chainwebChainIdOffset</code> to set the starting point for Chainweb EVM chain identifiers.
For example, the Chainweb EVM testnet consists of five chains with the chain identifiers 20, 21, 22, 23, and 24.
This starting point value is configured in the <code>chainweb.config.json</code> file for each project and for each deployment target.
In the sample <code>chainweb.config.json</code> file, the <code>anvil</code> deployment target is also configured to use 20 as the starting point for Chainweb EVM chain identifiers.
However, if you spin up internal <code>anvil</code> instances for testing, you&#x27;ll see Chainweb chain identifiers starting with 0.</p>
<p>The <code>chainIdOffset</code> in the <code>chainweb.config.json</code> file is the starting point for the <strong>Ethereum network chain identifier</strong>, similar to 1 for the Ethereum mainnet.
For Chainweb EVM testnet chains, the starting value for the Ethereum network chain identifier is 5920.
The network chain identifier for the Chainweb EVM testnet chain 20 is 5920.
Chainweb EVM testnet chain 21 has network chain identifier 5921, and so on.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="verify-multi-chain-contracts">Verify multi-chain contracts<a href="#verify-multi-chain-contracts" class="hash-link" aria-label="Direct link to Verify multi-chain contracts" title="Direct link to Verify multi-chain contracts">​</a></h2>
<p>You can verify contracts that run on Chainweb EVM by running the standard <code>forge verify-contract</code> command.
The following example demonstrates verifying a contract like <code>Counter.sol</code> that has no constructor arguments:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge verify-contract \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --chain 5920 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --num-of-optimizations 200 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --watch \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --verifier blockscout \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --verifier-url https://chain-20.evm-testnet-blockscout.chainweb.com/api/ \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --verifier-api-version v2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --compiler-version v0.8.28 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0x3ee2edc5b2967093bf9b3058cf9803bee7595baf \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  src/Counter.sol:Counter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If your contract has constructor arguments, you can pass them using the <code>--constructor-args</code> option.
For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--constructor-args $(cast abi-encode &quot;constructor(string,string,uint256,uint256)&quot; &quot;ForgeUSD&quot; &quot;FUSD&quot; 18 1000000000000000000000)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can run the following command to see all of the <code>verify-contract</code> command-line options:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge verify-contract --help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For contracts that run on multiple Chainweb EVM chains, you must run the <code>verify-contract</code> command on each chain.
However, the <code>verify-contract</code> command doesn&#x27;t support verification if a contract with the same bytecode has been previously verified.
If you attempt to verify a contract with the same bytecode as a contract that has been previously verified, verification will fail with a message similar to the following:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[address] is already verified. Skipping verification.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To test contract verification on multiple chains, you must change the bytecode, redeploy, then run the <code>verify-contract</code> command on the redeployed contract.</p>
<p>You can change the bytecode by adding a constant at the top of the contract like this:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uint256 public constant DUMMY = 1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Increase the value used for the constant in each contract you deploy to verify contracts that are deployed on multiple chains.
Contract verification is not possible against anvil instances, because there is no block explorer for anvil.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-nonces-are-maintained-in-multi-fork-scenarios">How nonces are maintained in multi-fork scenarios<a href="#how-nonces-are-maintained-in-multi-fork-scenarios" class="hash-link" aria-label="Direct link to How nonces are maintained in multi-fork scenarios" title="Direct link to How nonces are maintained in multi-fork scenarios">​</a></h2>
<p>The account you use when you execute tests with <code>forge test</code> or run scripts with <code>forge script</code> commands affects how the transaction nonce is maintained in different scenarios.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="forge-test-with-msgsender">forge test with msg.sender<a href="#forge-test-with-msgsender" class="hash-link" aria-label="Direct link to forge test with msg.sender" title="Direct link to forge test with msg.sender">​</a></h3>
<p>Because the default <code>msg.sender</code> account is a persisted account that&#x27;s available across all forks, you can run <code>forge test</code> using the default <code>msg.sender</code> account to ensure transactions have a nonce that&#x27;s maintained globally across all forks.</p>
<p>If you want to test a contract using isolated nonces that are maintained separately for each fork, you can use the <code>vm.startPrank</code> or <code>vm.startBroadcast</code> function to set a specific account instead of using the default <code>msg.sender</code> account.
The nonce for that account is then maintained per fork.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="forge-script-with-msgsender">forge script with msg.sender<a href="#forge-script-with-msgsender" class="hash-link" aria-label="Direct link to forge script with msg.sender" title="Direct link to forge script with msg.sender">​</a></h3>
<p>Because the default <code>msg.sender</code> account is a persisted account that&#x27;s available across all forks, you can run <code>forge script</code> using the default <code>msg.sender</code> account to ensure transactions have a nonce that&#x27;s maintained globally across all forks.</p>
<p>If you specify the <code>msg.sender</code> account by setting the <code>--sender</code> or <code>--private-key</code> command-line option, the nonce is maintained per fork.</p>
<p>You can also use the <code>vm.startBroadcast</code> function to explicitly set the sender for the next call.
The nonce for that sender is maintained per fork.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deterministic-deployment">Deterministic deployment<a href="#deterministic-deployment" class="hash-link" aria-label="Direct link to Deterministic deployment" title="Direct link to Deterministic deployment">​</a></h2>
<p>The <code>/examples/Counter</code> folder in the <a href="https://github.com/kadena-io/foundry-chainweb" target="_blank" rel="noopener noreferrer">foundry-chainweb</a> repository includes a sample script that demonstrates how to deploy a contract that has the same address on every chain.</p>
<p>The <code>CounterCreate2.s.sol</code> script demonstrates deterministic deployment across all Chainweb EVM chains using the CREATE2 opcode.
The CREATE2 opcode ensures that the same contract is deployed using a predetermined address that is exactly the same on every chain, making cross-chain interactions predictable and easier to manage.</p>
<p>To simulate the deployment using the sample script:</p>
<ol>
<li>
<p>Open a terminal shell on your computer.</p>
</li>
<li>
<p>Change to the <code>examples/Counter</code> directory:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd examples/Counter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run a command similar to the following:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge script script/CounterCreate2.s.sol:CounterCreate2Script \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the script uses the <code>anvil</code> deployment target and simulates deployment on three chains.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[⠊] Compiling...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠑] Compiling 2 files with Solc 0.8.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[⠘] Solc 0.8.30 finished in 604.25ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compiler run successful!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Multi chain deployment is still under development. Use with caution.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Script ran successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gas used: 590474</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">== Logs ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Setting up Chainweb for scripts...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SCRIPT: Setting main RPC node for 3 chains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:7980</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:3379</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Forking http://127.0.0.1:13248</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Counter will be deployed to address: 0xe6E97678A7A22143854b5fd5AD3352897Ae29d45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Using salt: 0x186cb6b14ba03f51eb142c757b395ea189ebb4c3a3357c14b361942227b305b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying to chain: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deployed Counter at: 0xe6E97678A7A22143854b5fd5AD3352897Ae29d45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying to chain: 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deployed Counter at: 0xe6E97678A7A22143854b5fd5AD3352897Ae29d45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switching to chain: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Switched to chain: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deploying to chain: 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deployed Counter at: 0xe6E97678A7A22143854b5fd5AD3352897Ae29d45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deployment Summary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  All Counter contracts deployed to the SAME address: 0xe6E97678A7A22143854b5fd5AD3352897Ae29d45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Setting up 3 EVMs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 217681</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000435362000217681 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62601</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 217681</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000435362000217681 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chain 62602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated gas price: 2.000000001 gwei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated total gas used for script: 217681</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Estimated amount required: 0.000435362000217681 ETH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SIMULATION COMPLETE. To broadcast these transactions, add --broadcast and wallet configuration(s) to the previous command. See forge script --help for more.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transactions saved to: /Users/pistolas/myKadenaCounter/broadcast/multi/dry-run/CounterCreate2.s.sol-latest/run.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sensitive details saved to: /Users/pistolas/myKadenaCounter/cache/multi/dry-run/CounterCreate2.s.sol-latest/run.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>To deploy the Counter contract using the sample deployment script, add the <code>--broadcast</code> command-line option.</p>
<p>For example:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">forge script script/CounterCreate2.s.sol:CounterCreate2Script \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --broadcast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The sample script demonstrates the following deployment steps:</p>
<ul>
<li>Predicts the deployment address using the account salt and contract bytecode.</li>
<li>Deploys the <code>Counter</code> contract to all configured Chainweb EVM chains.</li>
<li>Verifies that each deployment matches the predicted address.</li>
<li>Displays a summary that shows all contracts were deployed to the same address.</li>
</ul>
<h1>Known issues</h1>
<p>If you run the <code>forge test</code> command with the <code>--gas-report</code> command-line option in the root directory of the <code>foundry-chainweb</code> repo, the <code>test_Nonce</code> test case fails.
This failure occurs because Foundry does not isolate the forks with separate nonces when the <code>--gas-report</code> option is used.
The nonces are global instead of per fork when you use the <code>--gas-report</code> command-line option.</p>
<p>In addition, the <code>test_setupChainsForScript</code> test case might fail when running the <code>forge test</code> command with the <code>--gas-report</code> command-line option.
This failure occurs because the contract state on the forks is not isolated.
For example, when the chainId precompile is deployed, its state variable is set to 0 for the first chain.
The state variable is then set to 1 for the second chain.
However, the state in the contract on the first chain fork is <strong>overwritten</strong> to 1 instead of writing that state to a separate fork.
The behavior can be observed by logging activity, but the root cause of the behavior isn&#x27;t known at this time.
You can attempt to work around this behavior by using the <code>vm.revokePersistent</code> cheat code in the <code>deployChainWebChainIdContract</code> function to isolate contract addresses are when using the <code>--gas-report</code> command-line option.
However, the work around doesn&#x27;t guarantee that the <code>test_setupChainsForScript</code> test case will succeed in all cases.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/evm">evm</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/foundry">foundry</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/solidity">Solidity</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/chainweb">chainweb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/network">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/node-operator">node operator</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/guides/nodes/evm-foundry-dev.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before you begin</a></li><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick start</a></li><li><a href="#install-foundry-chainweb" class="table-of-contents__link toc-highlight">Install foundry-chainweb</a></li><li><a href="#configure-environment-settings" class="table-of-contents__link toc-highlight">Configure environment settings</a></li><li><a href="#add-a-custom-setup-function" class="table-of-contents__link toc-highlight">Add a custom setup function</a></li><li><a href="#add-multi-chain-tests" class="table-of-contents__link toc-highlight">Add multi-chain tests</a></li><li><a href="#write-multi-chain-scripts" class="table-of-contents__link toc-highlight">Write multi-chain scripts</a></li><li><a href="#sample-configuration-and-deployment" class="table-of-contents__link toc-highlight">Sample configuration and deployment</a></li><li><a href="#verify-multi-chain-contracts" class="table-of-contents__link toc-highlight">Verify multi-chain contracts</a></li><li><a href="#how-nonces-are-maintained-in-multi-fork-scenarios" class="table-of-contents__link toc-highlight">How nonces are maintained in multi-fork scenarios</a></li><li><a href="#deterministic-deployment" class="table-of-contents__link toc-highlight">Deterministic deployment</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>