"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[4345],{1374:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"coding-projects/pact-server-api","title":"Pact built-in server","description":"This coding project demonstrates how to use the Pact built-in REST API endpoints for testing transactions on a local server.","source":"@site/docs/coding-projects/pact-server-api.md","sourceDirName":"coding-projects","slug":"/coding-projects/pact-server-api","permalink":"/docs/coding-projects/pact-server-api","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/coding-projects/pact-server-api.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"title":"Pact built-in server","description":"This coding project demonstrates how to use the Pact built-in REST API endpoints for testing transactions on a local server.","id":"pact-server-api","sidebar_position":8},"sidebar":"default","previous":{"title":"Estimate gas","permalink":"/docs/coding-projects/estimate-gas"},"next":{"title":"Conditions and control flow","permalink":"/docs/coding-projects/conditions-control"}}');var a=t(74848),l=t(28453);const i={title:"Pact built-in server",description:"This coding project demonstrates how to use the Pact built-in REST API endpoints for testing transactions on a local server.",id:"pact-server-api",sidebar_position:8},r="Pact built-in server",c={},o=[{value:"Before you begin",id:"before-you-begin",level:2},{value:"Create a local working environment",id:"create-a-local-working-environment",level:2},{value:"Create a project folder",id:"create-a-project-folder",level:3},{value:"Create a configuration file",id:"create-a-configuration-file",level:3},{value:"Create a sample transaction file",id:"create-a-sample-transaction-file",level:3},{value:"Create a directory for logging",id:"create-a-directory-for-logging",level:3},{value:"Start the local server",id:"start-the-local-server",level:2},{value:"Call REST API endpoints",id:"call-rest-api-endpoints",level:2},{value:"Send",id:"send",level:3},{value:"Listen",id:"listen",level:3},{value:"Poll",id:"poll",level:3},{value:"Local",id:"local",level:3},{value:"Write and execute YAML requests",id:"write-and-execute-yaml-requests",level:2},{value:"Review",id:"review",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"pact-built-in-server",children:"Pact built-in server"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.em,{children:"Pact built-in server"})," coding project demonstrates how to use the Pact built-in REST API endpoints for testing transactions on a local server.\nThis coding project focuses on how to:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Create a YAML configuration file for the Pact built-in local server."}),"\n",(0,a.jsx)(n.li,{children:"Create YAML execution API requests to submit transactions."}),"\n",(0,a.jsx)(n.li,{children:"Format YAML execution requests as JSON objects."}),"\n",(0,a.jsx)(n.li,{children:"Submit YAML requests using the Pact REST API endpoints."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"By becoming familiar with how to perform these tasks, you'll be better prepared to develop a full stack application that combines a Pact smart contract backend with a Javascript-based frontend."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Pact REST API and local server",src:t(64024).A+"",width:"2672",height:"1560"})}),"\n",(0,a.jsx)(n.h2,{id:"before-you-begin",children:"Before you begin"}),"\n",(0,a.jsx)(n.p,{children:"Before starting this project, verify your environment meets the following basic requirements:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["You have a GitHub account and can run ",(0,a.jsx)(n.code,{children:"git"})," commands."]}),"\n",(0,a.jsx)(n.li,{children:"You have installed the Pact programming language and command-line interpreter."}),"\n",(0,a.jsxs)(n.li,{children:["You have installed the ",(0,a.jsx)(n.code,{children:"kadena-cli"})," package and have a working directory with initial configuration settings."]}),"\n",(0,a.jsxs)(n.li,{children:["You have a local development node that you can connect to that runs the ",(0,a.jsx)(n.code,{children:"chainweb-node"})," program, either in a Docker container or on a physical or virtual computer."]}),"\n",(0,a.jsx)(n.li,{children:"You should be familiar with defining modules and using keysets."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"create-a-local-working-environment",children:"Create a local working environment"}),"\n",(0,a.jsx)(n.p,{children:"For this coding project, there's no starter code.\nInstead, you'll create a local working environment that includes the following:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A local project directory."}),"\n",(0,a.jsx)(n.li,{children:"A local server configuration file."}),"\n",(0,a.jsx)(n.li,{children:"A sample transaction execution request using the YAML API request format."}),"\n",(0,a.jsx)(n.li,{children:"A directory for storing log files."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"create-a-project-folder",children:"Create a project folder"}),"\n",(0,a.jsx)(n.p,{children:"To create a project folder:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Open a terminal shell on your computer."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a new directory named ",(0,a.jsx)(n.code,{children:"local-project"})," to hold the project files."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir deploy-tutorial\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Change the directory to make the ",(0,a.jsx)(n.code,{children:"local-project"})," folder your current working directory:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd local-project\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"create-a-configuration-file",children:"Create a configuration file"}),"\n",(0,a.jsx)(n.p,{children:"To create a server configuration file:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a new ",(0,a.jsx)(n.code,{children:"pact-config.yaml"})," file for the local server configuration settings:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"touch pact-config.yaml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Open the ",(0,a.jsx)(n.code,{children:"pact-config.yaml"})," file in your code editor and define the following configuration settings:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Configuration file for the Pact built-in HTTP server.\n\n# HTTP server port\nport: 8080\n\n# directory for HTTP logs\nlogDir: http-log\n\n# persistence directory\npersistDir: http-log\n\n# SQLite pragmas for pact back-end\npragmas: []\n\n# verbose: provide log output\nverbose: True\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You can also find the standard format for the Pact server configuration file in the ",(0,a.jsx)(n.a,{href:"https://github.com/kadena-io/pact/blob/master/config.yaml",children:"Pact repository"}),".\nThe file provides the following fields to configure settings for the Pact built-in server:"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"Use this field"}),(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"To do this"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"port"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Specify the port number for the local Pact HTTP server to use. In this example, the port number ",(0,a.jsx)(n.code,{children:"8080"})," is specified and is used as the port in all of the examples in this project. You can change this setting if you want to use a different. If this port is available in your local environment, you can leave this setting as it is."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"logDir"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Specify the directory for HTTP logs should be stored. This setting specifies a folder location relative to the current directory."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"persistDir"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Specify the directory for persistence data to be stored. This setting specifies a folder location relative to the current directory."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"pragmas"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Specify the SQLite pragmas commands to control environmental variables or state flags within the Pact SQLite database."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"verbose"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Specify whether you want the Pact server to log output. You can set this field to ",(0,a.jsx)(n.code,{children:"true"})," to produce log files or false if don't want to produce log files."]})]})]})]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Save your changes and close the ",(0,a.jsx)(n.code,{children:"pact-config.yaml"})," configuration file."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"create-a-sample-transaction-file",children:"Create a sample transaction file"}),"\n",(0,a.jsx)(n.p,{children:"To create a sample transaction file:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a new ",(0,a.jsx)(n.code,{children:"transaction.yaml"})," file for the local server configuration settings:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"touch transaction.yaml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Open the ",(0,a.jsx)(n.code,{children:"transaction.yaml"})," file in your code editor and define a sample execution request using the YAML API request format:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'code: "(+ 1 2)"\ndata:\n  name: Stuart\n  language: Pact\nkeyPairs:\n  - public: ba54b224d1924dd98403f5c751abdd10de6cd81b0121800bf7bdbdcfaec7388d\n    secret: 8693e641ae2bbe9ea802c736f42027b03f86afe63cae315e7169c9c496c17332\n'})}),"\n",(0,a.jsxs)(n.p,{children:["In this example, the transaction includes one line of Pact code ",(0,a.jsx)(n.code,{children:"1 + 2"}),", two data fields for the name ",(0,a.jsx)(n.code,{children:"Stuart"})," and the language ",(0,a.jsx)(n.code,{children:"Pact"}),", and a public and secret key pair that was generate by running the ",(0,a.jsx)(n.code,{children:"pact --genkey"})," command.\nTransaction requests must always include either the ",(0,a.jsx)(n.code,{children:"code"})," setting to specify the Pact code to execute or the ",(0,a.jsx)(n.code,{children:"codeFile"})," setting to specify the path to a file that contains the Pact code to execute.\nThe ",(0,a.jsx)(n.code,{children:"data"})," setting is most commonly uses to specify keyset information.\nFor example:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'codeFile: "deploy-hello.pact"\ndata:\n  sample-keyset: {\n    keys: ["58705e8699678bd15bbda2cf40fa236694895db614aafc82cf1c06c014ca963c"],\n    pred: "keys-all"\n   }\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Alternatively, you can use a ",(0,a.jsx)(n.code,{children:"dataFile"})," setting to specify the path to a file that contains the data for the transaction."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"keyPairs"})," setting lists key pairs to use for signing transaction.\nThe key pairs are expected to be generated using the Ed25519 signature scheme that produces a base-16 public key and base-16 secret key."]}),"\n",(0,a.jsxs)(n.p,{children:["For more information about formatting API requests in YAML, see ",(0,a.jsx)(n.a,{href:"/smart-contracts/transactions#transaction-formats",children:"Transaction formats"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Save your changes and close the ",(0,a.jsx)(n.code,{children:"transaction.yaml"})," file."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"create-a-directory-for-logging",children:"Create a directory for logging"}),"\n",(0,a.jsx)(n.p,{children:"To create a directory for logging:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Open a terminal shell on your computer and navigate to the ",(0,a.jsx)(n.code,{children:"local-project"})," folder, if necessary."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a new directory named ",(0,a.jsx)(n.code,{children:"http-log"})," to hold the log files."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mkdir http-log\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Check the contents of the directory to verify you have the log directory and YAML files."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ls -l\n"})}),"\n",(0,a.jsx)(n.p,{children:"The command should display output similar to the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"total 16\ndrwxr-xr-x  2 pistolas  staff   64 Jan  6 15:33 http-log\n-rw-r--r--  1 pistolas  staff  279 Jan  6 15:33 pact-config.yaml\n-rw-r--r--  1 pistolas  staff  218 Jan  6 15:31 transaction.yaml\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"start-the-local-server",children:"Start the local server"}),"\n",(0,a.jsx)(n.p,{children:"Now that you have a working environment, you are ready to start the Pact server and use the local Pact REST API endpoints to test transactions."}),"\n",(0,a.jsx)(n.p,{children:"To start the local server:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Open a terminal shell on your computer and navigate to the ",(0,a.jsx)(n.code,{children:"local-project"})," folder, if necessary."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Start the local server using the settings you defined in the pact-config.yaml file."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pact --serve pact-config.yaml\n"})}),"\n",(0,a.jsx)(n.p,{children:"After running this command, you should see the Pact server initialized and running on port 8080 with output similar to the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'2025/01/06-15:44:02 [history] Persistence Enabled: http-log/commands.sqlite\n2025/01/06-15:44:02 [PactService] INIT Initializing pact SQLLite\n2025/01/06-15:44:02 [api] starting on port 8080\n2025/01/06-15:44:02 [PactService] INIT Creating Pact Schema\n2025/01/06-15:44:02 [PactPersist] DDL createTable: TableId "SYS_usertables"\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: DataTable (TableId "SYS_usertables")\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: TxTable (TableId "SYS_usertables")\n2025/01/06-15:44:02 [PactPersist] DDL createTable: TableId "SYS_keysets"\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: DataTable (TableId "SYS_keysets")\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: TxTable (TableId "SYS_keysets")\n2025/01/06-15:44:02 [PactPersist] DDL createTable: TableId "SYS_modules"\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: DataTable (TableId "SYS_modules")\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: TxTable (TableId "SYS_modules")\n2025/01/06-15:44:02 [PactPersist] DDL createTable: TableId "SYS_namespaces"\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: DataTable (TableId "SYS_namespaces")\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: TxTable (TableId "SYS_namespaces")\n2025/01/06-15:44:02 [PactPersist] DDL createTable: TableId "SYS_pacts"\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: DataTable (TableId "SYS_pacts")\n2025/01/06-15:44:02 [Persist-SQLite] DDL createTable: TxTable (TableId "SYS_pacts")\n2025/01/06-15:44:02 [disk replay]: No replay found\n'})}),"\n",(0,a.jsx)(n.p,{children:"You can now call Pact REST API endpoints using the local server."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"call-rest-api-endpoints",children:"Call REST API endpoints"}),"\n",(0,a.jsx)(n.p,{children:"You can use the local Pact server to call the following Pact REST API endpoints:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"Use this endpoint"}),(0,a.jsx)(n.th,{style:{textAlign:"left"},children:"To do this"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"/send"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Submit a transaction that contains a ",(0,a.jsx)(n.code,{children:"cmd"})," object in JSON format and return a transaction hash. This transaction hash is the same string as the ",(0,a.jsx)(n.strong,{children:"request key"})," you can use to look up transaction results."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"/listen"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Specify a single transaction hash and return the transaction result."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"/poll"})}),(0,a.jsx)(n.td,{style:{textAlign:"left"},children:"Specify multiple transaction hashes in a single request and return multiple transaction results."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{style:{textAlign:"left"},children:(0,a.jsx)(n.code,{children:"/local"})}),(0,a.jsxs)(n.td,{style:{textAlign:"left"},children:["Submit a transaction that contains a ",(0,a.jsx)(n.code,{children:"cmd"})," object that queries the blockchain but only runs in the local server and return the transaction result."]})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"send",children:"Send"}),"\n",(0,a.jsxs)(n.p,{children:["Now that the Pact server is running, you can use the terminal to call the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint locally.\nTo call the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint, you must:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Convert the YAML request in the transaction.yaml file into a JSON ",(0,a.jsx)(n.code,{children:"cmd"})," object."]}),"\n",(0,a.jsxs)(n.li,{children:["Include the ",(0,a.jsx)(n.code,{children:"cmd"})," object in the request body in the API request."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["To call the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint:"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Open a new terminal shell on your computer."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Navigate to the ",(0,a.jsx)(n.code,{children:"local-project"})," folder."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Convert the YAML request in the transaction.yaml file into a JSON cmd object."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pact --apireq transaction.yaml\n"})}),"\n",(0,a.jsx)(n.p,{children:"This command formats the sample transaction file and displays the JSON output similar to the following in the terminal:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"cmds":[{"hash":"KVe1Kw3IvlS_hkf95Hsa2yjC0AQCXGlI2ZVXVcUfT88","sigs":[{"sig":"7c35dad8a8990642bfe7331cd2553ca1a27828bc29b29257ece286ac0a52c3958da24102496d708d479c544136d1553f954e962239c0f48d5eebe87131360e0e"}],"cmd":"{\\"networkId\\":null,\\"payload\\":{\\"exec\\":{\\"data\\":{\\"name\\":\\"Stuart\\",\\"language\\":\\"Pact\\"},\\"code\\":\\"(+ 1 2)\\"}},\\"signers\\":[{\\"pubKey\\":\\"ba54b224d1924dd98403f5c751abdd10de6cd81b0121800bf7bdbdcfaec7388d\\"}],\\"meta\\":{\\"creationTime\\":0,\\"ttl\\":0,\\"gasLimit\\":0,\\"chainId\\":\\"\\",\\"gasPrice\\":0,\\"sender\\":\\"\\"},\\"nonce\\":\\"2025-01-07 00:10:12.876201 UTC\\"}"}]}\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Call the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint using a ",(0,a.jsx)(n.code,{children:"curl"})," command similar to the following:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'pact --apireq transaction.yaml | curl -H "Content-Type: application/json" -d @- http://localhost:8080/api/v1/send\n'})}),"\n",(0,a.jsxs)(n.p,{children:["This command formats that YAML transaction, specifies the request header for the ",(0,a.jsx)(n.code,{children:"Content-Type"})," to be ",(0,a.jsx)(n.code,{children:"application/json"}),", then specifies the destination for the API call.\nIn this case, the API call is sent to the ",(0,a.jsx)(n.code,{children:"localhost"})," on port ",(0,a.jsx)(n.code,{children:"8080"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"This command returns the request key for the transaction in the response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"requestKeys":["Mvn7OBApUVCck9lPzvNJjwd2gBeq6ZFEJnXTI-R0hQQ"]}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Each request generates a unique transaction hash, so your request key will be different from the example."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"listen",children:"Listen"}),"\n",(0,a.jsxs)(n.p,{children:["You can use the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint to request the transaction result for a single transaction hash.\nThe format for calling the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint looks similar to the following:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"listen":"Mvn7OBApUVCck9lPzvNJjwd2gBeq6ZFEJnXTI-R0hQQ"}\' -X POST http://localhost:8080/api/v1/listen\n'})}),"\n",(0,a.jsx)(n.p,{children:"This command returns the result of the request with output similar to the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"gas":0,"result":{"status":"success","data":3},"reqKey":"Mvn7OBApUVCck9lPzvNJjwd2gBeq6ZFEJnXTI-R0hQQ","logs":"wsATyGqckuIvlm89hhd2j4t6RMkCrcwJe_oeCYr7Th8","metaData":null,"continuation":null,"txId":1}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"poll",children:"Poll"}),"\n",(0,a.jsxs)(n.p,{children:["You can use the ",(0,a.jsx)(n.code,{children:"/poll"})," endpoint to request the transaction results for multiple transactions with a single call.\nThe ",(0,a.jsx)(n.code,{children:"/poll"})," endpoint is similar to the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint except that the connection is intended to run at an interval instead of remain open and accepts multiple request key hashes in the request and returns multiple transaction results."]}),"\n",(0,a.jsxs)(n.p,{children:["The format for calling the ",(0,a.jsx)(n.code,{children:"/poll"})," endpoint looks similar to the following with a list of the request keys you received in response from calling the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"requestKeys":["Mvn7OBApUVCck9lPzvNJjwd2gBeq6ZFEJnXTI-R0hQQ", "5Fu1m0crUk7MKL0Yyjg3gMPGcKuC0U4dx5Z5kBEQUz8",\n"18_CToCa_JXDvOPIHF-CceDw9gCpEMbpJKgLmot7I9M", "pdjiSC6IN_enbolWiuLVynXYVv1os8E9YfptltXjckU"]}\' -X POST http://localhost:8080/api/v1/poll\n'})}),"\n",(0,a.jsx)(n.p,{children:"This command returns the result of the request with output similar to the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"5Fu1m0crUk7MKL0Yyjg3gMPGcKuC0U4dx5Z5kBEQUz8":{"gas":0,"result":{"status":"success","data":3},"reqKey":"5Fu1m0crUk7MKL0Yyjg3gMPGcKuC0U4dx5Z5kBEQUz8","logs":"wsATyGqckuIvlm89hhd2j4t6RMkCrcwJe_oeCYr7Th8","metaData":null,"continuation":null,"txId":1}}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The difference between the ",(0,a.jsx)(n.code,{children:"/listen"})," and ",(0,a.jsx)(n.code,{children:"/poll"})," endpoints is subtle, but important.\nYou only use the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint if you are working with a single hash to return the result.\nYou use the ",(0,a.jsx)(n.code,{children:"/poll"})," endpoint if you want to request the results for multiple transactions."]}),"\n",(0,a.jsx)(n.h3,{id:"local",children:"Local"}),"\n",(0,a.jsxs)(n.p,{children:["You can use the ",(0,a.jsx)(n.code,{children:"/local"})," endpoint to submit queries to the blockchain without affecting the blockchain state.\nThe ",(0,a.jsx)(n.code,{children:"/local"})," endpoint is similar to the /send endpoint in that it includes a ",(0,a.jsx)(n.code,{children:"cmd"})," object with code in the request and returns the transaction result.\nHowever, the transaction you submit using the /local endpoint only runs in local server and does not update any nodes in the blockchain network."]}),"\n",(0,a.jsxs)(n.p,{children:["The format for calling the ",(0,a.jsx)(n.code,{children:"/local"})," endpoint looks similar to the following:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'pact --apireq transaction.yaml --local | curl -H "Content-Type: application/json" -d @- http://localhost:8080/api/v1/local\n'})}),"\n",(0,a.jsx)(n.p,{children:"This command returns output that's similar to the output from the /send endpoint:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"gas":0,"result":{"status":"success","data":3},"reqKey":"ch8h1qrsqpOtt9mIhwi1vGXM8QKc53OIGEpKUF3Yz80","logs":"wsATyGqckuIvlm89hhd2j4t6RMkCrcwJe_oeCYr7Th8","metaData":null,"continuation":null,"txId":null}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"/local"})," endpoint is particularly useful if you want to execute a function that doesn\u2019t need to change the state of the blockchain.\nIn general, you should use the ",(0,a.jsx)(n.code,{children:"/local"})," endpoint if you want to call functions that retrieve information from tha blockchain.\nYoi should use the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint if you want to update information stored in the blockchain or to deploy smart contracts on the blockchain."]}),"\n",(0,a.jsx)(n.h2,{id:"write-and-execute-yaml-requests",children:"Write and execute YAML requests"}),"\n",(0,a.jsx)(n.p,{children:"At this point, you have learned how to start a local Pact server and how to use the REST API endpoints to update or retrieve information from the blockchain.\nThe next step is to apply what you've learned to write your own YAML request files, convert the requests to JSON, and execute the transactions using the REST API endpoints.\nTo finish this coding project, write and execute YAML request files for the following transactions:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Deploy the ",(0,a.jsx)(n.code,{children:"helloWorld"})," contract."]}),"\n",(0,a.jsxs)(n.li,{children:["Call the ",(0,a.jsx)(n.code,{children:"say-hello"})," function."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For this exercise, add the following smart contract to create a ",(0,a.jsx)(n.code,{children:"hello-world.pact"})," file in your ",(0,a.jsx)(n.code,{children:"local-project"})," folder:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-pact",children:'(module helloWorld GOVERNANCE\n    "You can also embed comments in smart contracts by using quoted strings."\n\n    (defcap GOVERNANCE () true)\n      (defun say-hello(name:string)\n        (format "Hello, {}! ~ from Kadena" [name])\n    )\n)\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If you list the contents of the ",(0,a.jsx)(n.code,{children:"local-project"})," folder, you should see the following files and folder:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"total 24\n-rw-r--r--  1 pistolas  staff  236 Jan  7 10:11 hello-world.pact\ndrwxr-xr-x  4 pistolas  staff  128 Jan  6 16:19 http-log\n-rw-r--r--  1 pistolas  staff  279 Jan  6 15:33 pact-config.yaml\n-rw-r--r--  1 pistolas  staff  218 Jan  6 15:31 transaction.yaml\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"To write and execute YAML requests:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Generate a public and secret key pair to sign transactions using a command similar to the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pact --genkey > pistolas.keys\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This command create a ",(0,a.jsx)(n.code,{children:"pistolas.keys"})," file with a public and secret key.\nFor example:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"public: 6392582fe63bd6bb28d55f02e8ec75d0a668ba7b1065076ca1a630f470009f68\nsecret: 06fe72b8deaf96ba21734535bfb8c7e062d64b672b1c7d5179d67b7d363a3b13\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Note that, in this example, you\u2019re submitting requests to the built-in Pact server endpoints.\nIf you were deploying contracts or calling functions on the Kadena development, test, or production network, your YAML request file would need to include additional information such as the network identifier and chain identifier.\nYou can find examples of more complete YAML request files in the ",(0,a.jsx)(n.a,{href:"/guides",children:"How to"})," guides."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Write a minimal ",(0,a.jsx)(n.code,{children:"deploy-hello-world.yaml"})," file that deploys the ",(0,a.jsx)(n.code,{children:"hello-world.pact"})," file."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# Deploy \u2018Hello, world! smart contract\u2019\n\ncodeFile: hello-world.pact\ndata:\nkeyPairs:\n  - public: 6392582fe63bd6bb28d55f02e8ec75d0a668ba7b1065076ca1a630f470009f68\n    secret: 06fe72b8deaf96ba21734535bfb8c7e062d64b672b1c7d5179d67b7d363a3b13\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Deploy the contract by calling the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'pact --apireq deploy-hello-world.yaml | curl -H "Content-Type: application/json" -d @- http://localhost:8080/api/v1/send\n'})}),"\n",(0,a.jsx)(n.p,{children:"The command returns the request key.\nFor example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"requestKeys":["7tq7i9cqTdTOA4GDoBkMDtq8aXFD3xXei_R85NWsQdA"]}\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Listen for the transaction result by calling the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"listen":"7tq7i9cqTdTOA4GDoBkMDtq8aXFD3xXei_R85NWsQdA"}\' -X POST http://localhost:8080/api/v1/listen\n'})}),"\n",(0,a.jsx)(n.p,{children:"The command returns the transaction result.\nFor example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"gas":0,"result":{"status":"success","data":"Loaded module helloWorld, hash JzE-eJ5v2GdSBbcrv5eHUN0zBARx31RpiQfAXKmLD_s"},"reqKey":"7tq7i9cqTdTOA4GDoBkMDtq8aXFD3xXei_R85NWsQdA","logs":"_PWOYLBV0TVmcdaTl3FnwEeYFETdE6Cs6pvB9I4kZGA","metaData":null,"continuation":null,"txId":1}\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Write a ",(0,a.jsx)(n.code,{children:"call-say-hello.yaml"})," file that calls the ",(0,a.jsx)(n.code,{children:"say-hello"})," function."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# Call the say-hello-function\n\ncode: (helloWorld.say-hello "San Francisco, CA")\ndata:\nkeyPairs:\n  - public: 6392582fe63bd6bb28d55f02e8ec75d0a668ba7b1065076ca1a630f470009f68\n    secret: 06fe72b8deaf96ba21734535bfb8c7e062d64b672b1c7d5179d67b7d363a3b13\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Submit a transaction that calls the function by using the ",(0,a.jsx)(n.code,{children:"/send"})," endpoint."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'pact --apireq call-say-hello.yaml | curl -H "Content-Type: application/json" -d @- http://localhost:8080/api/v1/send\n'})}),"\n",(0,a.jsx)(n.p,{children:"The command returns the request key.\nFor example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"requestKeys":["5HW7PI3eqrKt4zKVTk5HdFVO0_GGmtQJr7AJwZ_xOto"]}\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Listen for the transaction result by calling the ",(0,a.jsx)(n.code,{children:"/listen"})," endpoint with the request key returned."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"listen":"5HW7PI3eqrKt4zKVTk5HdFVO0_GGmtQJr7AJwZ_xOto"}\' -X POST http://localhost:8080/api/v1/listen\n'})}),"\n",(0,a.jsx)(n.p,{children:"The command returns the transaction result.\nFor example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'{"gas":0,"result":{"status":"success","data":"Hello, San Francisco, CA! ~ from Kadena"},"reqKey":"5HW7PI3eqrKt4zKVTk5HdFVO0_GGmtQJr7AJwZ_xOto","logs":"wsATyGqckuIvlm89hhd2j4t6RMkCrcwJe_oeCYr7Th8","metaData":null,"continuation":null,"txId":4}\n'})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"review",children:"Review"}),"\n",(0,a.jsxs)(n.p,{children:["In this coding project, you created a project directory with a local server configuration file and a sample transaction YAML request file.\nYou also created a ",(0,a.jsx)(n.strong,{children:"http-log"})," folder for SQLite data from the Pact server and started the Pact server locally on port number 8080.\nAfter starting the server, you used the ",(0,a.jsx)(n.code,{children:"pact --apireq"})," command to convert the sample YAML request file into a JSON ",(0,a.jsx)(n.code,{children:"cmd"})," object and used ",(0,a.jsx)(n.code,{children:"curl"})," commands to send the ",(0,a.jsx)(n.code,{children:"cmd"})," object to the Pact server."]}),"\n",(0,a.jsx)(n.p,{children:"Now that you know how to write and submit transaction requests and how to look up transaction results and submit local queries, you can begin developing more sophisticated applications to run on the Kadena blockchain."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},64024:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/docs-pact-server-api-995209aa0225e41e01d37d0cabbb8c9c.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var s=t(96540);const a={},l=s.createContext(a);function i(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);