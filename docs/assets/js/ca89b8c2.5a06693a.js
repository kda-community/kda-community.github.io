"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[8495],{38264:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"guides/transactions/howto-safe-transfers","title":"Transfer funds safely","description":"Guarantee safe transfer operations.","source":"@site/docs/guides/transactions/safe-transfers.md","sourceDirName":"guides/transactions","slug":"/guides/transactions/howto-safe-transfers","permalink":"/docs/guides/transactions/howto-safe-transfers","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/guides/transactions/safe-transfers.md","tags":[],"version":"current","frontMatter":{"title":"Transfer funds safely","description":"Guarantee safe transfer operations.","id":"howto-safe-transfers"},"sidebar":"default","previous":{"title":"Define principal namespaces","permalink":"/docs/guides/transactions/howto-namespace-tx"},"next":{"title":"Nodes","permalink":"/docs/guides/nodes/"}}');var t=s(74848),r=s(28453);const i={title:"Transfer funds safely",description:"Guarantee safe transfer operations.",id:"howto-safe-transfers"},c="Transfer funds safely",o={},d=[{value:"Using a YAML request file and curl",id:"using-a-yaml-request-file-and-curl",level:2},{value:"Using kadena-cli commands",id:"using-kadena-cli-commands",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"transfer-funds-safely",children:"Transfer funds safely"})}),"\n",(0,t.jsx)(n.p,{children:"Transferring funds from one account to another involves a certain amount of risk because if you make a mistake in typing or copying a public key, you could lose access to the funds after they are transferred."}),"\n",(0,t.jsx)(n.p,{children:"Pact allows you to construct safe transfer transactions that guarantee:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Someone possesses the correct private key."}),"\n",(0,t.jsx)(n.li,{children:"The private key will be able to access the funds being transferred."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To provide this guarantee, you can construct a single transaction that executes two separate transfer operations.\nFor example, if Alice wants to transfer coins to Bob, she can construct the transaction with one ",(0,t.jsx)(n.code,{children:"transfer"})," operation for the desired coins plus a small additional amount to use as a test transfer.\nShe then adds a second transfer operation to return the additional coin amount that is used to verify the account owner.\nThis type of transaction must be signed by both the Alice and Bob accounts and each signature must have the appropriate ",(0,t.jsx)(n.code,{children:"coin.TRANSFER"})," capability.\nIt's especially important to construct this type of transaction if you are using the ",(0,t.jsx)(n.code,{children:"transfer-create"})," function because that is when you are defining the new account's keyset."]}),"\n",(0,t.jsx)(n.h2,{id:"using-a-yaml-request-file-and-curl",children:"Using a YAML request file and curl"}),"\n",(0,t.jsx)(n.p,{children:"Wallets with frontend interfaces can make transfers, including safe transfers, transparent for end-users.\nHowever, it's often useful to step through the process from the command-line to better understand the mechanics of how a safe transfer works."}),"\n",(0,t.jsx)(n.p,{children:"In this example:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Two key pairs are generated and saved to separate files for the transaction signers using ",(0,t.jsx)(n.code,{children:"pact --genkey > alice-keys.yaml"})," and ",(0,t.jsx)(n.code,{children:"pact --genkey > bob-keys.yaml"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"The public key for the Alice (pact-random-key) account is 3c4fc4bcd59850704ba04704730140839ac0f0b65c1ba8fe2f3f6640475f8d67."}),"\n",(0,t.jsx)(n.li,{children:"The public key for the Bob account is 3fef2d008c1ba8c319dce5b5ce5d89ba4074fb3a3b333746420619135e305678."}),"\n",(0,t.jsx)(n.li,{children:"The keyset defined in the request is used to create the Bob account, so that public key is required."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To create the transaction for a safe transfer:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Create a YAML execution request that looks similar to the following example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:'code: |-\n  (coin.transfer-create "pact-random-key" "bob" (read-keyset "ks") 2.001)\n  (coin.transfer "bob" "pact-random-key" 0.001)\ndata:\n  ks:\n    keys: ["3fef2d008c1ba8c319dce5b5ce5d89ba4074fb3a3b333746420619135e305678"]\n    pred: "keys-all"\npublicMeta:\n  chainId: "5"\n  sender: "pact-random-key"\n  gasLimit: 1200\n  gasPrice: 0.0000001\n  ttl: 7200\nnetworkId: "development"\nsigners:\n  - public: "3c4fc4bcd59850704ba04704730140839ac0f0b65c1ba8fe2f3f6640475f8d67"\n    caps:\n      - name: "coin.TRANSFER"\n        args: ["pact-random-key", "bob", 2.001]\n      - name: "coin.GAS"\n        args: []\n  - public: "3fef2d008c1ba8c319dce5b5ce5d89ba4074fb3a3b333746420619135e305678"\n    caps:\n      - name: "coin.TRANSFER"\n        args: ["bob", "pact-random-key", 0.001]\ntype: exec\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Notice that this YAML file uses the ",(0,t.jsx)(n.code,{children:"signers"})," attribute and not the ",(0,t.jsx)(n.code,{children:"keyPairs"})," attribute."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Prepare the transaction for signing by using the --unsigned command-line option:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pact --unsigned test-transfer.yaml > test-transfer-unsigned.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add the signature for the Alice account from the ",(0,t.jsx)(n.code,{children:"alice-keys.yaml"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat test-transfer-unsigned.yaml | pact add-sig alice-keys.yaml > signed-alice.yaml \n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add the signature for the Bob account from the ",(0,t.jsx)(n.code,{children:"bob-keys.yaml"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat test-transfer-unsigned.yaml | pact add-sig bob-keys.yaml > signed-bob.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Combine the signatures from both accounts to create the final transaction file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pact combine-sigs signed-alice.yaml signed-bob.yaml > tx-transfer.json\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Send the final transaction to the blockchain:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: application/json" -d "@tx-transfer.json" http://localhost:8080/chainweb/0.0/development/chain/5/pact/api/v1/send\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"using-kadena-cli-commands",children:"Using kadena-cli commands"}),"\n",(0,t.jsxs)(n.p,{children:["If you have installed the ",(0,t.jsx)(n.code,{children:"kadena-cli"})," package in your development environment, you can use the ",(0,t.jsx)(n.code,{children:"kadena tx add"})," and the ",(0,t.jsx)(n.code,{children:"safe-transfer.ktpl"})," template to construct safe transfer transactions for the development, test, or main network.\nWith interactive prompting, the template guides you to provide the information required, so it is less error-prone than manually crafting and signing a transaction request."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var a=s(96540);const t={},r=a.createContext(t);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);