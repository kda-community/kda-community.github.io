"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[4653],{13557:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"pact-5/capabilities/with-capability","title":"with-capability","description":"Use with-capability to apply the access to a specific capability to execute a body of code.","source":"@site/docs/pact-5/capabilities/with-capability.md","sourceDirName":"pact-5/capabilities","slug":"/pact-5/capabilities/with-capability","permalink":"/docs/pact-5/capabilities/with-capability","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/pact-5/capabilities/with-capability.md","tags":[],"version":"current","frontMatter":{},"sidebar":"default","previous":{"title":"require-capability","permalink":"/docs/pact-5/capabilities/require-capability"},"next":{"title":"Database functions","permalink":"/docs/pact-5/database/"}}');var n=i(74848),c=i(28453);const s={},d="with-capability",l={},o=[{value:"Basic syntax",id:"basic-syntax",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Return value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2}];function r(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"with-capability",children:"with-capability"})}),"\n",(0,n.jsxs)(t.p,{children:["Use ",(0,n.jsx)(t.code,{children:"with-capability"})," to apply the access to a specific capability to execute a body of code.\nThis function ensures that an elevated privilege\u2014defined as a capability using a ",(0,n.jsx)(t.code,{children:"defcap"})," code block\u2014is present during the execution of the provided body of code."]}),"\n",(0,n.jsxs)(t.p,{children:["You can only call the ",(0,n.jsx)(t.code,{children:"with-capability"})," function in the same module that contains the corresponding ",(0,n.jsx)(t.code,{children:"defcap"})," declaration.\nIf the token that grants permission to use the specified capability isn't found, the ",(0,n.jsx)(t.code,{children:"with-capability"}),"  evaluates the capability definition to install or grant the permission token.\nThe permission token is automatically revoked after executing the code body.\nNested ",(0,n.jsx)(t.code,{children:"with-capability"})," calls for the same permission token detect the presence of the token and execute the body without reapplying the capability."]}),"\n",(0,n.jsx)(t.p,{children:"By convention, capabilities are defined using all uppercase letters."}),"\n",(0,n.jsx)(t.h2,{id:"basic-syntax",children:"Basic syntax"}),"\n",(0,n.jsxs)(t.p,{children:["To request the grant of an acquired ",(0,n.jsx)(t.code,{children:"CAPABILITY"}),", use the following syntax:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-pact",children:"(with-capability CAPABILITY body)\n"})}),"\n",(0,n.jsx)(t.h2,{id:"arguments",children:"Arguments"}),"\n",(0,n.jsxs)(t.p,{children:["Use the following arguments to specify the name of the capability and the body of expressions to be executed using the ",(0,n.jsx)(t.code,{children:"with-capability"})," Pact function."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Argument"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"CAPABILITY"})}),(0,n.jsx)(t.td,{children:"capability"}),(0,n.jsx)(t.td,{children:"Specifies the name of the capability to grant access to."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"body"})}),(0,n.jsx)(t.td,{children:"any"}),(0,n.jsx)(t.td,{children:"Specifies the body of expressions to be executed using the granted capability."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"return-value",children:"Return value"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"with-capability"})," function returns the result of executing the provided body of code using the granted capability."]}),"\n",(0,n.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsxs)(t.p,{children:["The following example demonstrates how to use the ",(0,n.jsx)(t.code,{children:"with-capability"})," function to request access to the ",(0,n.jsx)(t.code,{children:"UPDATE-USERS"})," capability to execute the code that updates user information:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-pact",children:"(with-capability (UPDATE-USERS id) (update users id { salary: new-salary }))\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"with-capability"})," function ensures that a sensitive operation can only be executed with an elevated permission granted using the ",(0,n.jsx)(t.code,{children:"UPDATE-USERS "}),"capability."]})]})}function h(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(r,{...e})}):r(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>d});var a=i(96540);const n={},c=a.createContext(n);function s(e){const t=a.useContext(c);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),a.createElement(c.Provider,{value:t},e.children)}}}]);