"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[9759],{31985:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"reference/kadena-client","title":"Kadena TypeScript client","description":"The @kadena/client library provides a TypeScript-based API for interacting with Pact smart contracts and Chainweb nodes using frontend frameworks.","source":"@site/docs/reference/kadena-client.md","sourceDirName":"reference","slug":"/reference/kadena-client","permalink":"/docs/reference/kadena-client","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/reference/kadena-client.md","tags":[{"inline":true,"label":"TypeScript","permalink":"/docs/tags/type-script"},{"inline":true,"label":"Kadena","permalink":"/docs/tags/kadena"},{"inline":true,"label":"Kadena client","permalink":"/docs/tags/kadena-client"},{"inline":true,"label":"frontend","permalink":"/docs/tags/frontend"}],"version":"current","frontMatter":{"title":"Kadena TypeScript client","description":"The @kadena/client library provides a TypeScript-based API for interacting with Pact smart contracts and Chainweb nodes using frontend frameworks.","id":"kadena-client","tags":["TypeScript","Kadena","Kadena client","frontend"]},"sidebar":"default","previous":{"title":"scalar-mult","permalink":"/docs/pact-5/zk/scalar-mult"},"next":{"title":"Pact command-line interpreter","permalink":"/docs/reference/pact-cli"}}');var i=t(74848),c=t(28453);const a={title:"Kadena TypeScript client",description:"The @kadena/client library provides a TypeScript-based API for interacting with Pact smart contracts and Chainweb nodes using frontend frameworks.",id:"kadena-client",tags:["TypeScript","Kadena","Kadena client","frontend"]},r="Kadena TypeScript client",d={},l=[{value:"Get started with Kadena client",id:"get-started-with-kadena-client",level:2},{value:"Install",id:"install",level:3},{value:"Import",id:"import",level:3},{value:"Calling Pact modules",id:"calling-pact-modules",level:2},{value:"Basic usage",id:"basic-usage",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Examples",id:"examples",level:3},{value:"Create type definitions",id:"create-type-definitions",level:3},{value:"Creating commands",id:"creating-commands",level:2},{value:"Pact.builder.execution",id:"pactbuilderexecution",level:3},{value:"Examples",id:"examples-1",level:4},{value:"Pact.builder.continuation",id:"pactbuildercontinuation",level:3},{value:"Example",id:"example",level:4},{value:"addSigner",id:"addsigner",level:3},{value:"Examples",id:"examples-2",level:4},{value:"addData",id:"adddata",level:3},{value:"Examples",id:"examples-3",level:4},{value:"addKeyset",id:"addkeyset",level:3},{value:"Examples",id:"examples-4",level:4},{value:"setMeta",id:"setmeta",level:3},{value:"Examples",id:"examples-5",level:4},{value:"setNonce",id:"setnonce",level:3},{value:"Examples",id:"examples-6",level:4},{value:"setNetworkId",id:"setnetworkid",level:3},{value:"Examples",id:"examples-7",level:4},{value:"Creating transactions",id:"creating-transactions",level:2},{value:"Examples",id:"examples-8",level:3},{value:"getCommand",id:"getcommand",level:3},{value:"Examples",id:"examples-9",level:4},{value:"initialPactCommand",id:"initialpactcommand",level:3},{value:"Examples",id:"examples-10",level:4},{value:"Signing transactions",id:"signing-transactions",level:2},{value:"Sign function interface",id:"sign-function-interface",level:3},{value:"Single transaction",id:"single-transaction",level:4},{value:"List of transactions",id:"list-of-transactions",level:4},{value:"Chainweaver",id:"chainweaver",level:3},{value:"Examples",id:"examples-11",level:4},{value:"WalletConnect",id:"walletconnect",level:3},{value:"Wallet Connect sign method",id:"wallet-connect-sign-method",level:4},{value:"Examples",id:"examples-12",level:5},{value:"Wallet Connect quicksign method",id:"wallet-connect-quicksign-method",level:4},{value:"Examples",id:"examples-13",level:5},{value:"EckoWallet",id:"eckowallet",level:3},{value:"isInstalled",id:"isinstalled",level:4},{value:"isConnected",id:"isconnected",level:4},{value:"connect",id:"connect",level:4},{value:"createEckoWalletSign",id:"createeckowalletsign",level:4},{value:"Examples",id:"examples-14",level:5},{value:"createEckoWalletQuicksign",id:"createeckowalletquicksign",level:4},{value:"Examples",id:"examples-15",level:5},{value:"Sign with a public and secret key pair",id:"sign-with-a-public-and-secret-key-pair",level:3},{value:"Examples",id:"examples-16",level:4},{value:"addSignatures",id:"addsignatures",level:3},{value:"Examples",id:"examples-17",level:4},{value:"Communicating with the network",id:"communicating-with-the-network",level:2},{value:"createClient",id:"createclient",level:3},{value:"Examples",id:"examples-18",level:4},{value:"Submitting transactions",id:"submitting-transactions",level:2},{value:"Getting transaction results",id:"getting-transaction-results",level:2},{value:"getStatus",id:"getstatus",level:3},{value:"pollStatus",id:"pollstatus",level:3},{value:"Return value",id:"return-value",level:4},{value:"Examples",id:"examples-19",level:4},{value:"listen",id:"listen",level:3},{value:"pollOne",id:"pollone",level:3},{value:"Reading data",id:"reading-data",level:2},{value:"local",id:"local",level:3},{value:"Examples",id:"examples-20",level:4},{value:"dirtyRead",id:"dirtyread",level:3},{value:"Examples",id:"examples-21",level:4},{value:"preflight",id:"preflight",level:3},{value:"signatureVerification",id:"signatureverification",level:3},{value:"runPact",id:"runpact",level:3},{value:"Examples",id:"examples-22",level:4},{value:"Requesting simple payment verification (spv)",id:"requesting-simple-payment-verification-spv",level:3},{value:"createSPV",id:"createspv",level:3},{value:"pollCreateSPV",id:"pollcreatespv",level:3},{value:"Examples",id:"examples-23",level:4},{value:"Functional programming to compose Pact commands",id:"functional-programming-to-compose-pact-commands",level:2},{value:"Importing functions",id:"importing-functions",level:3},{value:"composePactCommand",id:"composepactcommand",level:3},{value:"Examples",id:"examples-24",level:4},{value:"execution",id:"execution",level:3},{value:"continuation",id:"continuation",level:3},{value:"addSigner",id:"addsigner-1",level:3},{value:"addData",id:"adddata-1",level:3},{value:"addKeyset",id:"addkeyset-1",level:3},{value:"setMeta",id:"setmeta-1",level:3},{value:"etNonce",id:"etnonce",level:3},{value:"setNetworkId",id:"setnetworkid-1",level:3},{value:"createTransaction",id:"createtransaction",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"kadena-typescript-client",children:"Kadena TypeScript client"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@kadena/client"})," library provides a TypeScript-based API for interacting with smart contracts and Chainweb nodes on the Kadena network. The library includes modules to help you perform the following types of common tasks:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create commands"}),"\n",(0,i.jsx)(n.li,{children:"Sign transactions"}),"\n",(0,i.jsx)(n.li,{children:"Submit transactions"}),"\n",(0,i.jsx)(n.li,{children:"Query transaction results"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If you only need to interact with the ",(0,i.jsx)(n.code,{children:"coin"})," contract, you can use the functions in the ",(0,i.jsx)(n.code,{children:"@kadena/client-utils/coin"})," library instead of the ",(0,i.jsx)(n.code,{children:"@kadena/client"})," library for a simpler API."]}),"\n",(0,i.jsx)(n.h2,{id:"get-started-with-kadena-client",children:"Get started with Kadena client"}),"\n",(0,i.jsxs)(n.p,{children:["One of the most important features of the Kadena client library is that helps you create ",(0,i.jsx)(n.strong,{children:"command"})," objects with the correct structure. You can then construct and sign transactions to send the command to the blockchain network. After you submit a transaction for processing, you can use the Kadena client to listen for the transaction results."]}),"\n",(0,i.jsx)(n.p,{children:"The following example illustrates the structure of a command object:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface ICommand {\n  cmd: string; // stringified command of <IPactCommand> type\n  hash: string; // cmd-hash\n  sigs: Array<{ sig: string } | undefined>; // array of signatures\n}\n\ninterface IPactCommand {\n  payload:\n    | {\n        exec: {\n          code: string;\n          data: Record<string, unknown>;\n        };\n      }\n    | {\n        cont: {\n          pactId: string;\n          step: number;\n          rollback: boolean;\n          data?: Record<string, unknown>;\n          proof?: string | null;\n        };\n      };\n  meta: {\n    chainId: ChainId; // "0" to  "19"\n    sender: string;\n    gasLimit: number;\n    gasPrice: number;\n    ttl: number;\n    creationTime: number;\n  };\n  signers: Array<{\n    pubKey: string;\n    address?: string;\n    scheme?: SignerScheme;\n    clist?: ICap[];\n  }>;\n  verifiers?: Array<{\n    name: string;\n    proof: PactValue;\n    clist?: ICap[];\n  }>;\n  networkId: string;\n  nonce: string;\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If your use case is simple enough that you can create the JSON directly, you don't need to use the functions in the Kadena client library. You can also use some parts of the library, without using everything. If you prefer to learn from code, check out the ",(0,i.jsx)(n.a,{href:"https://github.com/kadena-community/kadena.js/tree/main/packages/libs/client-examples",children:"client-examples"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"install",children:"Install"}),"\n",(0,i.jsxs)(n.p,{children:["You can download and install the ",(0,i.jsx)(n.code,{children:"@kadena/client"})," library with the following command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @kadena/client\n"})}),"\n",(0,i.jsx)(n.h3,{id:"import",children:"Import"}),"\n",(0,i.jsxs)(n.p,{children:["After you install the library, you can import ",(0,i.jsx)(n.code,{children:"@kadena/client"})," functions into a TypeScript or JavaScript program with the following statement:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { createClient, Pact } from '@kadena/client';\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The library also exports functional programming utilities under ",(0,i.jsx)(n.code,{children:"@kadena/client/fp"})," for more flexibility when using a functional programming approach. To import functional programming utilities, include the following statement in your TypeScript or JavaScript program."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { composePactCommand } from '@kadena/client/fp';\n"})}),"\n",(0,i.jsx)(n.h2,{id:"calling-pact-modules",children:"Calling Pact modules"}),"\n",(0,i.jsxs)(n.p,{children:["Interacting with the Kadena blockchain network and Chainweb nodes is mostly a matter of calling smart contract functions. From the client perspective, you need to write Pact code in a string and pass it to the ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.exec.code"})," interface. Without code completion and validation, writing the Pact code string manually is error-prone and vulnerable to code injection."]}),"\n",(0,i.jsxs)(n.p,{children:["To simplify the process, you can use ",(0,i.jsx)(n.code,{children:"Pact.modules"})," to help you:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Write type-safe functions."}),"\n",(0,i.jsx)(n.li,{children:"Perform Pact type conversion."}),"\n",(0,i.jsx)(n.li,{children:"Avoid code injection."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You can skip this part of the client library if your code is just a simple ",(0,i.jsx)(n.strong,{children:"constant"})," string."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage",children:"Basic usage"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"Pact.modules"})," with the following format:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Pact } from `@kadena/client`;\n\nPact.modules[`${namespace}.${moduleName}`][functionName](...args);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"...args"}),(0,i.jsx)(n.td,{children:"PactValue[]"}),(0,i.jsx)(n.td,{children:"List of arguments."})]})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// the pseudo code of PactValue type\ntype PactValue =\n  | string\n  | number\n  | boolean\n  | Date\n  | { int: string }\n  | { decimal: string }\n  | PactValue[]\n  | Record<string, PactValue>;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["To create the code for the ",(0,i.jsx)(n.code,{children:"coin.transfer"})," function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { Pact } from `@kadena/client`;\n\nconst code = Pact.modules.coin.transfer("alice", "bob", { decimal: \'1.1\' });\n// code === \'(coin.transfer "alice" "bob" 1.1)\'\n\n'})}),"\n",(0,i.jsxs)(n.p,{children:["To create the code for the ",(0,i.jsx)(n.code,{children:"free.my-module.my-function"})," function that converts a list, objects, and date to valid Pact code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { Pact } from `@kadena/client`;\n\nconst code = Pact.modules["free.my-module"].["my-function"](["first", { time: new Date() }]);\n// code === \'(free.my-module.my-function ["first" {"time" : (time "2023-07-20T14:55:11Z")} ])\'\n\n'})}),"\n",(0,i.jsx)(n.h3,{id:"create-type-definitions",children:"Create type definitions"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/@kadena/pactjs-cli",children:"@kadena/pactjs-cli"})," to create the type definitions for the Pact module you use. After you generate the type definitions file, the code editor in your development environment should provide code completion for functions and capabilities."]}),"\n",(0,i.jsxs)(n.p,{children:["To create a type definition file for the ",(0,i.jsx)(n.code,{children:"coin"})," contract:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx @kadena/pactjs-cli contract-generate --contract coin --api https://api.testnet.chainweb.com/chainweb/0.0/testnet04/chain/0/pact;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-commands",children:"Creating commands"}),"\n",(0,i.jsxs)(n.p,{children:["As illustrated in ",(0,i.jsx)(n.a,{href:"#get-started-with-kadena-client",children:"Get started with Kadena client"}),", a command is a JSON object with three keys: ",(0,i.jsx)(n.code,{children:"cmd"}),", ",(0,i.jsx)(n.code,{children:"hash"}),", and ",(0,i.jsx)(n.code,{children:"sig"}),". There are two types of commands:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#execution",children:"Execution"})," commands"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#continuation",children:"Continuation"})," commands"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You can create the JSON object without using the Kadena client library. However, using the library and ",(0,i.jsx)(n.code,{children:"Pact.builder"})," to create the command object simplifies the process."]}),"\n",(0,i.jsx)(n.h3,{id:"pactbuilderexecution",children:"Pact.builder.execution"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"Pact.builder"})," to create an execution command object, ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.exec.code"}),". Most transactions are execution (exec) commands that complete in a single step. Execution commands are also be used for the first step in transactions that are ",(0,i.jsx)(n.code,{children:"defpact"})," multi-step transactions."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder.execution(...codes): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"...codes"}),(0,i.jsx)(n.td,{children:"string[]"}),(0,i.jsx)(n.td,{children:"List of input for a function."})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-1",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To use strings for the command code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const builder: IBuilder = Pact.builder.execution(\n  `(coin.transfer "alice" "bob" 1.1)`,\n);\n'})}),"\n",(0,i.jsxs)(n.p,{children:["To use ",(0,i.jsx)(n.code,{children:"Pact.modules"})," for the command code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const builder: IBuilder = Pact.builder.execution(\n  Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' }),\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pactbuildercontinuation",children:"Pact.builder.continuation"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"Pact.builder"})," to create a continuation command object, ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.cont"}),", which is the type of transaction used for additional steps of ",(0,i.jsx)(n.code,{children:"defpact"})," multi-step transactions."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder.continuation(contData): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"contData"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsxs)(n.td,{children:["Continuation data includes a unique ",(0,i.jsx)(n.code,{children:"defpact"})," identifier, whether the transactions rolls back a previous transaction, the transaction step that the continuation represents with the first step being step 0, and a simple payment verification proof if one is generated by calling the ",(0,i.jsx)(n.code,{children:"/spv"})," endpoint."]})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"contData"})," object consists of the following properties:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:"{\n    pactId: string,\n    rollback: boolean,\n    step: number,\n    data?: Record<string, any>,\n    proof?: null \\| string\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"coin.cross-chain"})," function is a ",(0,i.jsx)(n.code,{children:"defpact"})," multi-step transaction that burns tokens in the source chain and mints tokens in the destination chain. After the first step completes successfully, you can call the second step by using the ",(0,i.jsx)(n.code,{children:"continuation"})," command object."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const builder: IBuilder = Pact.builder.continuation({\n  pactId,\n  rollback: false,\n  step: 1,\n  proof: spvProof,\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"addsigner",children:"addSigner"}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.code,{children:"addSigner"})," method to add public keys and capabilities for a transaction signer to the command. You can call ",(0,i.jsx)(n.code,{children:"addSigner"})," multiple times to add multiple signers to the transaction. Later, the Chainweb node checks whether all required signers have signed the transaction or not."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder.execution(...codes).addSigner(signerOrSignersList, capabilityCallback): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"signer"}),(0,i.jsx)(n.td,{children:"string or object"}),(0,i.jsx)(n.td,{children:"Public key of the signer or the signer object (this can also be a list of signers if all of the signers sign for the same capabilities)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"capabilityCallback"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"(signFor) => ReturnType<signFor>[]"})}),(0,i.jsx)(n.td,{children:"Allows you to scope what the signer is signing for to a specific list of capabilities."})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"{ pubKey: string; scheme?: 'ED25519' \\| 'ETH' \\| 'WebAuthn'; address?: string;} \\| ISigner[]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Chainweb supports the following signature schemes for public keys:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ED25519"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"WebAuthn"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ETH"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The default signature scheme is ",(0,i.jsx)(n.code,{children:"ED25519"}),". You can pass just the public key if the signature scheme is ",(0,i.jsx)(n.code,{children:"ED25519"}),". If the scheme is not ",(0,i.jsx)(n.code,{children:"ED25519"}),", you must pass a signer object that includes the pubic key and the signature scheme."]}),"\n",(0,i.jsx)(n.h4,{id:"examples-2",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["To add a signer public key for a ",(0,i.jsx)(n.code,{children:"coin"})," contract transfer:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// ED25519 key\nconst alicePublicKey =\n  'e7f4da07b1d200f6e45aa6492afed6819297a97563859a5f0df9c54f5abd4aab';\n\nPact.builder\n  .execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' }))\n  .addSigner(alicePublicKey, (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To add a signer that uses the ",(0,i.jsx)(n.code,{children:"WebAuthn"})," scheme:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' }))\n  .addSigner({ pubKey: webAuthnPublicKey, scheme: 'WebAuthn' }, (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]);\n"})}),"\n",(0,i.jsx)(n.p,{children:"To add a list of signers with no capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution('(free.my-module.my-function)')\n  .addSigner([\n    'ED25519_publicKey',\n    { pubKey: 'WebAuthn_publicKey', scheme: 'WebAuthn' },\n  ]);\n"})}),"\n",(0,i.jsx)(n.p,{children:"To add a list of signers with similar capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' }))\n  // e.g., Alice's account is guarded by two keys\n  .addSigner(['first_publicKey', 'second_publicKey'], (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]);\n\nconst equivalentPactCommand = {\n  payload: {\n    exec: {\n      code: '(coin.transfer \"alice\" \"bob\" 1.1 )',\n      data: {},\n    },\n  },\n  signers: [\n    {\n      pubKey: 'first_publicKey',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.TRANSFER', args: ['alice', 'bob', { decimal: '1.1' }] },\n      ],\n    },\n    {\n      pubKey: 'second_publicKey',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.TRANSFER', args: ['alice', 'bob', { decimal: '1.1' }] },\n      ],\n    },\n  ],\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"adddata",children:"addData"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"addData"})," to add data to the ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.exec.data"})," or ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.cont.data"})," command. This data is readable in the smart contract later. You can also use this data in the code you set in the command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(...codes)\n  .addData(key, value): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"key"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"The key associated with the data you're sending."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"value"}),(0,i.jsx)(n.td,{children:"PactValue"}),(0,i.jsx)(n.td,{children:"Data that you want to send."})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-3",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To transfer with parameters in data:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'Pact.builder\n  .execution(\'(coin.transfer (read-string "sender") (read-string "receiver") 1.1)\')\n  .addData("sender", sender)\n  .addData("receiver", sender): IBuilder\n'})}),"\n",(0,i.jsxs)(n.p,{children:["To use ",(0,i.jsx)(n.code,{children:"transfer-create"})," and send the receiver guard:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(\n    '(coin.transfer-create \"alice\" \"bob\" (read-keyset \"bob-guard\") 1.1)',\n  )\n  .addData('bob-guard', {\n    keys: ['bob-public-key'],\n    pred: 'keys-all',\n  });\n"})}),"\n",(0,i.jsx)(n.h3,{id:"addkeyset",children:"addKeyset"}),"\n",(0,i.jsxs)(n.p,{children:["Because keysets are often included as data in commands, you can use the ",(0,i.jsx)(n.code,{children:"addKeyset"})," method as an alternative to the ",(0,i.jsx)(n.code,{children:"addData"})," method to add a keyset to a command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(...codes)\n  .addKeyset(name, pred, ...keys): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"name"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"The name associated with the keyset."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pred"}),(0,i.jsx)(n.td,{children:'"keys-all"|"keys-2"| "keys-any" | string'}),(0,i.jsx)(n.td,{children:"One of the built-in predicate functions or a user-defined predicate function."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"...keys"}),(0,i.jsx)(n.td,{children:"...string[]"}),(0,i.jsx)(n.td,{children:"List of public keys in the keyset."})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-4",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["To use ",(0,i.jsx)(n.code,{children:"readKeyset"})," and ",(0,i.jsx)(n.code,{children:"addKeyset"})," helper functions with transfer-create:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(\n    Pact.modules.coin['transfer-create'](\n      'alice',\n      'bob',\n      readKeyset('bob-guard'),\n      { decimal: '1.1' },\n    ),\n  )\n  .addKeyset('bob-guard', 'keys-all', 'bob-public-key');\n"})}),"\n",(0,i.jsx)(n.p,{children:"To use transfer-create as string code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(\n    '(coin.transfer-create \"alice\" \"bob\" (readKeyset \"bob-guard\") 1.1)',\n  )\n  .addKeyset('bob-guard', 'keys-all', 'bob-public-key');\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setmeta",children:"setMeta"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"setMeta"})," to add metadata to a command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder\n  .execution(...codes)\n  .setMeta(meta): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"meta"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Add a metadata object to the command."})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"meta"})," object consists of the following properties:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Default value"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"chainId"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"0"'})," to ",(0,i.jsx)(n.code,{children:'"19"'})]}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"undefined"})}),(0,i.jsx)(n.td,{children:"Chain identifier for the chain. Valid values are from 0 to 19."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"senderAccount"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"undefined"})}),(0,i.jsx)(n.td,{children:"The account address that you want to pay transaction fees from."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"gasLimit"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"number"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"2500"})}),(0,i.jsx)(n.td,{children:"Maximum units of gas that you want to allow to be deducted when running the transaction."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"gasPrice"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"number"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"1.0e-8"})}),(0,i.jsx)(n.td,{children:"Price of each gas unit based on KDA (e.g., 0.0000001)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ttl"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"number"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"28800"})}),(0,i.jsx)(n.td,{children:"Time-to-live (ttl) for the transaction to be valid in seconds. The default value is 8 hours."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"creationTime"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"number"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Date.now() / 1000"})}),(0,i.jsx)(n.td,{children:"Transaction creation time in seconds."})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-5",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'Pact.builder\n  .execution(\'(coin.transfer "alice" "bob" 1.1)\')\n  // "bob is paying gas fee"\n  .setMeta({ chainId: "02", senderAccount: "bob" }): IBuilder;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setnonce",children:"setNonce"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"setNonce"})," function to set ",(0,i.jsx)(n.code,{children:"IPactCommand.nonce"})," to a custom nonce for the transaction. Otherwise, the nonce is set using the ",(0,i.jsx)(n.code,{children:"kjs:${timestamp}"})," function."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder.execution(code).setNonce(nonce): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"nonce"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Custom nonce for the transaction."})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-6",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'Pact.builder\n  .execution(\'(coin.transfer "alice" "bob" 1.1)\')\n  // "bob is paying gas fee"\n  .setNonce("a-custom-nonce"): IBuilder;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setnetworkid",children:"setNetworkId"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"setNetworkId"})," to set ",(0,i.jsx)(n.code,{children:"IPactCommand.network"})," to specify the network for the transaction."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"Pact.builder.execution(code).setNetworkId(networkId): IBuilder\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"networkId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:'Network identifier, for example, "mainnet01" or "testnet04".'})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-7",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'Pact.builder\n  .execution(\'(coin.transfer "alice" "bob" 1.1)\')\n  // "bob is paying gas fee"\n  .setNetworkId("testnet04"): IBuilder;\n'})}),"\n",(0,i.jsx)(n.h2,{id:"creating-transactions",children:"Creating transactions"}),"\n",(0,i.jsxs)(n.p,{children:["After you set all parts of the command, you can create the transaction object by calling the ",(0,i.jsx)(n.code,{children:"createTransaction"})," method. This method adds all of the default values to the command, converts ",(0,i.jsx)(n.code,{children:"cmd"})," to a string, and adds the hash. You must add signatures to the transaction object using a wallet to submit the transaction to the blockchain. For information about adding signatures from a wallet, see ",(0,i.jsx)(n.a,{href:"#signing-transactions",children:"Signing transactions"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const transaction: IUnsignedCommand = Pact.builder\n  .execution(code)\n  .createTransaction(); // : { cmd:"stringified-command" , hash:"command-hash" , sig: [] };\n'})}),"\n",(0,i.jsx)(n.h3,{id:"examples-8",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const transaction = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor(\'coin.GAS\'),\n    signFor(\'coin.TRANSFER\', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: \'0\', senderAccount })\n  .setNetworkId(NETWORK_ID)\n  .createTransaction();\n\nconst output = {\n  cmd: \'{"payload":{"exec":{"code":"(coin.transfer \\\\"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46\\\\" \\\\"k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11\\\\" 1.0)","data":{}}},"nonce":"kjs:nonce:1711376792115","signers":[{"pubKey":"dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","scheme":"ED25519","clist":[{"name":"coin.GAS","args":[]},{"name":"coin.TRANSFER","args":["k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11",{"decimal":"1"}]}]}],"meta":{"gasLimit":2500,"gasPrice":1e-8,"sender":"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","ttl":28800,"creationTime":1711376792,"chainId":"0"},"networkId":"testnet04"}\',\n  hash: \'xYePm_YgO6-T9yIlCZWzOt2s4CkZcQwqWx9Iu5tVSLI\',\n  sigs: [undefined],\n};\n'})}),"\n",(0,i.jsx)(n.h3,{id:"getcommand",children:"getCommand"}),"\n",(0,i.jsxs)(n.p,{children:["If you prefer to have the non-stringified version of the command, you can use ",(0,i.jsx)(n.code,{children:"getCommand"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const transaction: IPactCommand = Pact.builder.execution(code).getCommand();\n"})}),"\n",(0,i.jsx)(n.h4,{id:"examples-9",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const command = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor('coin.GAS'),\n    signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: '0', senderAccount })\n  .setNetworkId(NETWORK_ID)\n  .getCommand();\n\nconst output = {\n  payload: {\n    exec: {\n      code: '(coin.transfer \"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46\" \"k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11\" 1.0)',\n      data: {},\n    },\n  },\n  nonce: 'kjs:nonce:1711448853909',\n  signers: [\n    {\n      pubKey:\n        'dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.GAS', args: [] },\n        {\n          name: 'coin.TRANSFER',\n          args: [\n            'k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n            'k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11',\n            { decimal: '1' },\n          ],\n        },\n      ],\n    },\n  ],\n  meta: {\n    gasLimit: 2500,\n    gasPrice: 1e-8,\n    sender:\n      'k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n    ttl: 28800,\n    creationTime: 1711448853,\n    chainId: '0',\n  },\n  networkId: 'testnet04',\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"initialpactcommand",children:"initialPactCommand"}),"\n",(0,i.jsxs)(n.p,{children:["If you find yourself repeating certain parts of methods for different commands, you can create your own command builder by using the ",(0,i.jsx)(n.code,{children:"createTransactionBuilder"})," function. This function allows you to set all of the default values once and then reuse them in ",(0,i.jsx)(n.code,{children:"createTransaction"}),"."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"initial"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Partial<IPactCommand>"})}),(0,i.jsx)(n.td,{children:"The initial Pact command values that you want to reuse."})]})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const builder: ITransactionBuilder =\n  createTransactionBuilder(initialPactCommand);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"examples-10",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To create a transaction builder with network and chain already set:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Pre-configure the builder\nexport const txBuilder = createTransactionBuilder({ networkId: \"mainnet01\", meta: { chainId: \"1\" } });\n\n// Then somewhere in the code\n\nconst command = txBuilder\n    .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n    .addSigner(senderKey, (signFor) => [\n      signFor('coin.GAS'),\n      signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n    ])\n    .setMeta({ senderAccount })\n\nconst output = const output = {\n  payload: {\n    exec: {\n      code: '(coin.transfer \"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46\" \"k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11\" 1.0)',\n      data: {},\n    },\n  },\n  nonce: 'kjs:nonce:1711448853909',\n  signers: [\n    {\n      pubKey:\n        'dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.GAS', args: [] },\n        {\n          name: 'coin.TRANSFER',\n          args: [\n            'k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n            'k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11',\n            { decimal: '1' },\n          ],\n        },\n      ],\n    },\n  ],\n  meta: {\n    gasLimit: 2500,\n    gasPrice: 1e-8,\n    sender:\n      'k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46',\n    ttl: 28800,\n    creationTime: 1711448853,\n    // Default value\n    chainId: '1',\n  },\n  // Default value\n  networkId: 'mainnet01',\n};\n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"signing-transactions",children:"Signing transactions"}),"\n",(0,i.jsx)(n.p,{children:"After creating the command, you need to sign it using the appropriate private keys. The signing process is usually managed with a wallet. Kadena has two protocols for signing transactions, each serving different purposes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sign API"}),": This API allows users to send their sign requests to the wallet. The wallet is then responsible for creating and signing the transaction simultaneously. With this approach, the wallet has more freedom, making it more suitable for simple transactions."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Quicksign"}),": This API is designed to give dApps full control over the command, with the wallet only responsible for adding signatures. This is the recommended method if you are using the command builder from this library."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Wallets typically have their own API for communicating with applications. You can use the API provided by the wallet, or, depending on the wallet, use one of the wallet-specific wrapper functions for convenience."}),"\n",(0,i.jsx)(n.h3,{id:"sign-function-interface",children:"Sign function interface"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"sign"})," function can be used two ways: If you pass a single transaction to the function, it returns the single signed (or partially signed) transaction. If you pass a list of transactions to the function, it returns the list of signed (or partially signed) transactions."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ISignFunction {\n  (transaction: IUnsignedCommand): Promise<ICommand | IUnsignedCommand>;\n  (\n    transactionList: IUnsignedCommand[],\n  ): Promise<Array<ICommand | IUnsignedCommand>>;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"single-transaction",children:"Single transaction"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tx"}),(0,i.jsx)(n.td,{children:"IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The transaction to be signed."})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"list-of-transactions",children:"List of transactions"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tsList"}),(0,i.jsx)(n.td,{children:"IUnsignedCommand[]"}),(0,i.jsx)(n.td,{children:"List of the transactions to be signed."})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"chainweaver",children:"Chainweaver"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"createSignWithChainweaver"})," to sign a transaction using Chainweaver. It's a factory function that returns the actual sign function."]}),"\n",(0,i.jsxs)(n.p,{children:["This function uses the ",(0,i.jsx)(n.code,{children:"quicksign"})," protocol."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createSignWithChainweaver(options:{ host?: string }): ISignFunction\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"option"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsxs)(n.td,{children:["option including host URL default ",(0,i.jsx)(n.code,{children:"{ host: 'http://127.0.0.1:9467' }"})]})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-11",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To sign one transaction using Chainweaver:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithChainweaver = createSignWithChainweaver();\n\nconst transaction = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor('coin.GAS'),\n    signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: '0', senderAccount })\n  .setNetworkId(NETWORK_ID)\n  .createTransaction();\n\nconst signedTx = signWithChainweaver(transaction);\n"})}),"\n",(0,i.jsx)(n.p,{children:"To sign two transactions using Chainweaver:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithChainweaver = createSignWithChainweaver();\n\nconst [txOneSigned, txTwoSigned] = signWithChainweaver([txOne, txTwo]);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"walletconnect",children:"WalletConnect"}),"\n",(0,i.jsxs)(n.p,{children:["The WalletConnect protocol and helper functions are based on ",(0,i.jsx)(n.a,{href:"https://github.com/kadena-io/KIPs/blob/master/kip-0017.md",children:"KIP-017"}),". You must use the WalletConnect protocol to create a walletConnect client and session before you can use the helper functions to sign transactions."]}),"\n",(0,i.jsx)(n.h4,{id:"wallet-connect-sign-method",children:"Wallet Connect sign method"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"createWalletConnectSign"})," function returns the ",(0,i.jsx)(n.code,{children:"sign"})," function using the ",(0,i.jsx)(n.code,{children:"sign"})," protocol."]}),"\n",(0,i.jsxs)(n.p,{children:["The return object might contain different data than what you would pass from the transaction builder because the ",(0,i.jsx)(n.code,{children:"sign"})," protocol lets the wallet create the transaction."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createWalletConnectSign(client, session, walletConnectChainId): (transaction: IUnsignedCommand): Promise<ICommand | IUnsignedCommand>\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"client"}),(0,i.jsx)(n.td,{children:"Client"}),(0,i.jsxs)(n.td,{children:["The ",(0,i.jsx)(n.code,{children:"wallet-connect"})," client object."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"session"}),(0,i.jsx)(n.td,{children:"SessionTypes.Struct"}),(0,i.jsx)(n.td,{children:"The wallet-connect session object."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"networkId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["The network identifier, for example, ",(0,i.jsx)(n.code,{children:"mainnet01"})," or ",(0,i.jsx)(n.code,{children:"testnet04"}),". The identifier can include the ",(0,i.jsx)(n.code,{children:"kadena:"})," prefix, for example, ",(0,i.jsx)(n.code,{children:"kadena:mainnet01"}),"."]})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"examples-12",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithWalletConnect = createWalletConnectSign(\n  client,\n  session,\n  'mainnet01',\n);\n\nconst signedTx = signWithWalletConnect(tx);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"wallet-connect-quicksign-method",children:"Wallet Connect quicksign method"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"createWalletConnectQuicksign"})," function returns the ",(0,i.jsx)(n.code,{children:"sign"})," function using the",(0,i.jsx)(n.code,{children:"quicksign"})," protocol."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createWalletConnectQuicksign(client, session, walletConnectChainId): ISignFunction\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"client"}),(0,i.jsx)(n.td,{children:"Client"}),(0,i.jsxs)(n.td,{children:["The ",(0,i.jsx)(n.code,{children:"wallet-connect"})," client object."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"session"}),(0,i.jsx)(n.td,{children:"SessionTypes.Struct"}),(0,i.jsx)(n.td,{children:"The wallet-connect session object."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"networkId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["The network identifier, for example, ",(0,i.jsx)(n.code,{children:"mainnet01"})," or ",(0,i.jsx)(n.code,{children:"testnet04"}),". The identifier can include the ",(0,i.jsx)(n.code,{children:"kadena:"})," prefix, for example, ",(0,i.jsx)(n.code,{children:"kadena:mainnet01"}),"."]})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"examples-13",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const quicksignWithWalletConnect = createWalletConnectQuicksign(\n  client,\n  session,\n  'mainnet01',\n);\n\nconst signedTx = quicksignWithWalletConnect(tx);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"eckowallet",children:"EckoWallet"}),"\n",(0,i.jsxs)(n.p,{children:["The following functions provide the ",(0,i.jsx)(n.code,{children:"sign"})," and ",(0,i.jsx)(n.code,{children:"quicksign"})," protocols for EckoWallet to return a ",(0,i.jsx)(n.code,{children:"sign"})," function and other properties:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { isInstalled, isConnected, connect } = createEckoWalletSign();\nconst { isInstalled, isConnected, connect } = createEckoWalletQuicksign();\n"})}),"\n",(0,i.jsx)(n.h4,{id:"isinstalled",children:"isInstalled"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"isInstalled"})," to check if the EckoWallet extension is installed in the browser."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"isInstalled(): boolean\n"})}),"\n",(0,i.jsx)(n.h4,{id:"isconnected",children:"isConnected"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"isConnected"})," to check if the application is already connected to EckoWallet."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"isConnected(): Promise<boolean>\n"})}),"\n",(0,i.jsx)(n.h4,{id:"connect",children:"connect"}),"\n",(0,i.jsxs)(n.p,{children:["You can use ",(0,i.jsx)(n.code,{children:"connect"})," to send a connection request to EckoWallet."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"connect(networkId: string): Promise<boolean>\n"})}),"\n",(0,i.jsx)(n.h4,{id:"createeckowalletsign",children:"createEckoWalletSign"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"createEckoWalletSign"})," function uses the ",(0,i.jsx)(n.code,{children:"sign"})," protocol to communicate with EckoWallet. The return object might contain different data than what you would pass from the transaction builder because the ",(0,i.jsx)(n.code,{children:"sign"})," protocol lets the wallet create the transaction."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createEckoWalletSign(options:{ host?: string }): (transaction: IUnsignedCommand): Promise<ICommand | IUnsignedCommand>\n"})}),"\n",(0,i.jsx)(n.h5,{id:"examples-14",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To sign a transaction using EckoWallet:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithEckoWallet = createEckoWalletSign();\n\n// the wallet will create the completed one\nconst partialTx = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor('coin.GAS'),\n    signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: '0' })\n  .setNetworkId(NETWORK_ID)\n  .createTransaction();\n\nconst signedTx = signWithEckoWallet(partialTx);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"createeckowalletquicksign",children:"createEckoWalletQuicksign"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"createEckoWalletQuicksign"})," function uses the ",(0,i.jsx)(n.code,{children:"quicksign"})," protocol to communicate with EckoWallet."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createEckoWalletQuicksign(options:{ host?: string }): ISignFunction\n"})}),"\n",(0,i.jsx)(n.h5,{id:"examples-15",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["To sign one transaction using the ",(0,i.jsx)(n.code,{children:"quicksign"})," protocol and EckoWallet:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const quicksignWithEckoWallet = createEckoWalletQuicksign();\n\nconst tx = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor('coin.GAS'),\n    signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: '0', senderAccount })\n  .setNetworkId(NETWORK_ID)\n  .createTransaction();\n\nconst signedTx = quicksignWithEckoWallet(partialTx);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To sign two transactions using the ",(0,i.jsx)(n.code,{children:"quicksign"})," protocol and EckoWallet:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const quicksignWithEckoWallet = createEckoWalletQuicksign();\n\nconst [txOneSigned, txTwoSigned] = quicksignWithEckoWallet([txOne, txTwo]);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sign-with-a-public-and-secret-key-pair",children:"Sign with a public and secret key pair"}),"\n",(0,i.jsxs)(n.p,{children:["If you have a secret key in a safe environment\u2014for example, a server environment or CI test pipeline\u2014you can sign transactions with the ",(0,i.jsx)(n.code,{children:"createSignWithKeypair"})," function to returns the ",(0,i.jsx)(n.code,{children:"sign"})," function."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"IKeyPair"})," interface is defined as followis:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface IKeyPair {\n  publicKey: string;\n  secretKey: string;\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createSignWithKeypair(keyOrKeys:IKeyPair | IKeyPair[]): ISignFunction\n"})}),"\n",(0,i.jsx)(n.h4,{id:"examples-16",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To sign with one key pair:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithKeypair = createSignWithKeypair({ publicKey, secretKey });\n\nconst tx = Pact.builder\n  .execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount))\n  .addSigner(senderKey, (signFor) => [\n    signFor('coin.GAS'),\n    signFor('coin.TRANSFER', senderAccount, receiverAccount, amount),\n  ])\n  .setMeta({ chainId: '0', senderAccount })\n  .setNetworkId(NETWORK_ID)\n  .createTransaction();\n\nconst signedTx = signWithKeypair(tx);\n"})}),"\n",(0,i.jsx)(n.p,{children:"To sign with several key pairs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signWithKeypair = createSignWithKeypair([firstKeyPair, secondKeyPair]);\n\nconst signedTx = signWithKeypair(tx);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"addsignatures",children:"addSignatures"}),"\n",(0,i.jsxs)(n.p,{children:["If you already have the signature for a transaction, you can use the ",(0,i.jsx)(n.code,{children:"addSignatures"})," function to add the signature to the transaction."]}),"\n",(0,i.jsx)(n.p,{children:"All signatures you add should either include a public key, or none of them should. If the signatures don't include the public keys, then the number of signatures must match the number of signers, and the signatures are matched based on their order."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"addSignatures(transaction, ...signatures): IUnsignedCommand | ICommand\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transaction"}),(0,i.jsx)(n.td,{children:"IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The partially signed or unsigned transaction."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"...signatures"}),(0,i.jsxs)(n.td,{children:["Array of objects or strings ",(0,i.jsx)(n.code,{children:"{ sig: string; pubKey: string }"})," or ",(0,i.jsx)(n.code,{children:"{ sig: string }"})]}),(0,i.jsx)(n.td,{children:"List of signatures to be added to the transaction."})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-17",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To add a signature manually with a public key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signedTx = addSignatures(partiallySignedTx, {\n  sig: 'signature-str',\n  pubKey: 'publicKey',\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"To add a signature based on the signer order:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const signedTx = addSignatures(\n  twoSignersTx,\n  { sigOne: 'signature-str' },\n  { sigTwo: 'signature-str' },\n);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"communicating-with-the-network",children:"Communicating with the network"}),"\n",(0,i.jsxs)(n.p,{children:["Kadena exposes endpoints for communicating with Chainweb nodes through the [Pact REST API}(",(0,i.jsx)(n.a,{href:"https://api.chainweb.com/openapi/pact.html",children:"https://api.chainweb.com/openapi/pact.html"}),")."," You can use any REST client to call these endpoints. However, the Kadena client library also provides functions to make these call more convenient for frontend frameworks."]}),"\n",(0,i.jsx)(n.h3,{id:"createclient",children:"createClient"}),"\n",(0,i.jsxs)(n.p,{children:["To use the helper functions for communicating with Chainweb nodes, you must first use the ",(0,i.jsx)(n.code,{children:"createClient"})," function to return the ",(0,i.jsx)(n.code,{children:"IClient"})," interface."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createClient(\n  host?: string | (options: {chainId: ChainId; networkId: string}) => string,\n  options?: { confirmationDepth?: number }\n): IClient\n\ninterface IClient {\n  getStatus: (transactionDescriptors: ITransactionDescriptor[] | ITransactionDescriptor) => Promise<IPollResponse>;\n  submit: {\n    (transaction: ICommand): Promise<ITransactionDescriptor>;\n    (transactionList: ICommand[]): Promise<ITransactionDescriptor[]>;\n  }\n  send: {\n    (transaction: ICommand): Promise<ITransactionDescriptor>;\n    (transactionList: ICommand[]): Promise<ITransactionDescriptor[]>;\n  }\n  submitOne: (transaction: ICommand) => Promise<ITransactionDescriptor>;\n  listen: (transactionDescriptor: ITransactionDescriptor) => Promise<ICommandResult>;\n  pollOne: (transactionDescriptor: ITransactionDescriptor) => Promise<ICommandResult>;\n  pollStatus: (transactionDescriptors: ITransactionDescriptor[] | ITransactionDescriptor, options?: IPollOptions) => IPollRequestPromise<ICommandResult>;\n  getPoll: (transactionDescriptors: ITransactionDescriptor[] | ITransactionDescriptor) => Promise<IPollResponse>;\n  local: <T extends ILocalOptions>(transaction: LocalRequestBody, options?: T) => Promise<LocalResponse<T>>;\n  dirtyRead: (transaction: IUnsignedCommand) => Promise<ICommandResult>;\n  preflight: (transaction: ICommand | IUnsignedCommand) => Promise<ILocalCommandResult>;\n  signatureVerification: (transaction: ICommand) => Promise<ICommandResult>;\n  runPact: (code: string, data: Record<string, unknown>, option: INetworkOptions) => Promise<ICommandResult>;\n  createSpv: (transactionDescriptor: ITransactionDescriptor, targetChainId: ChainId) => Promise<string>;\n  pollCreateSpv: (transactionDescriptor: ITransactionDescriptor, targetChainId: ChainId, options?: IPollOptions) => Promise<string>;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can use object destructuring to extract specific functions."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { submit, local, pollCreateSpv } = createClient();\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"host"}),(0,i.jsxs)(n.td,{children:["string | ",(0,i.jsx)(n.code,{children:"(options: {chainId: ChainId; networkId: string}) => string"})]}),(0,i.jsx)(n.td,{children:"The Pact service URL as a string or the function that returns the URL."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"options"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ confirmationDepth?: number }"})}),(0,i.jsxs)(n.td,{children:["Additional options for the client. It has only one property now: ",(0,i.jsx)(n.code,{children:"confirmationDepth"}),", which can be used in the poll endpoint. Default value is ",(0,i.jsx)(n.code,{children:"0"}),"."]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Both ",(0,i.jsx)(n.code,{children:"host"})," and ",(0,i.jsx)(n.code,{children:"options"})," are optional. The default value of ",(0,i.jsx)(n.code,{children:"host"})," is a function that returns the Chainweb node URLs for mainnet and testnet. If you want to use different URLs, you must specify the ",(0,i.jsx)(n.code,{children:"host"})," parameter."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"networkId"})," and ",(0,i.jsx)(n.code,{children:"chainId"})," parameters are read from the command object and passed to the URL generator function."]}),"\n",(0,i.jsx)(n.h4,{id:"examples-18",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"To create a client for the development network and a specific chain identifier (1):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const client = createClient(\n  'http://127.0.0.1:8080/chainweb/0.0/development/chain/1/pact',\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:"To create a client for the development network that covers multi-chain and uses the URL generator function for more flexibility:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const devNetClient = createClient(\n  ({ chainId, networkId }) =>\n    `http://127.0.0.1:8080/chainweb/0.0/${networkId}/chain/${chainId ?? '1'}/pact`,\n);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To create a client that uses ",(0,i.jsx)(n.code,{children:"mainnet"})," but not Kadena main network nodes:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const client = createClient(({ chainId, networkId }) => {\n  switch (networkId) {\n    case 'mainnet01':\n      return `http://my-node-url/chainweb/0.0/${networkId}/chain/{${chainId}}/pact`;\n    case 'testnet04':\n      return `http://my-test-node-url/chainweb/0.0/${networkId}/chain/{${chainId}}/pact`;\n    default:\n      throw new Error('UNKNOWN_NETWORK');\n  }\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To create a client with a ",(0,i.jsx)(n.code,{children:"confirmationDepth"})," of ",(0,i.jsx)(n.code,{children:"5"})," that waits for five new blocks to be added to the chain before reading the result of a transaction:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { submit, pollStatus } = createClient(undefined, {\n  confirmationDepth: 5,\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"submitting-transactions",children:"Submitting transactions"}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.code,{children:"submit"})," or ",(0,i.jsx)(n.code,{children:"submitOne"})," functions to submit data to the blockchain. These functions use the Pact ",(0,i.jsx)(n.code,{children:"/send"})," endpoint."]}),"\n",(0,i.jsxs)(n.p,{children:["The client ",(0,i.jsx)(n.code,{children:"send"})," function is a deprecated alias for the ",(0,i.jsx)(n.code,{children:"submit"})," function with the same interface. To submit one transaction using the ",(0,i.jsx)(n.code,{children:"submit"})," function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { submit } = createClient();\n\nsubmit(tx): Promise<ITransactionDescriptor>;\n\ninterface ITransactionDescriptor {\n  networkId: string;\n  chainId: ChainId;\n  requestKey: string\n}\n\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tx"}),(0,i.jsx)(n.td,{children:"ICommand"}),(0,i.jsx)(n.td,{children:"The command object ready to submit."})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["To submit a list of transactions using the ",(0,i.jsx)(n.code,{children:"submit"})," function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { submit } = createClient();\n\nsubmit(txList): Promise<ITransactionDescriptor[]>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"txList"}),(0,i.jsx)(n.td,{children:"ICommand[]"}),(0,i.jsx)(n.td,{children:"List of command objects ready to submit."})]})})]}),"\n",(0,i.jsx)(n.p,{children:"In most cases, you should store the result of this function so you can fetch the result of the request."}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"submitOne"})," function is the same as submitting one transaction using the ",(0,i.jsx)(n.code,{children:"submit"})," function. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { submitOne } = createClient();\n\nsubmitOne(tx): Promise<ITransactionDescriptor>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tx"}),(0,i.jsx)(n.td,{children:"ICommand"}),(0,i.jsx)(n.td,{children:"The command object ready to submit."})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"getting-transaction-results",children:"Getting transaction results"}),"\n",(0,i.jsxs)(n.p,{children:["After you submit a transaction, you need to query for the result using a request key. You can query transaction results by calling the ",(0,i.jsx)(n.code,{children:"/listen"})," or ",(0,i.jsx)(n.code,{children:"/poll"})," endpoint."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"/listen"})," endpoint is a blocking request. It only accepts one request key and returns the results when the transaction result is ready. If you use this endpoint, the HTTP request remains open for a while."]}),"\n",(0,i.jsxs)(n.li,{children:["The",(0,i.jsx)(n.code,{children:"/poll"})," endpoint accepts a list of request keys and responds immediately with the current status of the request key."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The Kadena client library exposes the following functions to use the /listen or /poll endpoint in different scenarios:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"getStatus"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"pollStatus"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"listen"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"pollOne"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["These functions all return the result of a transaction with the following ",(0,i.jsx)(n.code,{children:"ICommandResult"})," interface:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ICommandResult {\n  reqKey: string;\n  txId: number | null;\n  result:\n    | {\n        status: 'success';\n        data: PactValue;\n      }\n    | {\n        status: 'failure';\n        error: object;\n      };\n  gas: number;\n  logs: string | null;\n  // for defpact functions\n  continuation: null | {\n    pactId: PactTransactionHash;\n    step: Step;\n    stepCount: number;\n    executed: boolean | null;\n    stepHasRollback: boolean;\n    continuation: {\n      def: string;\n      args: PactValue;\n    };\n    yield: {\n      data: Array<[string, PactValue]>;\n      provenance: {\n        targetChainId: ChainId;\n        moduleHash: string;\n      } | null;\n    };\n  };\n  metaData: null | {\n    blockHash: string;\n    blockTime: number;\n    blockHeight: number;\n    prevBlockHash: string;\n    publicMeta?: IPactCommand['meta'];\n  };\n  events: Array<{\n    name: string;\n    module: {\n      name: string;\n      namespace: string | null;\n    };\n    params: Array<PactValue>;\n    moduleHash: string;\n  }>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"getstatus",children:"getStatus"}),"\n",(0,i.jsxs)(n.p,{children:["This function calls ",(0,i.jsx)(n.code,{children:"/poll"})," and returns the result of requests."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { getStatus } = createClient();\n\ngetStatus(transactionDescriptor: TransactionDescriptor[] | ITransactionDescriptor): Promise<{\n    [requestKey: IBase64Url]: { [requestKey:string] ICommandResult};\n}>\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"TransactionDescriptor[list]"}),(0,i.jsx)(n.td,{children:"One or more request keys to be queried"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"pollstatus",children:"pollStatus"}),"\n",(0,i.jsxs)(n.p,{children:["This function calls ",(0,i.jsx)(n.code,{children:"/poll"})," in intervals and returns the result of all requests when all are ready."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { pollStatus } = createClient();\n\npollStatus(\n  transactionDescriptor: TransactionDescriptor[] | ITransactionDescriptor,\n  pollOptions: {\n    onPoll?: (id: string) => void;\n    timeout?: Milliseconds;\n    interval?: Milliseconds;\n    confirmationDepth?: number;\n  }\n): IPollRequestPromise<{\n    [requestKey: IBase64Url]: { [requestKey:string] ICommandResult};\n}>\n\ninterface IPollRequestPromise extends Promise {\n  [requestKey: IBase64Url]: Promise<ICommandResult>\n}\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"TransactionDescriptor[list]"}),(0,i.jsx)(n.td,{children:"One or more request keys to be queried."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pollOptions"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Optional poll configuration settings."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"onPoll"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Identifier for the callback that is called each time the node is polled for the status of a request key. This callback might be called several times if the request is not ready yet."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timeout"}),(0,i.jsx)(n.td,{children:"time"}),(0,i.jsxs)(n.td,{children:["Specifies a timeout in milliseconds to stop polling if the result is not ready. The default is ",(0,i.jsx)(n.code,{children:"180000"})," milliseconds (3 minutes)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"interval"}),(0,i.jsx)(n.td,{children:"time"}),(0,i.jsxs)(n.td,{children:["Specifies the delay between retry attempts. The default is ",(0,i.jsx)(n.code,{children:"5000"})," milliseconds (5 seconds)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"confirmationDepth"}),(0,i.jsx)(n.td,{children:"number"}),(0,i.jsxs)(n.td,{children:["Sets the confirmationDepth for getting the response. This setting overrides the one you set in the ",(0,i.jsx)(n.code,{children:"createClient"})," function."]})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"return-value",children:"Return value"}),"\n",(0,i.jsxs)(n.p,{children:["The return value is a special type of promise that enables you to listen for each individual request through the ",(0,i.jsx)(n.code,{children:"requests"})," property. Alternatively, you can ",(0,i.jsx)(n.code,{children:"await"})," the result without using the ",(0,i.jsx)(n.code,{children:"requests"})," property to handle most use cases."]}),"\n",(0,i.jsx)(n.h4,{id:"examples-19",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"Poll the status of a request:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const result = await pollStatus(request, {});\n"})}),"\n",(0,i.jsx)(n.p,{children:"Poll the status of several requests and get the result for each one immediately:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const resultPromise = pollStatus([firstRequest, secondRequest, thirdRequest]);\n// Notify the UI from the result of each request as soon as it's available\nresultPromise.requests['first-request-key'].then((res) => {\n  UI.notify(res);\n});\nresultPromise.requests['second-request-key'].then((res) => {\n  UI.notify(res);\n});\nresultPromise.requests['third-request-key'].then((res) => {\n  UI.notify(res);\n});\n// The final result object\nconst finalResult = await resultPromise;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"listen",children:"listen"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"listen"})," is another function for fetching the result of one request. It uses the ",(0,i.jsx)(n.code,{children:"/listen"})," endpoint, which is a blocking endpoint. ",(0,i.jsx)(n.strong,{children:"Note"}),": If your network or firewall configuration doesn't allow keeping HTTP connections open for a long time, then it's better to use ",(0,i.jsx)(n.code,{children:"pollOne"})," which has the same interface but uses ",(0,i.jsx)(n.code,{children:"/poll"})," under the hood."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { listen } = createClient();\n\nlisten(transactionDescriptor: TransactionDescriptor[] | ITransactionDescriptor): Promise<ICommandResult>\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"TransactionDescriptor"}),(0,i.jsxs)(n.td,{children:["The request object including ",(0,i.jsx)(n.code,{children:"requestKey"}),", ",(0,i.jsx)(n.code,{children:"networkId"}),", and ",(0,i.jsx)(n.code,{children:"chainId"}),"."]})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"pollone",children:"pollOne"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"pollOne"})," function fetches the result of only one request using the ",(0,i.jsx)(n.code,{children:"/poll"})," endpoint."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { pollOne } = createClient();\n\npollOne(transactionDescriptor: TransactionDescriptor[] | ITransactionDescriptor): Promise<ICommandResult>\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"TransactionDescriptor"}),(0,i.jsxs)(n.td,{children:["The request object including ",(0,i.jsx)(n.code,{children:"requestKey"}),", ",(0,i.jsx)(n.code,{children:"networkId"}),", and ",(0,i.jsx)(n.code,{children:"chainId"}),"."]})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"reading-data",children:"Reading data"}),"\n",(0,i.jsxs)(n.p,{children:["Apart from transactions, you can also send read requests to the node. This mainly utilizes the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint. These kinds of requests return the result immediately since you don't need to submit data. You can also use these functions to validate your transaction before calling the ",(0,i.jsx)(n.code,{children:"/send"})," endpoint to avoid transaction failure, as in some scenarios you need to pay gas even for failed transactions."]}),"\n",(0,i.jsxs)(n.p,{children:["The following functions all use the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"local"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"dirtyRead"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"preflight"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"signatureVerification"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"runPact"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"local",children:"local"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"local"})," function is the most generic function that utilizes the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"local(\n  transaction: ICommand | IUnsignedCommand,\n  options?: { preflight?: boolean; signatureVerification?: boolean; }\n): Promise<ICommandResult & { preflightWarnings?: string[] }>;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The return type is ",(0,i.jsx)(n.code,{children:"ICommandResult"})," with ",(0,i.jsx)(n.code,{children:"preflightWarnings"})," when it is set to true."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transaction"}),(0,i.jsx)(n.td,{children:"ICommand or IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The signed or unsigned command object."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"options"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Optional configuration settings."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"preflight"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsxs)(n.td,{children:["Runs the code in the ",(0,i.jsx)(n.code,{children:"preflight"})," mode to simulate submitting the transaction. You can also use this option to preview the estimated gas that the transaction would consume. The default is ",(0,i.jsx)(n.code,{children:"true"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"signatureVerification"}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsxs)(n.td,{children:["Runs the signature verification in the node for the transaction. The default is ",(0,i.jsx)(n.code,{children:"true"}),"."]})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-20",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"Use a local call to avoid submitting an incorrect transaction:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Check if the transaction and signatures are correct\nconst response = await client.local(signedTx);\n\nif (response.result.status === 'failure') {\n  // Throw if the transaction fails to avoid paying gas for a failed transaction\n  throw response.result.error;\n}\nconst request = await client.submit(signedTx);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Use local call for gas estimation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// We don't need to send signatures to check gas estimation;\nconst response = await client.local(unsignedTx, {\n  preflight: true,\n  signatureVerification: false,\n});\n\nif (response.result.status === 'failure') {\n  throw response.result.error;\n}\n\nconst gasEstimation = response.gas;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"dirtyread",children:"dirtyRead"}),"\n",(0,i.jsx)(n.p,{children:"Alias for local where both preflight and signatureVerification are false. This function is useful when your code only needs to read data from the node."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"dirtyRead(transaction: ICommand | IUnsignedCommand): Promise<ICommandResult>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transaction"}),(0,i.jsx)(n.td,{children:"ICommand or IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The signed or unsigned command object"})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-21",children:"Examples"}),"\n",(0,i.jsx)(n.p,{children:"Get account balance"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const tr = Pact.builder\n  .execution(Pact.modules.coin['get-balance'](account))\n  .setMeta({ chainId: '0' })\n  .setNetworkId('mainnet04')\n  .createTransaction();\n\n// We don't need to submit a transaction for just reading data,\n// so instead we just read the value from the local data of the blockchain node\nconst res = await dirtyRead(tr);\n\nif (res.result.status === 'failure') {\n  throw res.result.error;\n}\n\nconst balance = res.result.data;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"preflight",children:"preflight"}),"\n",(0,i.jsx)(n.p,{children:"Alias for local where preflight is true but signatureVerification is false."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"preflight(transaction: ICommand | IUnsignedCommand): Promise<ICommandResult>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transaction"}),(0,i.jsx)(n.td,{children:"ICommand or IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The signed or unsigned command object"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"signatureverification",children:"signatureVerification"}),"\n",(0,i.jsx)(n.p,{children:"Alias for local where preflight is false but signatureVerification is true."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"signatureVerification(transaction: ICommand | IUnsignedCommand): Promise<ICommandResult & { preflightWarnings?: string[] }>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transaction"}),(0,i.jsx)(n.td,{children:"ICommand or IUnsignedCommand"}),(0,i.jsx)(n.td,{children:"The signed or unsigned command object"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"runpact",children:"runPact"}),"\n",(0,i.jsxs)(n.p,{children:["If you just want to see the result of a pact code and don't want to create a command object, you can use the ",(0,i.jsx)(n.code,{children:"runPact"})," function. This function creates a command object internally."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"runPact(code: string, data?: Record<string, unknown>, options?: { chainId: ChainId; networkId: string }): Promise<ICommandResult>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"code"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Pact code"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data"}),(0,i.jsx)(n.td,{children:"Record, string, or unknown"}),(0,i.jsx)(n.td,{children:"Data to be sent with the transaction"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"options"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"chainId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:'Specifies the chain identifier that you want to send the transaction to. The valid values are "0" to "19".'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"networkId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Specifies the network identifier that you want to send the transaction to."})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-22",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const { runPact } = createClient();\n\nconst result = await runPact(\n  `(coin.getBalance \"alice\")`,\n  {},\n  { networkId: 'mainnet01', chainId: '1' },\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"requesting-simple-payment-verification-spv",children:"Requesting simple payment verification (spv)"}),"\n",(0,i.jsx)(n.p,{children:"You need SPV proof mainly for cross-chain transactions - but it's not limited to this, and you can request SPV proof for all kinds of transactions."}),"\n",(0,i.jsxs)(n.p,{children:["There are two functions for this purpose, both of which use the ",(0,i.jsx)(n.code,{children:"/spv"})," endpoint:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"createSPV"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"pollCreateSPV"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"createspv",children:"createSPV"}),"\n",(0,i.jsx)(n.p,{children:"Request SPV proof if it's ready."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createSpv(transactionDescriptor: ITransactionDescriptor, targetChainId: ChainId): Promise<string>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Specifies the request key, network identifier, and chain identifier for the transaction that you want to create a simple payment verification (spv) proof for."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"targetChainId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Specifies the chain identifier that consumes this proof."})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"pollcreatespv",children:"pollCreateSPV"}),"\n",(0,i.jsx)(n.p,{children:"Poll for the SPV proof and await until it's ready."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"pollCreateSpv(\n  transactionDescriptor: ITransactionDescriptor,\n  targetChainId: ChainId,\n  pollOptions?: { onPoll?: (id: string) => void; timeout?: Milliseconds; interval?: Milliseconds; }\n): Promise<string>;\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"transactionDescriptor"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Specifies the request key, network identifier, and chain identifier for the transaction that you want to create a simple payment verification (spv) proof for."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"targetChainId"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Specifies the chain identifier that consumes this proof."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pollOptions"}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Optional poll configuration settings."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"onPoll"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Identifier for the callback that is called each time the node is polled for the status of a request key. This callback might be called several times if the request is not ready yet."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timeout"}),(0,i.jsx)(n.td,{children:"time"}),(0,i.jsxs)(n.td,{children:["Specifies a timeout in milliseconds to stop polling if the result is not ready. The default is ",(0,i.jsx)(n.code,{children:"180000"})," milliseconds (3 minutes)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"interval"}),(0,i.jsx)(n.td,{children:"time"}),(0,i.jsxs)(n.td,{children:["Specifies the delay between retry attempts. The default is ",(0,i.jsx)(n.code,{children:"5000"})," milliseconds (5 seconds)."]})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-23",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const request = await submit(crossChainTx);\nconst response = await pollOne(request);\n// create spv proof for the transaction\nconst spvProof = await pollSpvProof(request);\n\nconst continuationTx = Pact.builder\n  .continuation({\n    pactId: response.continuation.pactId,\n    rollback: false,\n    step: 1,\n    proof: spvProof,\n  })\n  .addMeta({\n    chainId: targetChainId,\n    // using gas station for paying gas fee\n    senderAccount: 'kadena-xchain-gas',\n  })\n  .createTransaction();\n\nconst contRequest = await submit(continuationTx);\nconst finalResult = await pollOne(contRequest);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"functional-programming-to-compose-pact-commands",children:"Functional programming to compose Pact commands"}),"\n",(0,i.jsxs)(n.p,{children:["For additional flexibility, you can use the functional programming (FP) API to create Pact commands. The functional programming (FP) API supports the same functions as the command builder API. In fact, the command builder API uses the functional programming (FP) API under the hood. To reduce redundancy, this section lists the common functions with examples for using the ",(0,i.jsx)(n.code,{children:"composePactCommand"})," function rather than repeating the full function descriptions and parameter tables."]}),"\n",(0,i.jsx)(n.h3,{id:"importing-functions",children:"Importing functions"}),"\n",(0,i.jsxs)(n.p,{children:["To use the functional programming (FP) API, import functions from the ",(0,i.jsx)(n.code,{children:"@kadena/client/fp"})," package. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { composePactCommand, execution } from '@kadena/client/fp';\n"})}),"\n",(0,i.jsx)(n.h3,{id:"composepactcommand",children:"composePactCommand"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"composePactCommand"})," function let you compose parts of the Pact command and create the final command objects. The function accepts pure JSON as well as reducer functions. This function eventfully returns the ",(0,i.jsx)(n.code,{children:"IPartialPactCommand"})," interface that is converted to a string for the ",(0,i.jsx)(n.code,{children:"cmd"})," key in the JSON command object."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type CommandReducer = (cmd?: IPartialPactCommand | (() => IPartialPactCommand)) => IPartialPactCommand;\n\ncomposePactCommand(\n  ...reducersOrPartialCommands: Array<IPartialPactCommand | CommandReducer>\n  ): CommandReducer\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The return value is also a ",(0,i.jsx)(n.code,{children:"CommandReducer"})," function that you can pass to another ",(0,i.jsx)(n.code,{children:"composePactCommand"})," call. Eventually, when you call the function, it also adds the default values."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"...reducersOrPartialCommands"}),(0,i.jsxs)(n.td,{children:["Array ",(0,i.jsx)(n.code,{children:"<IPartialPactCommand | CommandReducer>"})]}),(0,i.jsx)(n.td,{children:"List of command reducers or partial Pact commands."})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"examples-24",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const pactCommand = composePactCommand(\n  { payload: { exec: { code: '(+ 1 1)' } } },\n  (cmd) => ({ ...cmd, meta: { chainId: '1' } }),\n  { networkId: 'testnet04' },\n)();\n\nconst pactCommand = {\n  payload: { exec: { code: '(+ 1 1)' } },\n  meta: {\n    gasLimit: 2500,\n    gasPrice: 1e-8,\n    sender: '',\n    ttl: 28800,\n    creationTime: 1690416000,\n    chainId: '1',\n  },\n  networkId: 'testnet04',\n  nonce: 'kjs:nonce:1690416000000',\n  signers: [],\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"execution",children:"execution"}),"\n",(0,i.jsxs)(n.p,{children:["To create ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.exec.code"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"execution(...codes): { payload: { exec : { code: string, data: {} } }}\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example, using strings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const command: IPactCommand = composePactCommand(\n  execution(`(coin.transfer "alice" "bob" 1.1)`),\n)();\n'})}),"\n",(0,i.jsxs)(n.p,{children:["For example, using ",(0,i.jsx)(n.code,{children:"Pact.modules"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const command: IPactCommand = composePactCommand(\n  execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' })),\n)();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"continuation",children:"continuation"}),"\n",(0,i.jsxs)(n.p,{children:["To create ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.cont"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"continuation(contData: {\n  pactId?: string;\n  step?: number;\n  rollback?: boolean;\n  data?: Record<string, unknown>;\n  proof?: string | null;\n}): {\n  payload: {\n    cont: {\n      pactId?: string;\n      step?: number;\n      rollback?: boolean;\n      data?: Record<string, unknown>;\n      proof?: string | null;\n    };\n  };\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const command: IPactCommand = composePactCommand(\n  continuation({\n    pactId,\n    rollback: false,\n    step: 1,\n    proof: spvProof,\n  }),\n)();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"addsigner-1",children:"addSigner"}),"\n",(0,i.jsxs)(n.p,{children:["To add ",(0,i.jsx)(n.code,{children:"IPactCommand.signers"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"addSigner(signerOrSignersList, capabilityCallback): CommandReducer;\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example, add a signer:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// ED25519 key\nconst alicePublicKey =\n  'e7f4da07b1d200f6e45aa6492afed6819297a97563859a5f0df9c54f5abd4aab';\n\ncomposePactCommand(\n  execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' })),\n  addSigner(alicePublicKey, (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]),\n);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Add a signer with ",(0,i.jsx)(n.code,{children:"WebAuthn"})," scheme:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' })),\n  addSigner({ pubKey: webAuthnPublicKey, scheme: 'WebAuthn' }, (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]),\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Add a list of signers with no capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution('(free.my-module.my-function)'),\n  addSigner([\n    'ED25519_publicKey',\n    { pubKey: 'WebAuthn_publicKey', scheme: 'WebAuthn' },\n  ]),\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Add a list of signers with similar capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const pactCommand = composePactCommand(\n  execution(Pact.modules.coin.transfer('alice', 'bob', { decimal: '1.1' })),\n  // e.g., Alice's account is guarded by two keys\n  addSigner(['first_publicKey', 'second_publicKey'], (signFor) => [\n    signFor('coin.TRANSFER', 'alice', 'bob', { decimal: '1.1' }),\n  ]),\n)();\n\nconst equivalentPactCommand = {\n  payload: {\n    exec: {\n      code: '(coin.transfer \"alice\" \"bob\" 1.1 )',\n      data: {},\n    },\n  },\n  signers: [\n    {\n      pubKey: 'first_publicKey',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.TRANSFER', args: ['alice', 'bob', { decimal: '1.1' }] },\n      ],\n    },\n    {\n      pubKey: 'second_publicKey',\n      scheme: 'ED25519',\n      clist: [\n        { name: 'coin.TRANSFER', args: ['alice', 'bob', { decimal: '1.1' }] },\n      ],\n    },\n  ],\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"adddata-1",children:"addData"}),"\n",(0,i.jsxs)(n.p,{children:["To add data to ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.exec.data"})," or ",(0,i.jsx)(n.code,{children:"IPactCommand.payload.cont.data"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"addData(key, value): CommandReducer\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example, to transfer with parameters in data:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution(\n    '(coin.transfer (read-string \"sender\") (read-string \"receiver\") 1.1)',\n  ),\n  addData('sender', sender),\n  addData('receiver', sender),\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Send the receiver guard:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution(\n    '(coin.transfer-create \"alice\" \"bob\" (read-keyset \"bob-guard\") 1.1)',\n  ),\n  addData('bob-guard', {\n    keys: ['bob-public-key'],\n    pred: 'keys-all',\n  }),\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"addkeyset-1",children:"addKeyset"}),"\n",(0,i.jsx)(n.p,{children:"To add a keyset:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"addKeyset(name, pred, ...keys): CommandReducer\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For example, to add a keyset using the ",(0,i.jsx)(n.code,{children:"readKeyset"})," helper function:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution(\n    Pact.modules.coin['transfer-create'](\n      'alice',\n      'bob',\n      readKeyset('bob-guard'),\n      { decimal: '1.1' },\n    ),\n  ),\n  addKeyset('bob-guard', 'keys-all', 'bob-public-key'),\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setmeta-1",children:"setMeta"}),"\n",(0,i.jsxs)(n.p,{children:["To add ",(0,i.jsx)(n.code,{children:"IPactCommand.meta"})," metadata properties to a command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"setMeta(meta): CommandReducer\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"composePactCommand(\n  execution('(coin.transfer \"alice\" \"bob\" 1.1)'),\n  // \"bob is paying gas fee\"\n  setMeta({ chainId: '02', senderAccount: 'bob' }),\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"etnonce",children:"etNonce"}),"\n",(0,i.jsxs)(n.p,{children:["To manually set ",(0,i.jsx)(n.code,{children:"IPactCommand.nonce"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"setNonce(nonce): { nonce: string };\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'composePactCommand(\n  execution(\'(coin.transfer "alice" "bob" 1.1)\'),\n  // "bob is paying gas fee"\n  setNonce(\'a-custom-nonce\'),\n);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"setnetworkid-1",children:"setNetworkId"}),"\n",(0,i.jsxs)(n.p,{children:["To set ",(0,i.jsx)(n.code,{children:"IPactCommand.network"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"setNetworkId(networkId): { networkId : string }\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'composePactCommand(\n  execution(\'(coin.transfer "alice" "bob" 1.1)\'),\n  // "bob is paying gas fee"\n  setNetworkId(\'testnet04\'),\n);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"createtransaction",children:"createTransaction"}),"\n",(0,i.jsx)(n.p,{children:"To create the transaction object:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createTransaction(pactCommand:IPactCommand): IUnsignedCommand\n"})}),"\n",(0,i.jsx)(n.p,{children:"For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const pactCommand = composePactCommand(\n  execution(Pact.modules.coin.transfer(senderAccount, receiverAccount, amount)),\n  addSigner(senderKey, (signFor) => [\n    signFor(\'coin.GAS\'),\n    signFor(\'coin.TRANSFER\', senderAccount, receiverAccount, amount),\n  ]),\n  setMeta({ chainId: \'0\', senderAccount }),\n  setNetworkId(NETWORK_ID),\n  createTransaction(),\n);\n\nconst transaction = createTransaction(pactCommand);\n\nconst output = {\n  cmd: \'{"payload":{"exec":{"code":"(coin.transfer \\\\"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46\\\\" \\\\"k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11\\\\" 1.0)","data":{}}},"nonce":"kjs:nonce:1711376792115","signers":[{"pubKey":"dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","scheme":"ED25519","clist":[{"name":"coin.GAS","args":[]},{"name":"coin.TRANSFER","args":["k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","k:2f48080efe54e6eb670487f664bcaac7684b4ebfcfc8a3330ef080c9c97f7e11",{"decimal":"1"}]}]}],"meta":{"gasLimit":2500,"gasPrice":1e-8,"sender":"k:dc20ab800b0420be9b1075c97e80b104b073b0405b5e2b78afd29dd74aaf5e46","ttl":28800,"creationTime":1711376792,"chainId":"0"},"networkId":"testnet04"}\',\n  hash: \'xYePm_YgO6-T9yIlCZWzOt2s4CkZcQwqWx9Iu5tVSLI\',\n  sigs: [undefined],\n};\n'})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var s=t(96540);const i={},c=s.createContext(i);function a(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);