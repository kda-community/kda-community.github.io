"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[2366],{6766:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"api/service-api/api-update-event-stream","title":"Stream block header events","description":"Send API requests to this endpoint to monitor a node for new blocks.","source":"@site/docs/api/service-api/get-block-updates.md","sourceDirName":"api/service-api","slug":"/api/service-api/api-update-event-stream","permalink":"/docs/api/service-api/api-update-event-stream","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/api/service-api/get-block-updates.md","tags":[{"inline":true,"label":"chainweb","permalink":"/docs/tags/chainweb"},{"inline":true,"label":"node api","permalink":"/docs/tags/node-api"},{"inline":true,"label":"chainweb api","permalink":"/docs/tags/chainweb-api"},{"inline":true,"label":"api reference","permalink":"/docs/tags/api-reference"}],"version":"current","sidebarPosition":11,"frontMatter":{"title":"Stream block header events","description":"Send API requests to this endpoint to monitor a node for new blocks.","id":"api-update-event-stream","sidebar_position":11,"tags":["chainweb","node api","chainweb api","api reference"]},"sidebar":"default","previous":{"title":"Get branch block headers","permalink":"/docs/api/service-api/get-block-header-branch"},"next":{"title":"Start a database backup","permalink":"/docs/api/service-api/make-db-backup"}}');var r=n(74848),a=n(28453);const i={title:"Stream block header events",description:"Send API requests to this endpoint to monitor a node for new blocks.",id:"api-update-event-stream",sidebar_position:11,tags:["chainweb","node api","chainweb api","api reference"]},d="Stream block header events",o={},c=[{value:"Request format",id:"request-format",level:2},{value:"Responses",id:"responses",level:2},{value:"Response header",id:"response-header",level:3},{value:"Response schema",id:"response-schema",level:3},{value:"Examples",id:"examples",level:2}];function h(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"stream-block-header-events",children:"Stream block header events"})}),"\n",(0,r.jsx)(t.p,{children:"The block updates endpoint enables you to connect to a server-side event stream to be notified when new blocks are added to the blockchain."}),"\n",(0,r.jsx)(t.p,{children:"The stream can contain blocks that might later become orphaned.\nTo address this potential issue, you should buffer events on the client side for the most recent block heights to allow for a desired confirmation depth to be reached."}),"\n",(0,r.jsx)(t.p,{children:"You should note that the server might terminate this event stream from time to time.\nIt is up to the client to restart event streaming with a new request."}),"\n",(0,r.jsx)(t.h2,{id:"request-format",children:"Request format"}),"\n",(0,r.jsxs)(t.p,{children:["Use ",(0,r.jsx)(t.code,{children:"GET http://{baseURL}/header/updates"})," to connect to a source of server events that emits a BlockHeader event for each new block header that is added to the chain database of the remote node."]}),"\n",(0,r.jsx)(t.h2,{id:"responses",children:"Responses"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"200 OK"})," indicates a successful requests and results in a stream of BlockHeader events.\nEach event consists of an event property and a data property and are separated by empty lines."]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"response-header",children:"Response header"}),"\n",(0,r.jsx)(t.p,{children:"The response header parameters are the same for all successful and unsuccessful Chainweb node requests."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"x-peer-addr"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsxs)(t.td,{children:["Specifies the host address and port number of the client as observed by the remote Chainweb node. The host address can be a domain name or an IP address in IPv4 or IPv6 format. For example: ",(0,r.jsx)(t.code,{children:'"10.36.1.3:42988"'}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"x-server\u2011timestamp"}),(0,r.jsx)(t.td,{children:"integer\xa0>=\xa00"}),(0,r.jsxs)(t.td,{children:["Specifies the clock time of the remote Chainweb node using the UNIX epoch timestamp. For example: ",(0,r.jsx)(t.code,{children:"1618597601"}),"."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"x\u2011chainweb\u2011node\u2011version"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsxs)(t.td,{children:["Specifies the version of the remote Chainweb node. For example: ",(0,r.jsx)(t.code,{children:'"2.23"'}),"."]})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"response-schema",children:"Response schema"}),"\n",(0,r.jsxs)(t.p,{children:["If the request is successful, the response returns ",(0,r.jsx)(t.code,{children:"text/event-stream"})," content with the following:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"event"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:'Specifies the type of event with the event property value of "BlockHeader".'})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"data"}),(0,r.jsx)(t.td,{children:"object"}),(0,r.jsx)(t.td,{children:"Specifies the data properties for the event."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(t.p,{children:"You can send a request for block header updates from the Kadena main network like this:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-Postman",children:"GET http://api.chainweb.com/chainweb/0.0/mainnet01/header/updates\n"})}),"\n",(0,r.jsx)(t.p,{children:"This request returns a stream of events with the BlockHeader event property and a data property:"}),"\n",(0,r.jsx)(t.p,{children:"If you expand the data property for an event, the event includes details similar to the folloiwng:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n    "header": {\n        "adjacents": {\n            "12": "_RU_P5XpRIFJK7-xhClDzBIwRD3LCkNzhNTi4M05uPY",\n            "14": "tzNb2_b_nWkGM9Qh3u4Pxna-NU2RYBYEuZE3cwu2m1k",\n            "3": "6auRG8JDj4S4IYMF8G-d47dkwVAfX8XmOOg6isofr_M"\n        },\n        "chainId": 13,\n        "chainwebVersion": "mainnet01",\n        "creationTime": 1722966936274259,\n        "epochStart": 1722966541117672,\n        "featureFlags": 0,\n        "hash": "mb-Tn9AyDYuP5TgqaAlBu9VgR6eSZdWgKz9qtAGbrDA",\n        "height": 5016971,\n        "nonce": "5486220440094445593",\n        "parent": "ItXSuFMmiQ1tcbXHPD0YoVR-2oip8RAn0m20v09vsTc",\n        "payloadHash": "9v4k_U0IjxES-AwUSw_0PsqVBZ65msUKgZcGZO2cbY8",\n        "target": "mGwbbeZtKT0EAHYYZTgreADt6mLkayeBEQAAAAAAAAA",\n        "weight": "LJy-RUh3OhJ8VwEAAAAAAAAAAAAAAAAAAAAAAAAAAAA"\n    },\n    "powHash": "0000000000000009d25e6c0bfe4f0c07b87af281929d275412c8be921fd9334b",\n    "target": "000000000000001181276be462eaed00782b3865187600043d296de66d1b6c98",\n    "txCount": 0\n}\n'})})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>d});var s=n(96540);const r={},a=s.createContext(r);function i(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);