"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[5110],{75576:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>o,frontMatter:()=>s,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"api/binary-encoding","title":"Binary encoding","description":"Provides reference information for the chainweb-node block header binary encoding.","source":"@site/docs/api/chainweb-encoding.md","sourceDirName":"api","slug":"/api/binary-encoding","permalink":"/docs/api/binary-encoding","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/api/chainweb-encoding.md","tags":[{"inline":true,"label":"chainweb","permalink":"/docs/tags/chainweb"},{"inline":true,"label":"node api","permalink":"/docs/tags/node-api"},{"inline":true,"label":"chainweb api","permalink":"/docs/tags/chainweb-api"},{"inline":true,"label":"api reference","permalink":"/docs/tags/api-reference"}],"version":"current","frontMatter":{"title":"Binary encoding","description":"Provides reference information for the chainweb-node block header binary encoding.","menu":"Chainweb API","id":"binary-encoding","order":2,"layout":"full","tags":["chainweb","node api","chainweb api","api reference"]},"sidebar":"default","previous":{"title":"Data models","permalink":"/docs/api/data-models"},"next":{"title":"Reference","permalink":"/docs/reference/"}}');var d=i(74848),r=i(28453);const s={title:"Binary encoding",description:"Provides reference information for the chainweb-node block header binary encoding.",menu:"Chainweb API",id:"binary-encoding",order:2,layout:"full",tags:["chainweb","node api","chainweb api","api reference"]},c="Block header binary encoding",h={},a=[{value:"Adjacent parents record",id:"adjacent-parents-record",level:2},{value:"Adjacent parent",id:"adjacent-parent",level:2},{value:"Proof of work and field values",id:"proof-of-work-and-field-values",level:2},{value:"Time stamps",id:"time-stamps",level:3},{value:"Numbers",id:"numbers",level:3},{value:"Version",id:"version",level:3},{value:"Other",id:"other",level:3},{value:"Work header binary encoding",id:"work-header-binary-encoding",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"block-header-binary-encoding",children:"Block header binary encoding"})}),"\n",(0,d.jsxs)(n.p,{children:["The binary format for chain graphs of degree three is defined in ",(0,d.jsx)(n.code,{children:"Chainweb.BlockHeader"}),"."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Size"}),(0,d.jsx)(n.th,{children:"Bytes"}),(0,d.jsx)(n.th,{children:"Value"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"0-7"}),(0,d.jsx)(n.td,{children:"flags"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"8-15"}),(0,d.jsx)(n.td,{children:"time"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"16-47"}),(0,d.jsx)(n.td,{children:"parent"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"110"}),(0,d.jsx)(n.td,{children:"48-157"}),(0,d.jsx)(n.td,{children:"adjacents"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"158-189"}),(0,d.jsx)(n.td,{children:"target"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"190-221"}),(0,d.jsx)(n.td,{children:"payload"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"4"}),(0,d.jsx)(n.td,{children:"222-225"}),(0,d.jsx)(n.td,{children:"chain"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"226-257"}),(0,d.jsx)(n.td,{children:"weight"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"258-265"}),(0,d.jsx)(n.td,{children:"height"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"4"}),(0,d.jsx)(n.td,{children:"266-269"}),(0,d.jsx)(n.td,{children:"version"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"270-277"}),(0,d.jsx)(n.td,{children:"epoch start"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"278-285"}),(0,d.jsx)(n.td,{children:"nonce"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"286-317"}),(0,d.jsx)(n.td,{children:"hash"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"total: 318 bytes"}),"\n",(0,d.jsx)(n.h2,{id:"adjacent-parents-record",children:"Adjacent parents record"}),"\n",(0,d.jsx)(n.p,{children:"The binary format for adjacent parents (length 3):"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Bytes"}),(0,d.jsx)(n.th,{children:"Value"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0-1"}),(0,d.jsx)(n.td,{children:"length"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"2-109"}),(0,d.jsx)(n.td,{children:"adjacents"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"total: 110 bytes"}),"\n",(0,d.jsx)(n.h2,{id:"adjacent-parent",children:"Adjacent parent"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Bytes"}),(0,d.jsx)(n.th,{children:"Value"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0-3"}),(0,d.jsx)(n.td,{children:"chain"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"4-35"}),(0,d.jsx)(n.td,{children:"hash"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"total: 36 bytes"}),"\n",(0,d.jsx)(n.h2,{id:"proof-of-work-and-field-values",children:"Proof of work and field values"}),"\n",(0,d.jsxs)(n.p,{children:["Arithmetic operations and comparisons on ",(0,d.jsx)(n.code,{children:"parent"}),", ",(0,d.jsx)(n.code,{children:"target"}),", ",(0,d.jsx)(n.code,{children:"weight"}),", and ",(0,d.jsx)(n.code,{children:"hash"})," interpret the value as unsigned 256-bit integral numbers in little endian encoding.\nAll operations are performed using rational arithmetic of unlimited precision and the final result is rounded.\nFor details about how the result is rounded, consult the source code directly."]}),"\n",(0,d.jsx)(n.h3,{id:"time-stamps",children:"Time stamps"}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"time"})," and ",(0,d.jsx)(n.code,{children:"epoch start"})," values are a little endian twos complement encoded integral numbers that count SI microseconds since the start of the POSIX/UNIX epoch (leap seconds are ignored).\nThese numbers are always positive (highest bit is 0)."]}),"\n",(0,d.jsx)(n.h3,{id:"numbers",children:"Numbers"}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"height"})," is a little endian encoded unsigned integral 64 bit number.\nThe ",(0,d.jsx)(n.code,{children:"length"})," is a little endian encoded unsigned integral 16 bit number."]}),"\n",(0,d.jsx)(n.h3,{id:"version",children:"Version"}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"version"})," field identifies the Chainweb version.\nIt is a 32 bit value in little endian encoding.\nValues up to 0x0000FFFF are reserved for production versions, including includes development and testnets."]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Value"}),(0,d.jsx)(n.th,{children:"Version"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x00000005"}),(0,d.jsx)(n.td,{children:"mainnet01"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x00000001"}),(0,d.jsx)(n.td,{children:"development"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x00000007"}),(0,d.jsx)(n.td,{children:"testnet04"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"other",children:"Other"}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"nonce"})," is any sequence of 8 bytes that is only compared for equality.\nThe ",(0,d.jsx)(n.code,{children:"chain"})," is any sequence of 4 bytes that identifies a chain and can be compared for equality.\nThe ",(0,d.jsx)(n.code,{children:"payload"})," is any sequence of 32 bytes that is a cryptographic hash of the payload associated with the block and can be compared for equality.\nflags are eight bytes of value 0x0 that are reserved for future use."]}),"\n",(0,d.jsx)(n.h2,{id:"work-header-binary-encoding",children:"Work header binary encoding"}),"\n",(0,d.jsxs)(n.p,{children:["The work bytes received from the ",(0,d.jsx)(n.code,{children:"/miner/work"})," endpoint is slightly different than the above header format.\nThese headers do not include the block hash, instead prefixing the header above (without hash) with chain id and hash target bytes."]}),"\n",(0,d.jsx)(n.p,{children:"The first 36 bytes are informational.\nOnly the bytes from position 36 to the end are the subject of the proof of work hash computation."}),"\n",(0,d.jsx)(n.p,{children:"The final 8 bytes are the nonce.\nThe creation time is encoded in bytes 44-52 (see above for details of the encoding).\nMiners are allowed, but not required, to update the time to reflect the solve time for the block more closely.\nA larger value for the creation time increases the accuracy of the difficulty adjustment which is in the interest of miners.\nThe high difficulty guarantees that the outcome of the race of winning blocks is determined by actual hash power.\nHowever, blocks that are predated (that is, have a creation time that is in the future) are rejected during block header validation.\nLeaving the time unchanged is a valid choice."}),"\n",(0,d.jsx)(n.p,{children:'Miners must not change or make any assumptions about the content of the "reserved" bytes.'}),"\n",(0,d.jsxs)(n.p,{children:["Defined in ",(0,d.jsx)(n.code,{children:"Chainweb.Miner.Core"}),":"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Size"}),(0,d.jsx)(n.th,{children:"Bytes"}),(0,d.jsx)(n.th,{children:"Work bytes"}),(0,d.jsx)(n.th,{children:"Value"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"4"}),(0,d.jsx)(n.td,{children:"0-3"}),(0,d.jsx)(n.td,{children:"NA"}),(0,d.jsx)(n.td,{children:"chain"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"32"}),(0,d.jsx)(n.td,{children:"4-35"}),(0,d.jsx)(n.td,{children:"NA"}),(0,d.jsx)(n.td,{children:"hash-target"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"36-43"}),(0,d.jsx)(n.td,{children:"0-7"}),(0,d.jsx)(n.td,{children:"reserved"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"44-51"}),(0,d.jsx)(n.td,{children:"8-15"}),(0,d.jsx)(n.td,{children:"time"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"298"}),(0,d.jsx)(n.td,{children:"52-313"}),(0,d.jsx)(n.td,{children:"16-277"}),(0,d.jsx)(n.td,{children:"reserved"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"8"}),(0,d.jsx)(n.td,{children:"314-321"}),(0,d.jsx)(n.td,{children:"278-285"}),(0,d.jsx)(n.td,{children:"nonce"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"total: 322 bytes"}),"\n",(0,d.jsxs)(n.p,{children:["For arithmetic comparisons the ",(0,d.jsx)(n.code,{children:"hash-target"})," is interpreted as unsigned 256 bit integral number in little endian encoding."]}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"time"})," is a little endian twos complement encoded integral number that counts SI microseconds since the start of the POSIX/UNIX epoch (leap seconds are ignored). The value is always positive (highest bit is 0)."]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(96540);const d={},r=t.createContext(d);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);