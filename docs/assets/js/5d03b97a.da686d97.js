"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[2312],{94569:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>r,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"pact-5/capabilities/install-capability","title":"install-capability","description":"Use install-capability to specify and provision a managed capability.","source":"@site/docs/pact-5/capabilities/install-capability.md","sourceDirName":"pact-5/capabilities","slug":"/pact-5/capabilities/install-capability","permalink":"/docs/pact-5/capabilities/install-capability","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/pact-5/capabilities/install-capability.md","tags":[],"version":"current","frontMatter":{},"sidebar":"default","previous":{"title":"emit-event","permalink":"/docs/pact-5/capabilities/emit-event"},"next":{"title":"require-capability","permalink":"/docs/pact-5/capabilities/require-capability"}}');var i=n(74848),s=n(28453);const l={},c="install-capability",r={},d=[{value:"Basic syntax",id:"basic-syntax",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Return value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2}];function o(e){const a={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"install-capability",children:"install-capability"})}),"\n",(0,i.jsxs)(a.p,{children:["Use ",(0,i.jsx)(a.code,{children:"install-capability"})," to specify and provision a managed capability.\nManaged capabilities are defined in ",(0,i.jsx)(a.code,{children:"defcap"})," declarations that include the ",(0,i.jsx)(a.code,{children:"@managed"})," keyword. The ",(0,i.jsx)(a.code,{children:"@managed"})," keyword designates a single parameter to be managed by a specified management function.\nAfter a capability is installed, it must still be brought into scope using the ",(0,i.jsx)(a.code,{children:"with-capability"})," function.\nWhen the capability is brought into scope, its management function is invoked to validate the request."]}),"\n",(0,i.jsx)(a.p,{children:"The management function takes the type of the managed parameter, executes the logic required to validate the requested capability or perform the managed operation, and returns the new managed value that results from the request."}),"\n",(0,i.jsxs)(a.p,{children:["The type signature for the management function is ",(0,i.jsx)(a.code,{children:"managed:<type> requested:<type> -> <type>"}),", where ",(0,i.jsx)(a.code,{children:"<type>"})," indicates the type of the managed parameter.\nFor example, assume you define a managed capability as:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:"(defcap FOO (bar:string baz:integer) @managed baz FOO-mgr ...)\n"})}),"\n",(0,i.jsx)(a.p,{children:"The management function for this capability would be:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:"(defun FOO-mgr:integer (managed:integer requested:integer) ...)\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Any capability that has static unmanaged parameters will invoke the management function with the current managed value and that of the requested capability.\nThe function should perform whatever logic, presumably linear, to validate the request, and return the new managed value representing the ",(0,i.jsx)(a.code,{children:"balance"})," of the request."]}),"\n",(0,i.jsx)(a.p,{children:"Note that signatures scoped to a managed capability cause the capability to be automatically provisioned in a manner similar to how capabilities are installed with this function."}),"\n",(0,i.jsx)(a.p,{children:"By convention, capabilities are defined using all uppercase letters."}),"\n",(0,i.jsx)(a.h2,{id:"basic-syntax",children:"Basic syntax"}),"\n",(0,i.jsx)(a.p,{children:"To specify and provision a managed capability, use the following syntax:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:"(install-capability CAPABILITY)\n"})}),"\n",(0,i.jsx)(a.h2,{id:"arguments",children:"Arguments"}),"\n",(0,i.jsxs)(a.p,{children:["Use the following argument to specify the capability you want to install using the ",(0,i.jsx)(a.code,{children:"install-capability"})," Pact function."]}),"\n",(0,i.jsxs)(a.table,{children:[(0,i.jsx)(a.thead,{children:(0,i.jsxs)(a.tr,{children:[(0,i.jsx)(a.th,{children:"Argument"}),(0,i.jsx)(a.th,{children:"Type"}),(0,i.jsx)(a.th,{children:"Description"})]})}),(0,i.jsx)(a.tbody,{children:(0,i.jsxs)(a.tr,{children:[(0,i.jsx)(a.td,{children:(0,i.jsx)(a.code,{children:"CAPABILITY"})}),(0,i.jsx)(a.td,{children:"any"}),(0,i.jsx)(a.td,{children:"Specifies the capability to be installed."})]})})]}),"\n",(0,i.jsx)(a.h2,{id:"return-value",children:"Return value"}),"\n",(0,i.jsxs)(a.p,{children:["The ",(0,i.jsx)(a.code,{children:"install-capability"})," function returns a boolean value indicating the success or failure of the installation, along with a string message providing additional information."]}),"\n",(0,i.jsx)(a.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(a.p,{children:["The following example demonstrates how to use the ",(0,i.jsx)(a.code,{children:"install-capability"})," to install a capability named ",(0,i.jsx)(a.code,{children:"coin.TRANSFER"})," with specified parameters:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:"(install-capability (coin.TRANSFER ESCROW_ID merchant merchant-payout))\n"})}),"\n",(0,i.jsx)(a.p,{children:"The following example illustrates the definition for a capability with a management function and a managed parameter."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:'  (defcap TRANSFER:bool\n    ( id:string\n      sender:string\n      receiver:string\n      amount:decimal\n    )\n    @managed amount TRANSFER-mgr\n    (enforce-unit id amount)\n    (enforce (> amount 0.0) "Amount must be positive")\n    (compose-capability (DEBIT id sender))\n    (compose-capability (CREDIT id receiver))\n  )\n\n  (defun TRANSFER-mgr:decimal\n    ( managed:decimal\n      requested:decimal\n    )\n    (let ((newbal (- managed requested)))\n      (enforce (>= newbal 0.0)\n        (format "TRANSFER exceeded for balance {}" [managed]))\n      newbal)\n  )\n'})}),"\n",(0,i.jsxs)(a.p,{children:["The following example demonstrates the use of ",(0,i.jsx)(a.code,{children:"install-capability"})," in the Pact REPL to install a capability named ",(0,i.jsx)(a.code,{children:"PAY"})," with specified parameters:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-pact",children:'pact> (install-capability (PAY "alice" "bob" 10.0))\n'})}),"\n",(0,i.jsxs)(a.p,{children:["If the ",(0,i.jsx)(a.code,{children:"PAY"})," capability is installed successfully, the function returns a boolean value indicating success.\nIf the capability isn't installed, the function returns an error message indicating the reason for failure."]})]})}function p(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,a,n)=>{n.d(a,{R:()=>l,x:()=>c});var t=n(96540);const i={},s=t.createContext(i);function l(e){const a=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(s.Provider,{value:a},e.children)}}}]);