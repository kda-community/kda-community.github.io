"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[8902],{97152:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"api/service-api/mining","title":"Mining endpoints","description":"Provides reference information for the chainweb-node block endpoints.","source":"@site/docs/api/service-api/get-mining-work.md","sourceDirName":"api/service-api","slug":"/api/service-api/mining","permalink":"/docs/api/service-api/mining","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/api/service-api/get-mining-work.md","tags":[{"inline":true,"label":"chainweb","permalink":"/docs/tags/chainweb"},{"inline":true,"label":"node api","permalink":"/docs/tags/node-api"},{"inline":true,"label":"chainweb api","permalink":"/docs/tags/chainweb-api"},{"inline":true,"label":"api reference","permalink":"/docs/tags/api-reference"}],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Mining endpoints","description":"Provides reference information for the chainweb-node block endpoints.","id":"mining","sidebar_position":10,"tags":["chainweb","node api","chainweb api","api reference"]},"sidebar":"default","previous":{"title":"Get general node information","permalink":"/docs/api/service-api/get-node-info"},"next":{"title":"Data models","permalink":"/docs/api/data-models"}}');var t=s(74848),r=s(28453);const o={title:"Mining endpoints",description:"Provides reference information for the chainweb-node block endpoints.",id:"mining",sidebar_position:10,tags:["chainweb","node api","chainweb api","api reference"]},d="Mining endpoints",a={},h=[{value:"Get mining work",id:"get-mining-work",level:2},{value:"Request body schema",id:"request-body-schema",level:3},{value:"Responses",id:"responses",level:3},{value:"Response header",id:"response-header",level:4},{value:"Successful response schema",id:"successful-response-schema",level:4},{value:"Examples",id:"examples",level:3},{value:"Solved mining work",id:"solved-mining-work",level:2},{value:"Request body schema",id:"request-body-schema-1",level:3},{value:"Responses",id:"responses-1",level:3},{value:"Response header",id:"response-header-1",level:4},{value:"Examples",id:"examples-1",level:3},{value:"Notification of updated work",id:"notification-of-updated-work",level:2},{value:"Request body",id:"request-body",level:3},{value:"Responses",id:"responses-2",level:3},{value:"Response header",id:"response-header-2",level:4},{value:"Successful response schema",id:"successful-response-schema-1",level:4},{value:"Examples",id:"examples-2",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mining-endpoints",children:"Mining endpoints"})}),"\n",(0,t.jsx)(n.p,{children:"The Chainweb node mining API is disabled by default.\nYou must enable and configure the mining API in the node configuration file before you can use any of the mining endpoints."}),"\n",(0,t.jsx)(n.h2,{id:"get-mining-work",children:"Get mining work"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"GET https://{baseURL}/mining/work"})," to request a new block header to work on."]}),"\n",(0,t.jsx)(n.h3,{id:"request-body-schema",children:"Request body schema"}),"\n",(0,t.jsx)(n.p,{children:"Use the following parameters to specify the miner information."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"account"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Specifies the miner account name. Usually, this is the same as the public key."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"predicate"}),(0,t.jsx)(n.td,{children:"key\xa0predicate"}),(0,t.jsx)(n.td,{children:'Specifies the number of keys required from the enumerated values of the "keys-all", "keys-any", and "keys-2" key predicate options. For accounts with a single key, the predicate is usually "keys-all".'})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"public\u2011keys"}),(0,t.jsx)(n.td,{children:"Array\xa0of\xa0strings"}),(0,t.jsx)(n.td,{children:"Lists one or more miner public keys."})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"responses",children:"Responses"}),"\n",(0,t.jsxs)(n.p,{children:["Requests to ",(0,t.jsx)(n.code,{children:"GET https://{baseURL}/minig/work"})," return the following response codes:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"200 OK"})," indicates that the request was successful and the response is an encoded stream of data."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"response-header",children:"Response header"}),"\n",(0,t.jsx)(n.p,{children:"The response header parameters are the same for all successful and unsuccessful Chainweb node requests."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-peer-addr"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the host address and port number of the client as observed by the remote Chainweb node. The host address can be a domain name or an IP address in IPv4 or IPv6 format. For example: ",(0,t.jsx)(n.code,{children:'"10.36.1.3:42988"'}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-server\u2011timestamp"}),(0,t.jsx)(n.td,{children:"integer\xa0>=\xa00"}),(0,t.jsxs)(n.td,{children:["Specifies the clock time of the remote Chainweb node using the UNIX epoch timestamp. For example: ",(0,t.jsx)(n.code,{children:"1618597601"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x\u2011chainweb\u2011node\u2011version"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the version of the remote Chainweb node. For example: ",(0,t.jsx)(n.code,{children:'"2.23"'}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"successful-response-schema",children:"Successful response schema"}),"\n",(0,t.jsxs)(n.p,{children:["If the request is successful, the response returns ",(0,t.jsx)(n.code,{children:"application/octet-stream"})," content with the following:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"chainBytes"}),(0,t.jsx)(n.td,{children:"string\xa0binary"}),(0,t.jsx)(n.td,{children:"Identifies the chain selected by the node with four chain identifier bytes. This is informational. Generally, miners shouldn't care about the chain."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"targetBytes"}),(0,t.jsx)(n.td,{children:"string\xa0binary"}),(0,t.jsx)(n.td,{children:"Specifies the proof-of-work target for the current block in 32 proof-of-work target bytes. The proof-of-work hash of a valid block must not be larger than this value. For arithmetic comparisons, the hash-target and the proof-of-work hash are interpreted as unsigned 256-bit integral number in little endian encoding."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"headerBytes"}),(0,t.jsx)(n.td,{children:"string\xa0binary"}),(0,t.jsx)(n.td,{children:"Specifies the proof-of-work in 286 work header bytes. The last 8 bytes are the nonce. The creation time is encoded in bytes 44-52. Miners must not change or make any assumption about the other bytes. The creation time is encoded as little endian two complement integral number that counts SI microseconds since the start of the UNIX epoch (leap seconds are ignored). It always positive (highest bit is 0). Miners are free but not required to update the creation time. The value must be strictly larger than the creation time of the parent block and must not be in the future."})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"If you have enabled mining, you can send a request for work like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Postman",children:"GET https://us-e1.chainweb.com/chainweb/0.0/mainnet01/mining/work\n"})}),"\n",(0,t.jsx)(n.p,{children:"The request body should contain parameters similar to the following:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "account": "miner",\n    "predicate": "keys-all",\n    "public-keys": [\n        "f880a433d6e2a13a32b6169030f56245efdd8c1b8a5027e9ce98a88e886bef27"\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"If the request is successful, the response is an octet stream with:"}),"\n",(0,t.jsx)(n.p,{children:"Work bytes - (ChainBytes4 + TargetBytes32 + HeaderBytes286)"}),"\n",(0,t.jsxs)(n.p,{children:["This is the minimum information required to perform proof-of-work validation.\nNo knowledge of Chainweb internals is necessary.\nFor information about the encoding of work bytes, see ",(0,t.jsx)(n.a,{href:"/api/binary-encoding#work-header-binary-encoding",children:"Binary encoding"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"solved-mining-work",children:"Solved mining work"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"POST https://{basseURL}/mining/solved"})," to submit a solution for a new block."]}),"\n",(0,t.jsx)(n.h3,{id:"request-body-schema-1",children:"Request body schema"}),"\n",(0,t.jsxs)(n.p,{children:["The request body should be ",(0,t.jsx)(n.code,{children:"application/octet-stream"})," content with the solved proof-of-work work header bytes."]}),"\n",(0,t.jsxs)(n.p,{children:["The solved proof-of-work binary string of 286 bytes should consist of the original work received from the ",(0,t.jsx)(n.code,{children:"/mining/work"})," endpoint with updated nonce value such that it satisfies the proof-of-work puzzle.\nThe nonce is defined in the last 8 bytes of the work header bytes."]}),"\n",(0,t.jsxs)(n.p,{children:["The proof-of-work hash of a valid block is computed using blake2s.\nIt must not be larger than the proof-of-work target for the current block.\nThe target was received along with the work header bytes from the ",(0,t.jsx)(n.code,{children:"/mining/work"})," endpoint.\nFor arithmetic comparisons, the hash-target and the proof-of-work hash are interpreted as an unsigned 256-bit integral number in little endian encoding."]}),"\n",(0,t.jsx)(n.p,{children:"Miners can also update the creation time.\nHowever, the value must be strictly larger than the creation time of the parent block and must not be in the future."}),"\n",(0,t.jsx)(n.h3,{id:"responses-1",children:"Responses"}),"\n",(0,t.jsxs)(n.p,{children:["Requests to ",(0,t.jsx)(n.code,{children:"POST https://{baseURL}/mining/solved"})," return the following response codes:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"204 No Content"})," indicates that the request was successful and the proof-of-work solution is valid."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"response-header-1",children:"Response header"}),"\n",(0,t.jsx)(n.p,{children:"The response header parameters are the same for all successful and unsuccessful Chainweb node requests."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-peer-addr"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the host address and port number of the client as observed by the remote Chainweb node. The host address can be a domain name or an IP address in IPv4 or IPv6 format. For example: ",(0,t.jsx)(n.code,{children:'"10.36.1.3:42988"'}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-server\u2011timestamp"}),(0,t.jsx)(n.td,{children:"integer\xa0>=\xa00"}),(0,t.jsxs)(n.td,{children:["Specifies the clock time of the remote Chainweb node using the UNIX epoch timestamp. For example: ",(0,t.jsx)(n.code,{children:"1618597601"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x\u2011chainweb\u2011node\u2011version"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the version of the remote Chainweb node. For example: ",(0,t.jsx)(n.code,{children:'"2.23"'}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"examples-1",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"If you have enabled mining, you can submit a proof-of-work solution like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Postman",children:"POST https://us-e1.chainweb.com/chainweb/0.0/mainnet01/mining/solved\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The request body should be 286 bytes from the original work received from the ",(0,t.jsx)(n.code,{children:"/mining/work"})," endpoint with updated the nonce.\nIf the request is successful, you'll see the ",(0,t.jsx)(n.strong,{children:"204 No Content"})," response returned."]}),"\n",(0,t.jsx)(n.h2,{id:"notification-of-updated-work",children:"Notification of updated work"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"GET https://{baseURL}/mining/updates"})," to receive notifications from a server when new mining work becomes available."]}),"\n",(0,t.jsx)(n.p,{children:"This server-sent event stream is terminated by the server in regular intervals.\nIt's the responsibility of the miner to periodically request a new stream."}),"\n",(0,t.jsx)(n.h3,{id:"request-body",children:"Request body"}),"\n",(0,t.jsxs)(n.p,{children:["The request body should be ",(0,t.jsx)(n.code,{children:"application/octet-stream"})," content with the first four bytes\u2014the chain identifier bytes\u2014received from a call to the ",(0,t.jsx)(n.code,{children:"/mining/work"})," endpoint.\nWith this request body, Node only informs the miner of a new cut when the chain identified by the first four bytes has updated."]}),"\n",(0,t.jsx)(n.h3,{id:"responses-2",children:"Responses"}),"\n",(0,t.jsxs)(n.p,{children:["Requests to ",(0,t.jsx)(n.code,{children:"GET https://{baseURL}/mining/updates"})," return the following response code:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"200 OK"})," for each update event.\nEach event consists of a single line with the message ",(0,t.jsxs)(n.strong,{children:["event",":New"," Cut"]}),".\nEvents are separated by empty lines."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"response-header-2",children:"Response header"}),"\n",(0,t.jsx)(n.p,{children:"The response header parameters are the same for all successful and unsuccessful Chainweb node requests."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-peer-addr"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the host address and port number of the client as observed by the remote Chainweb node. The host address can be a domain name or an IP address in IPv4 or IPv6 format. For example: ",(0,t.jsx)(n.code,{children:'"10.36.1.3:42988"'}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x-server\u2011timestamp"}),(0,t.jsx)(n.td,{children:"integer\xa0>=\xa00"}),(0,t.jsxs)(n.td,{children:["Specifies the clock time of the remote Chainweb node using the UNIX epoch timestamp. For example: ",(0,t.jsx)(n.code,{children:"1618597601"}),"."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"x\u2011chainweb\u2011node\u2011version"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Specifies the version of the remote Chainweb node. For example: ",(0,t.jsx)(n.code,{children:'"2.23"'}),"."]})]})]})]}),"\n",(0,t.jsx)(n.h4,{id:"successful-response-schema-1",children:"Successful response schema"}),"\n",(0,t.jsxs)(n.p,{children:["If the request is successful, the response returns ",(0,t.jsx)(n.code,{children:"text/event-stream"})," content with the following:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"event"}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Indicates a chain update with the message event",":New"," Cut on a single line."]})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"examples-2",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"If you have enabled mining, you can request notification for chain updates like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Postman",children:"GET https://us-e1.chainweb.com/chainweb/0.0/mainnet01/mining/updates\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The request body should be ",(0,t.jsx)(n.code,{children:"application/octet-stream"})," content with the first four chain identifier bytes from a work header."]}),"\n",(0,t.jsx)(n.p,{children:"The server-send events look like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"[\n  event:New Cut\n\n  event:New Cut\n\n  event:New Cut\n]\n"})})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var i=s(96540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);