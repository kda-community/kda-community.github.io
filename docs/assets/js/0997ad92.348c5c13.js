"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[920],{5697:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"pact-5/general/enforce-verifier","title":"enforce-verifier","description":"Use enforce-verifier to enforce that a verifier plugin with the specified verifier-name is in scope.","source":"@site/docs/pact-5/general/enforce-verifier.md","sourceDirName":"pact-5/general","slug":"/pact-5/general/enforce-verifier","permalink":"/docs/pact-5/general/enforce-verifier","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/pact-5/general/enforce-verifier.md","tags":[],"version":"current","frontMatter":{},"sidebar":"default","previous":{"title":"enforce-pact-version","permalink":"/docs/pact-5/general/enforce-pact-version"},"next":{"title":"enforce","permalink":"/docs/pact-5/general/enforce"}}');var t=i(74848),s=i(28453);const a={},c="enforce-verifier",o={},d=[{value:"Basic syntax",id:"basic-syntax",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Return value",id:"return-value",level:2},{value:"Examples",id:"examples",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"enforce-verifier",children:"enforce-verifier"})}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," to enforce that a verifier plugin with the specified ",(0,t.jsx)(n.code,{children:"verifier-name"})," is in scope."]}),"\n",(0,t.jsxs)(n.p,{children:["Note that verifier plugins aren't implemented as Pact code.\nInstead, implementing a verifier plugin requires changes to the Chainweb protocol.\nFor information about the design and implementation of verifier plugins, see ",(0,t.jsx)(n.a,{href:"https://github.com/kadena-io/KIPs/blob/master/kip-0028.md",children:"KIP-0028: Pact Verifier Plugins"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"basic-syntax",children:"Basic syntax"}),"\n",(0,t.jsx)(n.p,{children:"To enforce that a specific verifier is in scope, use the following syntax:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:"(enforce-verifier verifier-name)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"arguments",children:"Arguments"}),"\n",(0,t.jsxs)(n.p,{children:["Use the following argument to specify the ",(0,t.jsx)(n.code,{children:"verifier-name"})," for the ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," Pact function:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Argument"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"verifier-name"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Specifies the name of the verifier to enforce."})]})})]}),"\n",(0,t.jsx)(n.h2,{id:"return-value",children:"Return value"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function returns a boolean value indicating whether the specified verifier is in scope."]}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsxs)(n.p,{children:["The following example demonstrates the use of a ",(0,t.jsx)(n.code,{children:"signed_list"})," verifier plugin that verifies signatures against structured message data to ensure the integrity and authenticity of messages provided to the ",(0,t.jsx)(n.code,{children:"mod"})," module in a smart contract."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:'(namespace "free")\n\n(module mod GOV\n  (defcap GOV () true)\n  (defcap MSG-GUARD (msg:list dst-fin-id:string)\n    (enforce-verifier "signed_list")\n  )\n\n  (defun inbox ()\n    (with-capability \n      (MSG-GUARD [["issue","finp2p","citi:102:d0c3eb56-0fff-4670-adfd-ad291a4314c3",\n           "finId","02fd7923740a775c95ce17e9bb7239ff9096689f70db9263a7efb9a9ad08e9fed7","1"]]\n         "02fd7923740a775c95ce17e9bb7239ff9096689f70db9263a7efb9a9ad08e9fed7")\n      )\n      1)\n)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, the capability MSG-GUARD uses the ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function with the ",(0,t.jsx)(n.code,{children:"signed_list"})," verifier plugin.\nThe arguments that are passed to the capability are then evaluated by the verifier to ensure the integrity and authenticity of the message.\nIf verification passed to the plugin fails, the capability isn't granted and the transaction fails."]}),"\n",(0,t.jsxs)(n.p,{children:["The following example illustrates using the ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function in the capability definition, then using the ",(0,t.jsx)(n.code,{children:"env-verifiers"}),' function in the Pact REPL to add the "COOLZK" and "HYPERCHAIN-BRIDGE" verifier plugins to the environment data.']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:'(module accounts GOV \n  (defcap GOV () true) \n  (defcap USER_GUARD (user:string) \n    (enforce-verifier "COOLZK"))\n  (defun create-user (user:string)\n    (with-capability USER_GUARD "rae")\n  )\n)\n(module bridge GOV \n  (defcap GOV () true) \n  (defcap MINT (coin:string amount:integer) \n    (enforce-verifier "HYPERCHAIN_BRIDGE"))\n)\n(env-verifiers [{\'name: "COOLZK", \'caps: [(accounts.USER_GUARD "my-account")]}, {\'name: "HYPERCHAIN-BRIDGE", \'caps: [(bridge.MINT "mycoin" 20)]}])\n'})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, the verifiers are loaded in the environment so that they are in scope for the ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:'enforce-verifier-test.repl:0:0-7:1:Trace: Loaded module accounts, hash NXmdjAMHjjJSh-JUwTlT0IsOwZiXg_ZytI8Q3B2Xz4o\nenforce-verifier-test.repl:8:0-12:1:Trace: Loaded module bridge, hash E2h3NLl5ePmKGvd8aNvFHyo-LONVsbxHXg8giuY3kuc\nenforce-verifier-test.repl:13:0-13:146:Trace: "Setting transaction verifiers/caps"\nLoad successful\n'})}),"\n",(0,t.jsxs)(n.p,{children:["If the required verifier plugins are in scope, the ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function returns ",(0,t.jsx)(n.code,{children:"true"}),".\nIf a verifier is not in scope, the function fails."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-pact",children:'pact> (enforce-verifier "COOLZK")\n<interactive>:0:0:Error: Verifier failure COOLZK: not in transaction\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"enforce-verifier"})," function provides a way to ensure that a specific verifier is available for use within a Pact contract."]}),"\n",(0,t.jsxs)(n.p,{children:["For more information about including verifier plugins in environment data for testing, see ",(0,t.jsx)(n.a,{href:"/pact-5/repl/env-verifiers",children:(0,t.jsx)(n.code,{children:"env-verifiers"})}),"."]})]})}function f(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>c});var r=i(96540);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);