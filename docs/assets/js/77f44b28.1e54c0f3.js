"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[1743],{63303:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>r});const c=JSON.parse('{"id":"reference/marmalade/conventional-sale","title":"Conventional auction reference","description":"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a conventional auction.","source":"@site/docs/reference/marmalade/conventional-auction-ref.md","sourceDirName":"reference/marmalade","slug":"/reference/marmalade/conventional-sale","permalink":"/docs/reference/marmalade/conventional-sale","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/reference/marmalade/conventional-auction-ref.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Conventional auction reference","description":"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a conventional auction.","id":"conventional-sale","sidebar_position":2}}');var t=i(74848),s=i(28453);const a={title:"Conventional auction reference",description:"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a conventional auction.",id:"conventional-sale",sidebar_position:2},o="Conventional auction sale contract",d={},r=[{value:"Capabilities",id:"capabilities",level:2},{value:"Schemas",id:"schemas",level:2},{value:"Tables",id:"tables",level:2},{value:"Functions",id:"functions",level:2},{value:"Constants",id:"constants",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"conventional-auction-sale-contract",children:"Conventional auction sale contract"})}),"\n",(0,t.jsx)(n.p,{children:"This section provides reference information for writing a smart contract to conduct a conventional auction using Marmalade on the Kadena network.\nThe reference information includes the capabilities, schemas, tables, functions, and constants defined for a conventional auction."}),"\n",(0,t.jsxs)(n.p,{children:["Source code: ",(0,t.jsx)(n.a,{href:"https://github.com/kadena-io/marmalade/blob/main/pact/sale-contracts/conventional-auction/conventional-auction.pact",children:"conventional-auction.pact"})]}),"\n",(0,t.jsx)(n.h2,{id:"capabilities",children:"Capabilities"}),"\n",(0,t.jsx)(n.p,{children:"The conventional auction smart contract defines the following capabilities to manage permissions:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"GOVERNANCE"}),": Defines governance for the contract and is controlled by the keyset defined under the ",(0,t.jsx)(n.code,{children:"ADMIN-KS"})," constant."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AUCTION_CREATED"}),": Specifies the event emitted when the ",(0,t.jsx)(n.code,{children:"create-auction"})," function is executed. The emitted event includes the ",(0,t.jsx)(n.code,{children:"sale-id"}),", ",(0,t.jsx)(n.code,{children:"token-id"}),", and  ",(0,t.jsx)(n.code,{children:"escrow"})," fields."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"MANAGE_AUCTION"}),":  Identifies a guard to control who can create and update an auction. You must specify the ",(0,t.jsx)(n.code,{children:"sale-id"})," and ",(0,t.jsx)(n.code,{children:"token-id"})," parameters when you use this capability in ",(0,t.jsx)(n.code,{children:"create-auction"})," and ",(0,t.jsx)(n.code,{children:"update-auction"})," functions."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"BID_PLACED"}),": Specifies the event emitted when a bid is place. The emitted event includes the ",(0,t.jsx)(n.code,{children:"bidder?"}),", ",(0,t.jsx)(n.code,{children:"bid-amount"}),", and  ",(0,t.jsx)(n.code,{children:"timestamp"})," fields."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PLACE_BID"}),": Ensures that the bidder signs the transaction to place the bid."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"REFUND_CAP"}),": Protects funds held in escrow to ensure refunds can be made, if necessary."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"schemas",children:"Schemas"}),"\n",(0,t.jsx)(n.p,{children:"The conventional auction smart contract defines two schemas."}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"auctions-schema"})," describes the following information for a conventional auction:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"token-id"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"start-date"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"end-date"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"highest-bid"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"highest-bid-id"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"reserve-price"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"bids-schema"})," describes the following information for a conventional auction:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"bidder"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"bidder-guard"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"bid"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"tables",children:"Tables"}),"\n",(0,t.jsxs)(n.p,{children:["The conventional auction contract stores auction information in the ",(0,t.jsx)(n.code,{children:"auctions"})," table and bid information in the ",(0,t.jsx)(n.code,{children:"bids"})," table."]}),"\n",(0,t.jsx)(n.h2,{id:"functions",children:"Functions"}),"\n",(0,t.jsx)(n.p,{children:"The conventional auction contract defines the following functions to manage token sales using the conventional auction format:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"escrow-account"}),": Returns the auction's fungible escrow account name."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"escrow-guard"}),": Returns the account guard of the escrow account."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enforce-fungible-transfer"}),": Requires that ",(0,t.jsx)(n.code,{children:"policy-manager.FUNGIBLE_TRANSFER_CALL"})," capability is in scope."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enforce-quote-update"}),": Enforces a quote update when required for sale contracts. This function is called by the ",(0,t.jsx)(n.code,{children:"policy-manager.enforce-buy"})," function to validate that only the winning bidder processes the ",(0,t.jsx)(n.code,{children:"marmalade.buy"})," call, the escrow payment, and the marketplace fee."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"enforce-withdrawal"}),": Enforces a withdrawal when required for sale contracts. This function is called by the ",(0,t.jsx)(n.code,{children:"policy-manager.enforce-withdraw"})," function to validate that the auction has expired, or that the bid has already been placed."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"create-bid-id"}),": Generates a unique bid identifier by hashing the ",(0,t.jsx)(n.code,{children:"sale-id"}),", ",(0,t.jsx)(n.code,{children:"bidder"}),", and ",(0,t.jsx)(n.code,{children:"block-time"})," fields."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"create-auction"}),": Allows sellers to create a conventional auction for their token after providing auction information."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"update-auction"}),": Allows sellers to update auction information before the auction start time."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"retrieve-auction"}),": Retrieves auction information from the ",(0,t.jsx)(n.code,{children:"auctions"})," table."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"retrieve-bid"}),": Retrieves bid information from the ",(0,t.jsx)(n.code,{children:"bids"})," table."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"place-bid"}),": Transfers the bid amount in a fungible currency from the bidder account to an escrow account and records the bids in the blockchain."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"constants",children:"Constants"}),"\n",(0,t.jsx)(n.p,{children:"The conventional auction contract defines the following constant:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ADMIN-KS"}),": Sets the ",(0,t.jsx)(n.code,{children:"marmalade-sale.marmalade-contract-admin"})," for the ",(0,t.jsx)(n.code,{children:"GOVERNANCE"})," capability."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var c=i(96540);const t={},s=c.createContext(t);function a(e){const n=c.useContext(s);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),c.createElement(s.Provider,{value:n},e.children)}}}]);