"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[4561],{53107:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"reference/latency","title":"Chainweb execution and latency","description":"Benchmarks and calculations to help you understand expected execution times.","source":"@site/docs/reference/latency.md","sourceDirName":"reference","slug":"/reference/latency","permalink":"/docs/reference/latency","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/reference/latency.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Chainweb execution and latency","description":"Benchmarks and calculations to help you understand expected execution times.","id":"latency","sidebar_position":5},"sidebar":"default","previous":{"title":"Chainweb bootstrap nodes","permalink":"/docs/reference/bootstrap"},"next":{"title":"Guard JSON representation","permalink":"/docs/reference/guard-json"}}');var o=t(74848),i=t(28453);const s={title:"Chainweb execution and latency",description:"Benchmarks and calculations to help you understand expected execution times.",id:"latency",sidebar_position:5},c="Chainweb execution and latency",r={},h=[{value:"Single chain transactions",id:"single-chain-transactions",level:2},{value:"Cross-chain transfers",id:"cross-chain-transfers",level:2},{value:"Local execution",id:"local-execution",level:2},{value:"Block production",id:"block-production",level:2},{value:"Block parents and orphans",id:"block-parents-and-orphans",level:3},{value:"Block height and payload",id:"block-height-and-payload",level:3},{value:"Mining work",id:"mining-work",level:3},{value:"Mining per block",id:"mining-per-block",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"chainweb-execution-and-latency",children:"Chainweb execution and latency"})}),"\n",(0,o.jsx)(n.p,{children:"There are a number of factors that influence the time it takes to execute transactions, including network topology and the performance of individual nodes.\nThis section provides benchmarks, estimations, and calculations to help you better understand the time it takes to execute transactions on Chainweb nodes under different circumstances."}),"\n",(0,o.jsx)(n.h2,{id:"single-chain-transactions",children:"Single chain transactions"}),"\n",(0,o.jsx)(n.p,{children:"On average, single chain transactions take approximately 45 seconds.\nHowever, transactions can take much longer than 45 seconds, in particular, if there are mining delays."}),"\n",(0,o.jsxs)(n.p,{children:["To give you better insight into how transactions are executed, the following example describes the workflow for a single chain transaction.\nYou start a transaction by submitting a formatted request to the ",(0,o.jsx)(n.code,{children:"/send"})," endpoint on a node.\nThe code provided by the ",(0,o.jsx)(n.code,{children:"/send"})," endpoint performs some simple initial checks that validate the transaction has a reasonably high chance of being executed successfully.\nThese initial checks ensure that you learn if a transaction is invalid as soon as possible.\nIf the transaction passes the initial checks, the ",(0,o.jsx)(n.code,{children:"/send"})," process adds the transaction to the mempool for the local node.\nThe transaction is then gossiped to remote nodes, and, eventually, one of the nodes is selected to mine the next block, and the node includes the transaction in that block.\nAfter the mined block is added to its target chain, the block with the transaction result is synchronized on the local node, and a request to the ",(0,o.jsx)(n.code,{children:"/poll"})," endpoint returns the transaction result."]}),"\n",(0,o.jsxs)(n.p,{children:["Under normal load, the initial checks should take less than a millisecond for a single transaction.\nHowever, if a node in under heavy load\u2014for example, because the PactService is contending with a high volume of ",(0,o.jsx)(n.code,{children:"/local"})," or ",(0,o.jsx)(n.code,{children:"/send"})," calls or because the node is catching up\u2014you might experience delays in sending or polling transactions.\nIt's worth noting that if a node is too busy, it will always prioritize staying caught up over sending transactions."]}),"\n",(0,o.jsx)(n.p,{children:"The propagation of transactions in the mempool to other nodes takes, on average, 10 seconds, but it can take longer if there are networking delays, such as increased network traffic or slow network connections between nodes.\nBlock propagation back to the local node is usually a matter of seconds."}),"\n",(0,o.jsx)(n.h2,{id:"cross-chain-transfers",children:"Cross-chain transfers"}),"\n",(0,o.jsxs)(n.p,{children:["As discussed in ",(0,o.jsx)(n.a,{href:"/smart-contracts/transactions",children:"Transaction format and flow"}),", a cross-chain transfer is essentially two separate but related transactions.\nThe time it takes to complete a cross-chain transfer can depend on several factors, including the physical distance between the chain nodes in the network, network congestion, and the synchronization of state between the chains involved."]}),"\n",(0,o.jsx)(n.p,{children:"For two distant chains\u2014representing the worst case\u2014a cross-chain transfer is expected to take the following time to complete:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"The initiating transaction has an average time from submission to completion of 45 seconds."}),"\n",(0,o.jsx)(n.li,{children:"With the current 20-chain graph, two blocks at most must be propagated to the target chain so that the source and target chain share the same view of state, with an average time of 30 seconds per block.\nThe number of blocks that must be propagated will increase as more chains are added, and will depend on the distance between the chains."}),"\n",(0,o.jsx)(n.li,{children:"The continuation step is a second transaction, again with an average time of 45 seconds."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Therefore, a cross-chain transfer typically takes 2 minutes and 30 seconds to complete.\nIf either the source or target chain is ahead of the other chain, more blocks might be required to synchronize the chains before the transaction can complete, in which case the transfer might take additional time."}),"\n",(0,o.jsx)(n.h2,{id:"local-execution",children:"Local execution"}),"\n",(0,o.jsxs)(n.p,{children:["In general, calls to the Chainweb ",(0,o.jsx)(n.code,{children:"/local"})," endpoint return results almost immediately.\nDepending on how long it takes to execute the Pact code in a transaction, you can typically expect to see results from ",(0,o.jsx)(n.code,{children:"/local"})," call within seconds, at most.\nHowever, it's important to know that ",(0,o.jsx)(n.code,{children:"/local"})," calls are executed on a single chain and served in a single-threaded, first-come-first-served basis.\nIf a node is under contention\u2014because it's catching up with state, busy processing multiple ",(0,o.jsx)(n.code,{children:"/local"})," calls, or performing mempool checks\u2014execution could take as long as needed for the request to be serviced in the queue."]}),"\n",(0,o.jsx)(n.h2,{id:"block-production",children:"Block production"}),"\n",(0,o.jsx)(n.p,{children:"On average, producing a block takes 30 seconds.\nThe actual time it takes to produce any given block depends on the time required to prepare the block for mining, and the time it takes to mine the block.\nBefore a block can be mined on any chain, it must satisfy specific requirements."}),"\n",(0,o.jsx)(n.p,{children:"To give you better insight into how blocks are produced, the following example describes the workflow and requirements for mining a block.\nFor this example, the target chain for the block is chain 1 on a Kadena network with 20 chains."}),"\n",(0,o.jsx)(n.p,{children:"To start block production on chain 1, the new block candidate must provide the following inputs:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"The block header for a block that exists on chain 1 to serve as the parent of the new block."}),"\n",(0,o.jsx)(n.li,{children:"The block headers for the parent block of the new block on the adjacent chains, which are currently chains 6, 11, and 18 for chain 1."}),"\n",(0,o.jsx)(n.li,{children:"The sequence of transactions in the new block and the output from running the transactions in the new block."}),"\n",(0,o.jsx)(n.li,{children:"The nonce and creation time for the new block, which are set by the miner."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"block-parents-and-orphans",children:"Block parents and orphans"}),"\n",(0,o.jsxs)(n.p,{children:["If the block selected to serve as the parent of the new candidate block is superseded by the arrival of a new block on the target chain, the block production process must start over with the new parent block.\nIf the block production process starts over, the new block candidate that was being processed is no longer valid for the continuity of the chain and is deemed an ",(0,o.jsx)(n.strong,{children:"orphaned"})," block."]}),"\n",(0,o.jsx)(n.h3,{id:"block-height-and-payload",children:"Block height and payload"}),"\n",(0,o.jsx)(n.p,{children:"The next step in the block production process involves two requirements that are satisfied in parallel."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The first requirement is to determine whether the chains that are adjacent to the target chain in the chain graph have any blocks at the same height as the parent block.\nIf the adjacent chains have blocks at the same height as the parent block, a new block can be created while satisfying the braiding requirement of the Chainweb protocol."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The second requirement is to produce the block payload on the target chain.\nProducing the payload involves querying the mempool for a set of transactions that can fit in the block, and executing those transactions on the Pact state.\nCurrently, the gas limit for a block is 150000, and each unit of gas can represent up to 2.5 microseconds of execution time, leading to a maximum execution time of 375 milliseconds.\nHowever, node contention can increase the maximum execution time up to 600 milliseconds."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"mining-work",children:"Mining work"}),"\n",(0,o.jsx)(n.p,{children:"After the block production requirements are met\u2014that is, the block payload, parent block, and the adjacent parent blocks have been validated\u2014the new block can be mined and added to the target chain."}),"\n",(0,o.jsxs)(n.p,{children:["Miners make a request to the node and can receive a new block on any chain that has a new block ready.\nMining time follows an ",(0,o.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Exponential_distribution",children:"exponential distribution"})," where the mean time is such that the average ",(0,o.jsx)(n.em,{children:"total"})," block time is 30 seconds.\nBecause other parts of the block production process take some time as well, mining time will actually be less than 30 seconds on average."]}),"\n",(0,o.jsx)(n.p,{children:"After mining is successful, the new block candidate is added to the target chain on the mining node, and then sent around the chainweb network for other nodes to see."}),"\n",(0,o.jsx)(n.h2,{id:"mining-per-block",children:"Mining per block"}),"\n",(0,o.jsx)(n.p,{children:"Mining a block takes 16 seconds on average with the current 20-chain graph.\nWith the average block production time of 30 seconds and the current 20-chain graph, mining accounts for roughly half of the time it takes to advance each chain by one block.\nThe average time it takes to mine a block is likely decrease as more chains are added.\nHowever, the total block production time is expected to remain about 30 seconds on average because chains might spend more time blocked from creating new blocks.\nIn most cases, this delay is caused by adjacent chains that have not yet advanced to the block height required for the target chain to add a new block."})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var a=t(96540);const o={},i=a.createContext(o);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);