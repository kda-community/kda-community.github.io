"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[2673],{2797:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"api/pact-api/local","title":"Simulate a transaction","description":"Provides reference information for the Pact /local endpoint.","source":"@site/docs/api/pact-api/local.md","sourceDirName":"api/pact-api","slug":"/api/pact-api/local","permalink":"/docs/api/pact-api/local","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/api/pact-api/local.md","tags":[{"inline":true,"label":"chainweb","permalink":"/docs/tags/chainweb"},{"inline":true,"label":"node api","permalink":"/docs/tags/node-api"},{"inline":true,"label":"chainweb api","permalink":"/docs/tags/chainweb-api"},{"inline":true,"label":"api reference","permalink":"/docs/tags/api-reference"}],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Simulate a transaction","description":"Provides reference information for the Pact /local endpoint.","id":"local","sidebar_position":3,"tags":["chainweb","node api","chainweb api","api reference"]},"sidebar":"default","previous":{"title":"Listen for a single transaction","permalink":"/docs/api/pact-api/listen"},"next":{"title":"Poll for transaction results","permalink":"/docs/api/pact-api/poll"}}');var i=t(74848),a=t(28453);const r={title:"Simulate a transaction",description:"Provides reference information for the Pact /local endpoint.",id:"local",sidebar_position:3,tags:["chainweb","node api","chainweb api","api reference"]},d="Simulate a transaction",c={},l=[{value:"Request format",id:"request-format",level:2},{value:"Path parameters",id:"path-parameters",level:3},{value:"Query parameters",id:"query-parameters",level:3},{value:"Request body schema",id:"request-body-schema",level:3},{value:"Responses",id:"responses",level:2},{value:"Examples",id:"examples",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"simulate-a-transaction",children:"Simulate a transaction"})}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint to submit a command to simulate the execution of a transaction.\nRequests sent to the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint don't change the blockchain state.\nAny database writes or changes to the environment are rolled back.\nYou can use this type of call to perform a node-local \u201cdirty read\u201d for testing purposes or as a dry-run to validate a transaction.\nThe request body must contain a properly-formatted Pact command.\nIn response to the request, the endpoint returns the command result and hash."]}),"\n",(0,i.jsx)(n.h2,{id:"request-format",children:"Request format"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.code,{children:"POST http://{baseUrl}/chain/{chain}/pact/api/v1/local/"})," endpoint to submit a command to simulate the execution of a transaction."]}),"\n",(0,i.jsx)(n.h3,{id:"path-parameters",children:"Path parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"chain\xa0(required)"}),(0,i.jsx)(n.td,{children:"integer\xa0>=\xa00"}),(0,i.jsxs)(n.td,{children:["Specifies the chain identifier of the chain you want to send the request to. Valid values are 0 to 19. For example, to submit the command on the first chain (0), the request is ",(0,i.jsx)(n.code,{children:"POST http://{baseURL}/chain/0/pact/api/v1/local"}),"."]})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"query-parameters",children:"Query parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"preflight"})}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"Trigger a fully-gassed mainnet transaction execution simulation and transaction metadata validation."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"rewindDepth"})}),(0,i.jsx)(n.td,{children:"integer >= 0"}),(0,i.jsx)(n.td,{children:"Rewind transaction execution environment by a specified number of block heights."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"signatureVerification"})}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"Require user signature verification when validating the transaction metadata."})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"request-body-schema",children:"Request body schema"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"cmd"})," (required)"]}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Stringified JSON payload object with signed transaction data that can't be modified."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"hash"})," (required)"]}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["An unpadded base64Url-encoded string created using the Blake2s-256 hash function for the ",(0,i.jsx)(n.code,{children:"cmd"})," field value. Serves as a command request key because each transaction must be unique."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"sigs"})," (required)"]}),(0,i.jsx)(n.td,{children:"Array of objects"}),(0,i.jsx)(n.td,{children:"List of signatures corresponding one-to-one with the signers array in the payload."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"responses",children:"Responses"}),"\n",(0,i.jsxs)(n.p,{children:["Requests to ",(0,i.jsx)(n.code,{children:"POST http://{baseURL}/chain/{chain}/pact/api/v1/local"})," return the following response codes:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"200 OK"})," indicates that the request succeeded and the response body includes either the command results or the preflight results."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"400 Bad Request"})," indicates that the request failed. The response returns ",(0,i.jsx)(n.code,{children:"text/plain"})," content with information about why the command couldn't be executed. For example, the response might indicate that the command wasn't executed because the request body specified an invalid gas payer, was missing required metadata, or there were other environment issues."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If the request is successful, the response returns ",(0,i.jsx)(n.code,{children:"application/json"})," content with the following information:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"reqKey"})," (required)"]}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Unique identifier for the Pact transaction. The transaction hash is a base64Url-encoded string that consists of 43 characters from the [",(0,i.jsx)(n.code,{children:"a-zA-Z0-9_-"}),"] character set."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"result"})," (required)"]}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Success (object) or Failure (object)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"txId"})}),(0,i.jsx)(n.td,{children:"number"}),(0,i.jsx)(n.td,{children:"Database-internal transaction tracking identifier."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"logs"})," (required)"]}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Backend-specific value providing an image of database logs."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"metaData"})," (required)"]}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Metadata included with the transaction."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"events"})}),(0,i.jsx)(n.td,{children:"Array of objects"}),(0,i.jsx)(n.td,{children:"Array of event objects."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"continuation"})}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsxs)(n.td,{children:["Describes the result of a ",(0,i.jsx)(n.code,{children:"defpact"})," execution."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"gas"})," (required)"]}),(0,i.jsx)(n.td,{children:"number"}),(0,i.jsx)(n.td,{children:"Gas required to execute the transaction."})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["If you specify the ",(0,i.jsx)(n.code,{children:"preflight"})," query parameter, the command results include the following additional parameters:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"preflightResult"})," (required)"]}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"The result of attempting to execute a single well-formed Pact command."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"preflightWarnings"})," (required)"]}),(0,i.jsx)(n.td,{children:"Array of strings"}),(0,i.jsx)(n.td,{children:"A list of warnings associated with deprecated features in upcoming Pact releases."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["You can send a request to the Kadena test network and chain 1 by calling the ",(0,i.jsx)(n.code,{children:"/local"})," endpoint like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Postman",children:"POST http://api.testnet.chainweb.com/chainweb/0.0/testnet04/chain/1/pact/api/v1/local/\n"})}),"\n",(0,i.jsx)(n.p,{children:"The request body for this example looks like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{"cmd":"{\\"signers\\":[{\\"pubKey\\":\\"1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4\\",\\"clist\\":[{\\"name\\":\\"coin.TRANSFER\\",\\"args\\":[\\"k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4\\",\\"k:4fe7981d36997c2a327d0d3ce961d3ae0b2d38185ac5e5cd98ad90140bc284d0\\",3]},{\\"name\\":\\"coin.GAS\\",\\"args\\":[]}]}],\\"meta\\":{\\"creationTime\\":1726525836,\\"ttl\\":32441,\\"chainId\\":\\"1\\",\\"gasPrice\\":1.9981e-7,\\"gasLimit\\":2320,\\"sender\\":\\"k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4\\"},\\"nonce\\":\\"chainweaver\\",\\"networkId\\":\\"testnet04\\",\\"payload\\":{\\"exec\\":{\\"code\\":\\"(coin.transfer \\\\\\"k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4\\\\\\" \\\\\\"k:4fe7981d36997c2a327d0d3ce961d3ae0b2d38185ac5e5cd98ad90140bc284d0\\\\\\" 3.0)\\",\\"data\\":null}}}","hash":"SLiinT5fAv8eCixT9qwbBHZgO4HxVB-p5rYyt_AxG94","sigs":[{"sig":"34de39e545f03116e7c8c1150e62be29874e0efd0e24ea906cb6cbd5adef28b137c01a85ac883489c7757f9335276ec360734ff74d98e195079d391a9105020d"}]}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The request returns command results similar to the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "gas": 509,\n    "result": {\n        "status": "success",\n        "data": "Write succeeded"\n    },\n    "reqKey": "SLiinT5fAv8eCixT9qwbBHZgO4HxVB-p5rYyt_AxG94",\n    "logs": "wsATyGqckuIvlm89hhd2j4t6RMkCrcwJe_oeCYr7Th8",\n    "events": [\n        {\n            "params": [\n                "k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4",\n                "k:4fe7981d36997c2a327d0d3ce961d3ae0b2d38185ac5e5cd98ad90140bc284d0",\n                3\n            ],\n            "name": "TRANSFER",\n            "module": {\n                "namespace": null,\n                "name": "coin"\n            },\n            "moduleHash": "klFkrLfpyLW-M3xjVPSdqXEMgxPPJibRt_D6qiBws6s"\n        }\n    ],\n    "metaData": {\n        "publicMeta": {\n            "creationTime": 1726525836,\n            "ttl": 32441,\n            "gasLimit": 2320,\n            "chainId": "1",\n            "gasPrice": 1.9981e-7,\n            "sender": "k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4"\n        },\n        "blockTime": 1726526473352615,\n        "prevBlockHash": "ubbt1utj-jVkNwAVCbqYduESQVlJwWwSipJOrRlXJJg",\n        "blockHeight": 4651215\n    },\n    "continuation": null,\n    "txId": null\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You can specify the ",(0,i.jsx)(n.code,{children:"preflight"})," query parameter in the API request like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Postman",children:"http://api.testnet.chainweb.com/chainweb/0.0/testnet04/chain/1/pact/api/v1/local/?preflight=true\n"})}),"\n",(0,i.jsx)(n.p,{children:"The request returns preflight results similar to the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "preflightResult": {\n        "gas": 734,\n        "result": {\n            "status": "success",\n            "data": "Write succeeded"\n        },\n        "reqKey": "SLiinT5fAv8eCixT9qwbBHZgO4HxVB-p5rYyt_AxG94",\n        "logs": "aN6GME-Oea_smnQOrTozgww0Z81WFu_u3env3k8ksEc",\n        "events": [\n            {\n                "params": [\n                    "k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4",\n                    "NoMiner",\n                    1.4666054e-4\n                ],\n                "name": "TRANSFER",\n                "module": {\n                    "namespace": null,\n                    "name": "coin"\n                },\n                "moduleHash": "klFkrLfpyLW-M3xjVPSdqXEMgxPPJibRt_D6qiBws6s"\n            },\n            {\n                "params": [\n                    "k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4",\n                    "k:4fe7981d36997c2a327d0d3ce961d3ae0b2d38185ac5e5cd98ad90140bc284d0",\n                    3\n                ],\n                "name": "TRANSFER",\n                "module": {\n                    "namespace": null,\n                    "name": "coin"\n                },\n                "moduleHash": "klFkrLfpyLW-M3xjVPSdqXEMgxPPJibRt_D6qiBws6s"\n            }\n        ],\n        "metaData": {\n            "publicMeta": {\n                "creationTime": 1726525836,\n                "ttl": 32441,\n                "gasLimit": 2320,\n                "chainId": "1",\n                "gasPrice": 1.9981e-7,\n                "sender": "k:1d5a5e10eb15355422ad66b6c12167bdbb23b1e1ef674ea032175d220b242ed4"\n            },\n            "blockTime": 1726526253258103,\n            "prevBlockHash": "jQi8HNy73w1JxjdqTkkJnFZW7_lGYo2eHEmqxKNUBsM",\n            "blockHeight": 4651209\n        },\n        "continuation": null,\n        "txId": 6476127\n    },\n    "preflightWarnings": []\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var s=t(96540);const i={},a=s.createContext(i);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);