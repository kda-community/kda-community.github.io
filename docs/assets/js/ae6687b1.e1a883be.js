"use strict";(self.webpackChunkkadena_docs=self.webpackChunkkadena_docs||[]).push([[7849],{27579:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>o});const c=JSON.parse('{"id":"reference/marmalade/dutch-sale","title":"Dutch auction reference","description":"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a dutch auction.","source":"@site/docs/reference/marmalade/dutch-auction-ref.md","sourceDirName":"reference/marmalade","slug":"/reference/marmalade/dutch-sale","permalink":"/docs/reference/marmalade/dutch-sale","draft":false,"unlisted":false,"editUrl":"https://github.com/kda-community/kadena-docs-new/blob/master/docs/reference/marmalade/dutch-auction-ref.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Dutch auction reference","description":"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a dutch auction.","id":"dutch-sale","sidebar_position":3}}');var i=t(74848),a=t(28453);const s={title:"Dutch auction reference",description:"Describes the capabilities, schemas, tables, functions, and constants defined in the sales-specific contracts for a dutch auction.",id:"dutch-sale",sidebar_position:3},r="Dutch auction sale contract",d={},o=[{value:"Capabilities",id:"capabilities",level:2},{value:"Schema and table",id:"schema-and-table",level:2},{value:"Functions",id:"functions",level:2},{value:"Constants",id:"constants",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"dutch-auction-sale-contract",children:"Dutch auction sale contract"})}),"\n",(0,i.jsx)(n.p,{children:"This section provides reference information for writing a smart contract to conduct a dutch auction using Marmalade on the Kadena network.\nThe reference information includes the capabilities, schemas, tables, functions, and constants defined for a dutch auction."}),"\n",(0,i.jsxs)(n.p,{children:["Source code: ",(0,i.jsx)(n.a,{href:"https://github.com/kadena-io/marmalade/blob/main/pact/sale-contracts/dutch-auction/dutch-auction.pact",children:"dutch-auction.pact"})]}),"\n",(0,i.jsx)(n.h2,{id:"capabilities",children:"Capabilities"}),"\n",(0,i.jsx)(n.p,{children:"The dutch auction smart contract defines the following capabilities to manage permissions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"GOVERNANCE"}),": Defines governance for the contract and is controlled by the keyset defined under the ",(0,i.jsx)(n.code,{children:"ADMIN-KS"})," constant."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AUCTION_CREATED"}),": Specifies the event emitted after the auction is created by the seller."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"PRICE_ACCEPTED"}),": Specifies the event emitted after the buyer successfully executes the ",(0,i.jsx)(n.code,{children:"marmalade.buy"})," function in a sales contract."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DUMMY"}),": Acts as a placeholder capability for the ",(0,i.jsx)(n.code,{children:"buyer-guard"})," field."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"schema-and-table",children:"Schema and table"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"auctions-schema"})," describes the following information for a dutch auction:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"token-id"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"start-date"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"end-date"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"start-price"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"reserve-price"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"sell-price"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"price-interval-seconds"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"buyer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"buyer-guard"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The dutch auction contract stores auction information in the ",(0,i.jsx)(n.code,{children:"auctions"})," table."]}),"\n",(0,i.jsx)(n.h2,{id:"functions",children:"Functions"}),"\n",(0,i.jsx)(n.p,{children:"The dutch auction contract defines the following functions to manage token sales using the dutch auction format:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"enforce-quote-update"}),": Enforces a quote update when required for sale contracts. This function is called by the  ",(0,i.jsx)(n.code,{children:"policy-manager.enforce-buy"})," function to validate that the buyer has transferred the fungible amount equal to ",(0,i.jsx)(n.code,{children:"current-price"})," set by the dutch auction. The function updates the ",(0,i.jsx)(n.code,{children:"auctions"})," table with the winner information."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"enforce-withdrawal"}),": Enforces a withdrawal when required for sale contracts. This function is called by the ",(0,i.jsx)(n.code,{children:"policy-manager.enforce-withdraw"})," function to validate that the auction has expired, or that the bid has already been placed."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"validate-auction"}),": Validates that the auction information adheres to contract logic in the ",(0,i.jsx)(n.code,{children:"create-auction"})," and ",(0,i.jsx)(n.code,{children:"update-auction"})," functions."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create-auction"}),": Allows sellers to create the dutch auction for their token after providing auction information."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"update-auction"}),": Allows sellers to update auction information before the auction start time."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"retrieve-auction"}),": Retrieves auction information from the ",(0,i.jsx)(n.code,{children:"auctions"})," table."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"get-current-price"}),": Calculates the current auction price by starting with the ",(0,i.jsx)(n.code,{children:"start-price"})," and gradually reducing the price per ",(0,i.jsx)(n.code,{children:"price-interval-seconds"}),", always ending with the last time interval at the ",(0,i.jsx)(n.code,{children:"reserve-price"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"constants",children:"Constants"}),"\n",(0,i.jsx)(n.p,{children:"The dutch auction contract defines the following constants:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ADMIN-KS"}),": Sets the ",(0,i.jsx)(n.code,{children:"marmalade-sale.marmalade-contract-admin"})," for the ",(0,i.jsx)(n.code,{children:"GOVERNANCE"})," capability."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DUMMY_GUARD"}),": Acts as a placeholder guard constant for the ",(0,i.jsx)(n.code,{children:"buyer-guard"})," field."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var c=t(96540);const i={},a=c.createContext(i);function s(e){const n=c.useContext(a);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),c.createElement(a.Provider,{value:n},e.children)}}}]);