<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reference/marmalade/ledger" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Ledger contract | Kadena Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://kda-chain.org/docs/img/kadena-opengraph.png"><meta data-rh="true" property="og:url" content="https://kda-chain.org/docs/reference/marmalade/ledger"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ledger contract | Kadena Docs"><meta data-rh="true" name="description" content="Functions and capabilities defined in the Marmalade Ledger contract enable you to manage the token lifecycle and keep track of all token-related activity."><meta data-rh="true" property="og:description" content="Functions and capabilities defined in the Marmalade Ledger contract enable you to manage the token lifecycle and keep track of all token-related activity."><link data-rh="true" rel="icon" href="/docs/img/kadena-favicon.png"><link data-rh="true" rel="canonical" href="https://kda-chain.org/docs/reference/marmalade/ledger"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/reference/marmalade/ledger" hreflang="en"><link data-rh="true" rel="alternate" href="https://kda-chain.org/docs/reference/marmalade/ledger" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6UVWQF4IS8-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Kadena Docs" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.01d78354.css">
<script src="/docs/assets/js/runtime~main.2ef1040c.js" defer="defer"></script>
<script src="/docs/assets/js/main.9cf849d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/kadena-docs-light.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="196"><img src="/docs/img/kadena-docs-dark.png" alt="Kadena Documentation" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="196"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/quickstart">Get Started</a><a href="https://discord.com/invite/kadena" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kda-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link-icon"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ledger contract</h1></header>
<p>The Marmalade token standard provides interfaces that enable you to define, mint, and secure tokens.
As discussed in <a href="/docs/reference/marmalade/token-standard-architecture">Token standard architecture</a>, the Marmalade ledger contract provides the core functionality to create, manage, and transfer tokens minted using the Marmalade token standard.
The ledger contract records and manages all token-related activity to ensure every transaction is accurate, every policy is enforced, and every account is up-to-date.</p>
<p>This part of the documentation describes the functions and capabilities defined in the Marmalade ledger contract in the <code>marmalade-v2</code> namespace.
The  <code>marmalade-v2</code> namespace is available on all twenty chains (0-19) in the Kadena test network and the Kadena main network.</p>
<p>Source code: <a href="https://github.com/kadena-io/marmalade/blob/main/pact/ledger/ledger.pact" target="_blank" rel="noopener noreferrer">ledger.pact</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-token-id">create-token-id<a href="#create-token-id" class="hash-link" aria-label="Direct link to create-token-id" title="Direct link to create-token-id">​</a></h2>
<p>Use <code>create-token-id</code> to generate a unique token identifier with the specified token identifier.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments">Arguments<a href="#arguments" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to create the token identifier.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>details</code></td><td>object</td><td>Defines token properties using the metadata schema in JSON file format.</td></tr><tr><td><code>creation-guard</code> </td><td>guard</td><td>Specifies the temporary guard—for example, a keyset—used to generate the token identifier. This guard isn&#x27;t stored and ensure that only the  owner of the creation key can create a specific token identifier.</td></tr></tbody></table>
<p>Before creating a token, you must choose a temporary guard.
The guard can be</p>
<ul>
<li>A keyset you&#x27;ve already defined or used in the guard-policy.</li>
<li>A single-use keyset that won&#x27;t be used again.</li>
<li>Another type guard.</li>
</ul>
<p>This guard becomes part of the hashed data in the <code>token-id</code> string prefixed with <code>t:</code>.
Including the guard in the hashed token identifier protects anyone else from creating the token.
With this mechanism, only you—as the owner of the creation key—can create the token specified by the <code>token-id</code> string.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<p>Generate a unique <code>token-id</code> by calling the following function:</p>
<p><code>(ledger.create-token-id details creation-guard)</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-token">create-token<a href="#create-token" class="hash-link" aria-label="Direct link to create-token" title="Direct link to create-token">​</a></h2>
<p>Use <code>create-token</code> to create a token with the specified token identifier.
You can apply one or more policies to a token when you create it.
Depending on the policies you apply, you might need to grant additional capabilities or pass environment data to execute the function.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-1">Arguments<a href="#arguments-1" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to create a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using the <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>precision</code></td><td>integer</td><td>Specifies the number of decimals allowed for the token supply amount. For non-fungible tokens, the precision must be 0, and should be enforced in the policy&#x27;s <code>enforce-init</code>.</td></tr><tr><td><code>uri</code></td><td>string</td><td>Specifies the uniform resource identifier (uri) to an external JSON file containing token metadata.</td></tr><tr><td><code>policies</code></td><td>list</td><td>Specifies one or more policy contracts with custom functions to execute at marmalade functions.</td></tr><tr><td><code>creation-guard</code></td><td>guard</td><td>Specifies the temporary guard—for example, a keyset—used to generate the token identifier. This guard isn&#x27;t stored and ensure that only the  owner of the creation key can create a specific token identifier.</td></tr></tbody></table>
<p>When you submit the <code>create-token</code> transaction, the <code>policy-manager.enforce-init</code> function calls the <code>policy:enforce-init</code> function in the stored token policies and the function is executed.</p>
<p>To create a token with this function:</p>
<ul>
<li>Generate a unique <code>token-id</code> by calling <code>(ledger.create-token-id details creation-guard)</code></li>
<li>Create the token by calling <code>(ledger.create-token ... creation-guard)</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities">Capabilities<a href="#capabilities" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>create-token</code> transaction must include the <code>CREATE-TOKEN</code> capability signed with the keyset <code>creation-guard</code> that you used to generate the token identifier.
The <code>create-token</code> transaction also requires the <code>marmalade-v2.collection-policy-v1.TOKEN-COLLECTION</code> capability if you apply the collection-policy to create token.</p>
<p>Required capabilities and parameters for the <code>create-token</code> function:</p>
<ul>
<li>marmalade-v2.ledger.CREATE-TOKEN<!-- -->
<ul>
<li>id</li>
</ul>
</li>
<li>marmalade-v2.collection-policy-v1.TOKEN-COLLECTION<!-- -->
<ul>
<li>collection-id</li>
<li>token-id</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-data">Environment data<a href="#environment-data" class="hash-link" aria-label="Direct link to Environment data" title="Direct link to Environment data">​</a></h3>
<p>If you apply the guard-policy to create a token, you can add the following information as raw data:</p>
<ul>
<li>mint_guard [guard] (optional)</li>
<li>burn_guard [guard] (optional)</li>
<li>sale_guard [guard] (optional)</li>
<li>transfer_guard [guard] (optional)</li>
<li>uri_guard [guard] (optional)</li>
</ul>
<p>If you apply the collection-policy to create a token, you can add the following information as raw data:</p>
<ul>
<li>collection_id [string]</li>
</ul>
<p>If you apply the royalty-policy to create a token, you can add the following information as raw data:</p>
<ul>
<li>royalty_spec [object]</li>
</ul>
<p>The royalty_spec object includes the following properties:</p>
<ul>
<li>fungible [string]</li>
<li>creator [string]</li>
<li>creator-guard [guard]</li>
<li>royalty-rate [decimal]</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mint">mint<a href="#mint" class="hash-link" aria-label="Direct link to mint" title="Direct link to mint">​</a></h2>
<p>Use <code>mint</code> to mint the specified token amount to the specified account.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-2">Arguments<a href="#arguments-2" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to mint a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>account</code></td><td>string</td><td>Specifies the account that will receive the minted token.</td></tr><tr><td><code>guard</code></td><td>guard</td><td>Specifies the guard for the minted token account.</td></tr><tr><td><code>amount</code></td><td>decimal</td><td>Specifies the number of tokens to be minted.</td></tr></tbody></table>
<p>When you submit the <code>mint</code> transaction, the <code>policy-manager.enforce-mint</code> function calls the <code>policy:enforce-mint</code> function in the stored token policies and the function is executed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-1">Capabilities<a href="#capabilities-1" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>mint</code> transaction must include the <code>MINT</code> capability signed with the <code>account</code> that receives the token.
The <code>mint</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.MINT</code> capability if you apply the guard-policy and define a mint guard for the token.</p>
<p>Required capabilities and parameters for the <code>mint</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.MINT</p>
<ul>
<li>id</li>
<li>account (receiver of the token)</li>
<li>amount</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.MINT</p>
<ul>
<li>token-id</li>
<li>account (receiver of the token)</li>
<li>amount</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="burn">burn<a href="#burn" class="hash-link" aria-label="Direct link to burn" title="Direct link to burn">​</a></h2>
<p>Use <code>burn</code> to destroy the specified token amount from the specified token owner account.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-3">Arguments<a href="#arguments-3" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to burn a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>account</code></td><td>string</td><td>Specifies the token owner account for the token amount to be burned.</td></tr><tr><td><code>amount</code></td><td>decimal</td><td>Specifies the number of tokens to be burned.</td></tr></tbody></table>
<p>When you submit the <code>burn</code> transaction, the <code>policy-manager.enforce-burn</code> function calls the <code>policy:enforce-burn</code> function in the stored token policies and the function is executed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-2">Capabilities<a href="#capabilities-2" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>burn</code> transaction must include the <code>BURN</code> capability signed with the <code>account</code> that owns the token.
The <code>burn</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.BURN</code> capability if you apply the guard-policy and define a burn guard for the token.</p>
<p>Required capabilities and parameters for the <code>burn</code> function:</p>
<ul>
<li>marmalade-v2.ledger.BURN<!-- -->
<ul>
<li>id</li>
<li>account (owner of the token)</li>
<li>amount</li>
</ul>
</li>
<li>marmalade-v2.guard-policy-v1.BURN<!-- -->
<ul>
<li>token-id</li>
<li>account (owner of the token)</li>
<li>amount</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transfer">transfer<a href="#transfer" class="hash-link" aria-label="Direct link to transfer" title="Direct link to transfer">​</a></h2>
<p>Use <code>transfer</code> to transfer the specified token amount from the specified sender to the specified receiver.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-4">Arguments<a href="#arguments-4" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to transfer a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>sender</code></td><td>string</td><td>Specifies the sender account that the token will be transferred from.</td></tr><tr><td><code>receiver</code></td><td>string</td><td>Specifies the receiver account that the token will be transferred to.</td></tr><tr><td><code>amount</code></td><td>decimal</td><td>Specifies the number of tokens to be transferred.</td></tr></tbody></table>
<p>When you submit the <code>transfer</code> transaction, the <code>policy-manager.enforce-transfer</code> function calls the <code>policy:enforce-transfer</code> function in the stored token policies and the function is executed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-3">Capabilities<a href="#capabilities-3" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>transfer</code> transaction must include the <code>TRANSFER</code> capability signed with the <code>sender</code> that owns the token.
The <code>transfer</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.TRANSFER</code> capability if you apply the guard-policy and define a transfer guard for the token.</p>
<p>Required capabilities and parameters for the <code>transfer</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.TRANSFER</p>
<ul>
<li>id</li>
<li>sender</li>
<li>receiver</li>
<li>amount</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.TRANSFER</p>
<ul>
<li>token-id</li>
<li>sender</li>
<li>receiver</li>
<li>amount</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transfer-create">transfer-create<a href="#transfer-create" class="hash-link" aria-label="Direct link to transfer-create" title="Direct link to transfer-create">​</a></h2>
<p>Use <code>transfer-create</code> to transfer the specified token amount from the specified sender to the specified receiver and creates the receiver account, if the account doesn&#x27;t exist.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-5">Arguments<a href="#arguments-5" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to transfer a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>sender</code></td><td>string</td><td>Specifies the sender account that the token will be transferred from.</td></tr><tr><td><code>receiver</code></td><td>string</td><td>Specifies the receiver account that the token will be transferred to.</td></tr><tr><td><code>receiver-guard</code></td><td>guard</td><td>Specifies the guard for the receiver account that the token will be transferred to.</td></tr><tr><td><code>amount</code></td><td>decimal</td><td>Specifies the number of tokens to be transferred.</td></tr></tbody></table>
<p>When you submit the <code>transfer-create</code> transaction, the <code>policy-manager.enforce-transfer</code> function calls the <code>policy:enforce-transfer</code> function in the stored token policies and the function is executed at <code>ledger.transfer-create</code>. The difference between <code>transfer</code> and <code>transfer-create</code> is that <code>transfer-create</code> can be used for both non-existent and existing receiver accounts, with an additional check for the receiver guard if already exists.
The <code>transfer</code> can only be used for existing <code>receiver</code>account.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-4">Capabilities<a href="#capabilities-4" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>transfer-create</code> transaction must include the <code>TRANSFER</code> capability signed with the <code>sender</code> that owns the token.
The <code>transfer-create</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.TRANSFER</code> capability if you apply the guard-policy and define a transfer guard for the token.</p>
<p>Required capabilities and parameters for the <code>transfer-create</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.TRANSFER</p>
<ul>
<li>id</li>
<li>sender</li>
<li>receiver</li>
<li>amount</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.TRANSFER</p>
<ul>
<li>token-id</li>
<li>sender</li>
<li>receiver</li>
<li>amount</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sale">sale<a href="#sale" class="hash-link" aria-label="Direct link to sale" title="Direct link to sale">​</a></h2>
<p>Use <code>sale</code> to execute a two-step transaction using the offer and buy steps with a trustless escrow account.</p>
<p>Because a sale requires two steps that must be completed in a specific order, the transaction is defined using a pact.
For information about the syntax used to define a pact, see <a href="/docs/reference/syntax#defpact">defpact</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-6">Arguments<a href="#arguments-6" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<p>Use the following arguments to initiate the sale of a token.</p>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>seller</code></td><td>string</td><td>Specifies the seller account that the token will be offered from.</td></tr><tr><td><code>amount</code></td><td>decimal</td><td>Specifies the number of tokens to be offered for sale.</td></tr><tr><td><code>timeout</code></td><td>integer</td><td>Specifies when the offer is set to expire using a timestamp for the number of seconds from UNIX epoch before the offer can be withdrawn. For example, if you want an offer to expire at midnight on 30 June 2024, you specify the timeout as 1719705600. You can set the <code>timeout</code> argument to zero (0) to allow an offer to be withdrawn at any time by the token owner.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="offer">offer<a href="#offer" class="hash-link" aria-label="Direct link to offer" title="Direct link to offer">​</a></h3>
<p>The first step of a <code>sale</code> pact (step 0) executes the <code>offer</code> function.
The <code>offer</code> function transfers the token from the seller&#x27;s account to the escrow account.</p>
<p>The <code>policy-manager.enforce-offer</code> function calls the <code>policy:enforce-offer</code> function in the stored token policies and the function is executed at step 0 of the <code>sale</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-5">Capabilities<a href="#capabilities-5" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h4>
<p>The <code>offer</code> transaction must include the <code>OFFER</code> capability signed with the <code>seller</code> that owns the token.
The <code>offer</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.SALE</code> capability if you apply the guard-policy and define a sales guard for the token.</p>
<p>Required capabilities and parameters for the <code>offer</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.OFFER</p>
<ul>
<li>id</li>
<li>seller</li>
<li>amount</li>
<li>timeout</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.SALE</p>
<ul>
<li>token-id</li>
<li>seller</li>
<li>amount</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-data-1">Environment data<a href="#environment-data-1" class="hash-link" aria-label="Direct link to Environment data" title="Direct link to Environment data">​</a></h3>
<p>If the offer is a dutch or conventional auction, you can add the following information as raw data:</p>
<ul>
<li>quote [object]</li>
</ul>
<p>The quote object includes the following properties:</p>
<ul>
<li>fungible [string]</li>
<li>sale-price [decimal]</li>
<li>seller-fungible-account [object]<!-- -->
<ul>
<li>account [string]</li>
<li>guard [guard]</li>
</ul>
</li>
<li>sale-type [string] (optional)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="withdraw-cont">withdraw (cont)<a href="#withdraw-cont" class="hash-link" aria-label="Direct link to withdraw (cont)" title="Direct link to withdraw (cont)">​</a></h3>
<p>The <code>sale</code> pact includes a rollback step (step 0-rollback).
The rollback step executes the <code>withdraw</code> function.
The <code>withdraw</code> function transfers the tokens held in the escrow account for the sale back to the seller.
If a <code>timeout</code> is specified, the <code>withdraw</code> function can only be executed after the timeout period has passed.
You can execute the <code>withdraw</code> function by sending a continuation (<code>cont</code>) command with the following information:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">pactTxHash</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pact</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">step</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rollback</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about formatting continuation commands, see <a href="/docs/smart-contracts/transactions#transaction-formats">Transaction formats</a>.</p>
<p>The <code>policy-manager.enforce-withdraw</code> function calls the <code>policy:enforce-withdraw</code> function in the stored token policies and the function is executed at step 0-rollback of <code>sale</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-6">Capabilities<a href="#capabilities-6" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h4>
<p>The <code>withdraw</code> transaction must include the <code>WITHDRAW</code> capability signed with the <code>seller</code> that owns the token.
The <code>withdraw</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.SALE</code> capability if you apply the guard-policy and define a sales guard for the token.</p>
<p>Required capabilities and parameters for the <code>withdraw</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.WITHDRAW</p>
<ul>
<li>id</li>
<li>seller</li>
<li>amount</li>
<li>timeout</li>
<li>sale-id</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.SALE</p>
<ul>
<li>token-id</li>
<li>seller</li>
<li>amount</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="buy-cont">buy (cont)<a href="#buy-cont" class="hash-link" aria-label="Direct link to buy (cont)" title="Direct link to buy (cont)">​</a></h3>
<p>The second step of a <code>sale</code> pact (step 1) executes the <code>buy</code> function.
The <code>buy</code> function transfers the tokens held in the escrow account to the buyer. The <code>buy</code> function can be executed before <code>timeout</code>.
The <code>buyer</code> and <code>buyer-guard</code> information is read from the <code>env-data</code> of the command instead of passing in arguments.
Like the <code>withdraw</code> function, the <code>buy</code> function is executed using a continuation (<code>cont</code>) command:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">pactTxHash</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pact</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">step</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rollback</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>policy-manager.enforce-buy</code> function calls the <code>policy:enforce-buy</code> function in the stored token policies and the function is executed at step 1 of <code>sale</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-7">Capabilities<a href="#capabilities-7" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h4>
<p>The <code>buy</code> transaction must include the <code>BUY</code> capability signed with the <code>buyer</code> that is buying the token.
The <code>buy</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.SALE</code> capability if you apply the guard-policy and define a sales guard for the token.</p>
<p>Required capabilities and parameters for the <code>buy</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.BUY</p>
<ul>
<li>id</li>
<li>seller</li>
<li>buyer</li>
<li>amount</li>
<li>sale-id</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.SALE</p>
<ul>
<li>token-id</li>
<li>seller</li>
<li>amount</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-data-2">Environment data<a href="#environment-data-2" class="hash-link" aria-label="Direct link to Environment data" title="Direct link to Environment data">​</a></h3>
<p>If the sale is a dutch or conventional auction, you need to add the following information as raw data:</p>
<ul>
<li>buyer [string]</li>
<li>buyer-guard [guard]</li>
<li>buyer_fungible_account [string]</li>
<li>updated_price [decimal]</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-uri">update-uri<a href="#update-uri" class="hash-link" aria-label="Direct link to update-uri" title="Direct link to update-uri">​</a></h2>
<p>Use <code>update-uri</code> to update the <code>uri</code> for an existing token.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arguments-7">Arguments<a href="#arguments-7" class="hash-link" aria-label="Direct link to Arguments" title="Direct link to Arguments">​</a></h3>
<table><thead><tr><th>Argument</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>id</code></td><td>string</td><td>Specifies the unique token identifier generated using <code>create-token-id</code> function and formatted as <code>t:{token-detail-hash}</code>.</td></tr><tr><td><code>new-uri</code></td><td>string</td><td>Specifies the new <code>uri</code>.</td></tr></tbody></table>
<p>When you submit the <code>update-uri</code> transaction, the <code>policy-manager.enforce-update-uri</code> function calls the <code>policy:enforce-update-uri</code> function in the stored token policies and the function is executed at <code>ledger.update-uri</code>.
Token creators should configure the entity that will be authorized to update the uri&#x27;s in the <code>guard-policy-v1</code>, or in their custom policies.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capabilities-8">Capabilities<a href="#capabilities-8" class="hash-link" aria-label="Direct link to Capabilities" title="Direct link to Capabilities">​</a></h3>
<p>The <code>update-uri</code> transaction must include the <code>UPDATE-URI</code> capability signed with the <code>buyer</code> that is buying the token.
The <code>update-uri</code> transaction also requires the <code>marmalade-v2.guard-policy-v1.UPDATE-URI</code> capability if you apply the guard-policy and define a uri guard for the token.</p>
<p>Required capabilities and parameters for the <code>update-uri</code> function:</p>
<ul>
<li>
<p>marmalade-v2.ledger.UPDATE-URI</p>
<ul>
<li>token-id</li>
<li>new-uri</li>
</ul>
</li>
<li>
<p>marmalade-v2.guard-policy-v1.UPDATE-URI</p>
<ul>
<li>token-id</li>
<li>new-uri</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kda-community/kadena-docs-new/blob/master/docs/reference/marmalade/ledger.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-token-id" class="table-of-contents__link toc-highlight">create-token-id</a></li><li><a href="#create-token" class="table-of-contents__link toc-highlight">create-token</a></li><li><a href="#mint" class="table-of-contents__link toc-highlight">mint</a></li><li><a href="#burn" class="table-of-contents__link toc-highlight">burn</a></li><li><a href="#transfer" class="table-of-contents__link toc-highlight">transfer</a></li><li><a href="#transfer-create" class="table-of-contents__link toc-highlight">transfer-create</a></li><li><a href="#sale" class="table-of-contents__link toc-highlight">sale</a></li><li><a href="#update-uri" class="table-of-contents__link toc-highlight">update-uri</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 - Kadena LLC (<a href="https://www.kadena.io/privacy-policy" target="_blank">Privacy</a>)</div></div></div></footer><div class="footer-consent-link"><button>Analytics Consent</button></div></div>
</body>
</html>